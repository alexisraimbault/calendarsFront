(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{237:function(e,t,a){e.exports=a(450)},248:function(e,t,a){},249:function(e,t,a){var s={"./af":85,"./af.js":85,"./ar":86,"./ar-dz":87,"./ar-dz.js":87,"./ar-kw":88,"./ar-kw.js":88,"./ar-ly":89,"./ar-ly.js":89,"./ar-ma":90,"./ar-ma.js":90,"./ar-sa":91,"./ar-sa.js":91,"./ar-tn":92,"./ar-tn.js":92,"./ar.js":86,"./az":93,"./az.js":93,"./be":94,"./be.js":94,"./bg":95,"./bg.js":95,"./bm":96,"./bm.js":96,"./bn":97,"./bn.js":97,"./bo":98,"./bo.js":98,"./br":99,"./br.js":99,"./bs":100,"./bs.js":100,"./ca":101,"./ca.js":101,"./cs":102,"./cs.js":102,"./cv":103,"./cv.js":103,"./cy":104,"./cy.js":104,"./da":105,"./da.js":105,"./de":106,"./de-at":107,"./de-at.js":107,"./de-ch":108,"./de-ch.js":108,"./de.js":106,"./dv":109,"./dv.js":109,"./el":110,"./el.js":110,"./en-SG":111,"./en-SG.js":111,"./en-au":112,"./en-au.js":112,"./en-ca":113,"./en-ca.js":113,"./en-gb":114,"./en-gb.js":114,"./en-ie":115,"./en-ie.js":115,"./en-il":116,"./en-il.js":116,"./en-nz":117,"./en-nz.js":117,"./eo":118,"./eo.js":118,"./es":119,"./es-do":120,"./es-do.js":120,"./es-us":121,"./es-us.js":121,"./es.js":119,"./et":122,"./et.js":122,"./eu":123,"./eu.js":123,"./fa":124,"./fa.js":124,"./fi":125,"./fi.js":125,"./fo":126,"./fo.js":126,"./fr":127,"./fr-ca":128,"./fr-ca.js":128,"./fr-ch":129,"./fr-ch.js":129,"./fr.js":127,"./fy":130,"./fy.js":130,"./ga":131,"./ga.js":131,"./gd":132,"./gd.js":132,"./gl":133,"./gl.js":133,"./gom-latn":134,"./gom-latn.js":134,"./gu":135,"./gu.js":135,"./he":136,"./he.js":136,"./hi":137,"./hi.js":137,"./hr":138,"./hr.js":138,"./hu":139,"./hu.js":139,"./hy-am":140,"./hy-am.js":140,"./id":141,"./id.js":141,"./is":142,"./is.js":142,"./it":143,"./it-ch":144,"./it-ch.js":144,"./it.js":143,"./ja":145,"./ja.js":145,"./jv":146,"./jv.js":146,"./ka":147,"./ka.js":147,"./kk":148,"./kk.js":148,"./km":149,"./km.js":149,"./kn":150,"./kn.js":150,"./ko":151,"./ko.js":151,"./ku":152,"./ku.js":152,"./ky":153,"./ky.js":153,"./lb":154,"./lb.js":154,"./lo":155,"./lo.js":155,"./lt":156,"./lt.js":156,"./lv":157,"./lv.js":157,"./me":158,"./me.js":158,"./mi":159,"./mi.js":159,"./mk":160,"./mk.js":160,"./ml":161,"./ml.js":161,"./mn":162,"./mn.js":162,"./mr":163,"./mr.js":163,"./ms":164,"./ms-my":165,"./ms-my.js":165,"./ms.js":164,"./mt":166,"./mt.js":166,"./my":167,"./my.js":167,"./nb":168,"./nb.js":168,"./ne":169,"./ne.js":169,"./nl":170,"./nl-be":171,"./nl-be.js":171,"./nl.js":170,"./nn":172,"./nn.js":172,"./pa-in":173,"./pa-in.js":173,"./pl":174,"./pl.js":174,"./pt":175,"./pt-br":176,"./pt-br.js":176,"./pt.js":175,"./ro":177,"./ro.js":177,"./ru":178,"./ru.js":178,"./sd":179,"./sd.js":179,"./se":180,"./se.js":180,"./si":181,"./si.js":181,"./sk":182,"./sk.js":182,"./sl":183,"./sl.js":183,"./sq":184,"./sq.js":184,"./sr":185,"./sr-cyrl":186,"./sr-cyrl.js":186,"./sr.js":185,"./ss":187,"./ss.js":187,"./sv":188,"./sv.js":188,"./sw":189,"./sw.js":189,"./ta":190,"./ta.js":190,"./te":191,"./te.js":191,"./tet":192,"./tet.js":192,"./tg":193,"./tg.js":193,"./th":194,"./th.js":194,"./tl-ph":195,"./tl-ph.js":195,"./tlh":196,"./tlh.js":196,"./tr":197,"./tr.js":197,"./tzl":198,"./tzl.js":198,"./tzm":199,"./tzm-latn":200,"./tzm-latn.js":200,"./tzm.js":199,"./ug-cn":201,"./ug-cn.js":201,"./uk":202,"./uk.js":202,"./ur":203,"./ur.js":203,"./uz":204,"./uz-latn":205,"./uz-latn.js":205,"./uz.js":204,"./vi":206,"./vi.js":206,"./x-pseudo":207,"./x-pseudo.js":207,"./yo":208,"./yo.js":208,"./zh-cn":209,"./zh-cn.js":209,"./zh-hk":210,"./zh-hk.js":210,"./zh-tw":211,"./zh-tw.js":211};function n(e){var t=o(e);return a(t)}function o(e){if(!a.o(s,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return s[e]}n.keys=function(){return Object.keys(s)},n.resolve=o,e.exports=n,n.id=249},250:function(e,t,a){},251:function(e,t,a){},267:function(e,t,a){},288:function(e,t,a){},289:function(e,t,a){},304:function(e,t,a){},340:function(e,t,a){},394:function(e,t,a){},395:function(e,t,a){},396:function(e,t,a){},397:function(e,t,a){},398:function(e,t,a){},399:function(e,t,a){},400:function(e,t,a){},401:function(e,t,a){},402:function(e,t,a){},403:function(e,t,a){},405:function(e,t,a){},406:function(e,t,a){},407:function(e,t,a){},408:function(e,t,a){},409:function(e,t,a){},410:function(e,t,a){},411:function(e,t,a){},412:function(e,t,a){},413:function(e,t,a){},414:function(e,t,a){},415:function(e,t,a){},416:function(e,t,a){},417:function(e,t,a){},418:function(e,t,a){},419:function(e,t,a){},420:function(e,t,a){},421:function(e,t,a){},422:function(e,t,a){},423:function(e,t,a){},424:function(e,t,a){},425:function(e,t,a){},426:function(e,t,a){},427:function(e,t,a){},428:function(e,t,a){},429:function(e,t,a){},430:function(e,t,a){},431:function(e,t,a){},432:function(e,t,a){},433:function(e,t,a){},434:function(e,t,a){},435:function(e,t,a){},436:function(e,t,a){},437:function(e,t,a){},438:function(e,t,a){},439:function(e,t,a){},440:function(e,t,a){},441:function(e,t,a){},442:function(e,t,a){},443:function(e,t,a){},444:function(e,t,a){},445:function(e,t,a){},446:function(e,t,a){},450:function(e,t,a){"use strict";a.r(t);var s=a(0),n=a.n(s),o=a(32),i=a(7),r=a(8),c=a(225),l=a(226),p=a(82),d=a(227),h=a(228),m=a.n(h),u=a(31),E=a(36),v=(a(248),a(2)),g=a(24),f=a(458),y=a(457),N=a(1),S=a.n(N),T=a(6),D=a.n(T);a(250);class C extends s.Component{constructor(e){super(e),this.state={}}render(){const{daysOfWeek:e}=this.props;return n.a.createElement("div",{className:"calendar-header-container"},S.a.map(e,e=>{const t=D()({"calendar-day-title":!0,"calendar-day-title--today":Object(y.a)(e.day)});return n.a.createElement("div",{className:"calendar-day-title-container"},n.a.createElement("div",{className:t},v(e.day).format("dddd D MMMM")))}))}}var O=C,b=(a(251),a(15)),k=(a(267),a(16)),I=a.n(k);a(288);class P extends s.Component{constructor(e){super(e),this.state={isEditing:e.isEditing||!1,editingLabel:e.label||""}}render(){const{isToggled:e}=this.state,{onChange:t,value:a,placeholder:s,isDescription:o,isPassword:i,isNumber:r}=this.props;return n.a.createElement("div",null,o?n.a.createElement("textArea",{className:"editable-label-description",onChange:t,placeholder:s},a):i?n.a.createElement("input",{className:"editable-label-input",value:a,onChange:t,placeholder:s,type:"password"}):r?n.a.createElement("input",{className:"editable-label-input",value:a,onChange:t,placeholder:s,type:"number"}):n.a.createElement("input",{className:"editable-label-input",value:a,onChange:t,placeholder:s}))}}a(289);var w=a(9);const A=e=>{if(!_.isString(e))return e;return e.replace(/\'/gi,"''").replace(/\n/gi,"<br>")};function U(e,t){return async a=>{a({type:"GET_USERS"});try{const s=await fetch("https://i8jk577b46.execute-api.eu-west-3.amazonaws.com/alpha/users?corpId=".concat(A(e)),{headers:{authorization:t}}),n=await s.json();a({type:"GET_USERS_SUCCESS",payload:JSON.parse(n.body)})}catch(e){a({type:"GET_USERS_FAILURE"})}}}function M(e,t,a){return async s=>{s({type:"INVITE_USER"});try{const n=await fetch("https://i8jk577b46.execute-api.eu-west-3.amazonaws.com/alpha/users/invite?mail=".concat(A(e),"&corp_id=").concat(A(t)),{headers:{authorization:a},method:"PUT"}),o=await n.json();200===o.statusCode?w.NotificationManager.success("Invitation successfullt sent!","Successful!",1500):w.NotificationManager.error("Error while Inviting user: ".concat(A(o).body,"!"),"Error!"),s({type:"INVITE_USER_SUCCESS"})}catch(e){s({type:"INVITE_USER_FAILURE"})}}}function j(e,t,a,s,n){return async o=>{o({type:"INVITE_USER"});try{const i=await fetch("https://i8jk577b46.execute-api.eu-west-3.amazonaws.com/alpha/users?mail=".concat(A(e),"&name=").concat(A(t),"&password=").concat(A(a),"&status=").concat(A(s),"&phone=").concat(A(n)),{method:"PUT"}),r=await i.json();200===r.statusCode?w.NotificationManager.success("Account successfully created!","Successful!",1500):(w.NotificationManager.error("Error while creating account: ".concat(A(r).body,"!"),"Error!"),o(authenticateFailure())),o({type:"INVITE_USER_SUCCESS"})}catch(e){w.NotificationManager.error("Error while creating account!","Error!"),o({type:"INVITE_USER_FAILURE"})}}}function R(e,t,a){return async s=>{s({type:"UPDATE_USER_STATUS"});try{const n=await fetch("https://i8jk577b46.execute-api.eu-west-3.amazonaws.com/alpha/users/status?id=".concat(A(e),"&status=").concat(A(t)),{method:"POST",headers:{authorization:a}});await n.json();w.NotificationManager.success("User status successfully updated!","Successful!",1500),s({type:"UPDATE_USER_STATUS_SUCCESS"})}catch(e){w.NotificationManager.error("Error while updating status!","Error!"),s({type:"UPDATE_USER_STATUS_FAILURE"})}}}class x extends s.Component{constructor(e){super(e),this.onValueChange=e=>this.setState({value:e.target.value}),this.getSelectedUsersIds=()=>{const{selectedUsers:e}=this.state;return S.a.map(e,e=>e.id)},this.addUser=e=>()=>{const{selectedUsers:t}=this.state,{setSelectedUsersIds:a}=this.props,s=S.a.uniq(S.a.concat(t,e));this.setState({selectedUsers:s},()=>{a(this.getSelectedUsersIds())})},this.removeUser=e=>()=>{const{selectedUsers:t}=this.state,{setSelectedUsersIds:a}=this.props,s=S.a.differenceBy(t,[e],e=>e.id);this.setState({selectedUsers:s},()=>{a(this.getSelectedUsersIds())})},this.setFocus=e=>()=>this.setState({isFocused:e}),this.setHover=e=>()=>this.setState({isHovered:e}),this.state={selectedUsers:[],value:"",isFocused:!1,isHovered:!1}}componentDidMount(){const{fetchUsers:e,sessionToken:t,userInfos:a,users:s,defaultSelected:n}=this.props;e(S.a.get(a,"corpId"),t).then(()=>{this.setState({selectedUsers:S.a.filter(s,e=>S.a.includes(n,e.id))})})}render(){const{selectedUsers:e,value:t,isFocused:a,isHovered:s}=this.state,{users:o,offIds:i}=this.props,r=this.getSelectedUsersIds(),c=S.a.filter(o,e=>!S.a.includes(r,e.id)),l=S.a.filter(c,e=>S.a.includes(S.a.lowerCase(e.name),S.a.lowerCase(t)));return n.a.createElement("div",null,n.a.createElement("input",{className:"user-selector-input",value:t,onChange:this.onValueChange,placeholder:"Search for users",onFocus:this.setFocus(!0),onBlur:this.setFocus(!1)}),(a||s)&&n.a.createElement("div",{className:"selection-container",onMouseEnter:this.setHover(!0),onMouseLeave:this.setHover(!1)},S.a.map(l,e=>{const t=D()({"selection-item":!0,"selection-item--off":S.a.includes(i,e.id)});return n.a.createElement("div",{className:t,onClick:this.addUser(e)},e.name)})),!(a||s)&&n.a.createElement("div",{className:"selection-placebo"}),n.a.createElement("div",{className:"selected-container"},S.a.map(e,e=>n.a.createElement("div",{className:"selected-item",onClick:this.removeUser(e)},e.name))))}}var L=Object(r.b)(e=>({loading:e.users.loading,users:e.users.users,userInfos:e.me.infos,hasErrors:e.users.hasErrors,sessionToken:e.me.sessionToken}),e=>Object(i.bindActionCreators)({fetchUsers:U},e))(x),z=(a(304),a(229));class F extends s.Component{render(){const{clickAction:e,label:t,isDanger:a,isLoading:s}=this.props,o=D()({"action-button-container":!0,"action-button-container--danger":!S.a.isNil(a)&&a});return n.a.createElement("div",{className:o,onClick:e},!S.a.isNil(s)&&s?n.a.createElement(z.WaveTopBottomLoading,{size:"small",style:{position:"relative",height:"20px"}}):t)}}function G(e,t,a,s=!1){return async n=>{n({type:"GET_EVENTS"});try{const o=await fetch("https://i8jk577b46.execute-api.eu-west-3.amazonaws.com/alpha/events?date=".concat(A(e),"&corp_id=").concat(A(a)),{headers:{authorization:t}}),i=await o.json();n(((e,t)=>({type:t?"GET_EVENTS_SUCCESS_MERGE":"GET_EVENTS_SUCCESS",payload:e}))(JSON.parse(i.body),s))}catch(e){n({type:"GET_EVENTS_FAILURE"})}}}function Y(e,t,a=!1){return async s=>{s({type:"GET_OPERATION_EVENTS"});try{const n=await fetch("https://i8jk577b46.execute-api.eu-west-3.amazonaws.com/alpha/operation/events?date=".concat(e,"&operation_id=").concat(t)),o=await n.json();s(((e,t)=>({type:t?"GET_OPERATION_EVENTS_SUCCESS_MERGE":"GET_OPERATION_EVENTS_SUCCESS",payload:e}))({events:JSON.parse(o.body.events),name:o.body.name},a))}catch(e){s({type:"GET_OPERATION_EVENTS_FAILURE"})}}}function H(e,t,a,s){return async n=>{n({type:"GET_AMO_EVENTS"});try{const o=await fetch("https://i8jk577b46.execute-api.eu-west-3.amazonaws.com/alpha/amoevents?date=".concat(A(t),"&user_id=").concat(A(a),"&corp_id=").concat(A(s)),{headers:{authorization:e}}),i=await o.json();n({type:"GET_AMO_EVENTS_SUCCESS",payload:JSON.parse(i.body)})}catch(e){n({type:"GET_AMO_EVENTS_FAILURE"})}}}function q(e,t,a,s,n,o,i,r,c,l,p,d){return async h=>{h({type:"PUT_EVENTS"});try{const u=await fetch("https://i8jk577b46.execute-api.eu-west-3.amazonaws.com/alpha/events?name=".concat(A(e),"&description=").concat(A(t),"&date=").concat(A(a),"&time_from=").concat(A(s),"&time_to=").concat(A(n),"&users=").concat(A(o),"&corp_id=").concat(A(r),"&type=").concat(A(c),"&operation_id=").concat(A(l),"&hours=").concat(A(p),"&mail=").concat(A(d)),{headers:{authorization:i},method:"PUT"});await u.json();w.NotificationManager.success("You have added a new Event!","Successful!",1500),h({type:"PUT_EVENTS_SUCCESS",payload:m})}catch(e){w.NotificationManager.error("Error while Creating Event!","Error!"),h({type:"PUT_EVENTS_FAILURE"})}var m}}function B(e,t,a,s,n,o,i,r,c,l){return async p=>{p({type:"PUT_NOAUTH_EVENT"});try{const h=await fetch("https://i8jk577b46.execute-api.eu-west-3.amazonaws.com/alpha/noauth/event?name=".concat(A(e),"&description=").concat(A(t),"&date=").concat(A(a),"&time_from=").concat(A(s),"&time_to=").concat(A(n),"&users=").concat(A(o),"&corp_id=").concat(A(i),"&type=").concat(A(r),"&operation_id=").concat(A(c),"&mail=").concat(A(l),"&hours=-"),{headers:{},method:"POST"});await h.json();w.NotificationManager.success("Rendez-vous sauvegardé avec succès!","Successful!",1500),p({type:"PUT_NOAUTH_EVENT_SUCCESS",payload:d})}catch(e){w.NotificationManager.error("Erreur lors de la sauvegarde du rendez-vous!","Error!"),p({type:"PUT_NOAUTH_EVENT_FAILURE"})}var d}}function V(e){return async t=>{t({type:"GET_NOAUTH_INFOS"});try{const a=await fetch("https://i8jk577b46.execute-api.eu-west-3.amazonaws.com/alpha/noauth/rdvpage?id=".concat(A(e)),{headers:{},method:"GET"}),s=await a.json();t({type:"GET_NOAUTH_INFOS_SUCCESS",payload:JSON.parse(s.body)})}catch(e){t({type:"GET_NOAUTH_INFOS_FAILURE"})}}}function W(e,t,a,s,n,o,i){return async r=>{r({type:"UPDATE_EVENT"});try{await fetch("https://i8jk577b46.execute-api.eu-west-3.amazonaws.com/alpha/events?event_id=".concat(A(e),"&name=").concat(A(t),"&description=").concat(A(a),"&time_from=").concat(A(s),"&time_to=").concat(A(n),"&users=-&date=").concat(o),{headers:{authorization:i},method:"POST"});w.NotificationManager.success("Event successfully updated!","Successful!",1500),r({type:"UPDATE_EVENT_SUCCESS"})}catch(e){w.NotificationManager.error("Error while updating Event!","Error!"),r({type:"UPDATE_EVENT_FAILURE"})}}}function K(e,t){return async a=>{a({type:"DELETE_EVENT"});try{await fetch("https://i8jk577b46.execute-api.eu-west-3.amazonaws.com/alpha/events?id=".concat(A(e)),{headers:{authorization:t},method:"DELETE"});w.NotificationManager.success("Event successfully deleted!","Successful!",1500),a((e=>({type:"DELETE_EVENT_SUCCESS",payload:e}))(e))}catch(e){w.NotificationManager.error("Error while deleting Event!","Error!"),a({type:"DELETE_EVENT_FAILURE"})}}}a(20);class Z extends s.Component{constructor(e){super(e),this.handleChangeDate=e=>{this.setState({eventDate:e})},this.setSelectedUsersIds=e=>this.setState({selectedUsersIds:e}),this.onChangeStartTime=e=>this.setState({start_time:e}),this.onChangeEndTime=e=>this.setState({end_time:e}),this.updateTitle=e=>this.setState({title:e.target.value}),this.updateDescription=e=>this.setState({description:e.target.value}),this.sendUpdateEventRequest=()=>{const{title:e,description:t,start_time:a,end_time:s,selectedUsersIds:n}=this.state,{postUpdateEvent:o,fetchEventsData:i,closePopup:r,sessionToken:c,eventId:l}=this.props;o(l,e,t,a,s,_.join(n,","),c).then(()=>{i(),r()})},this.sendDeleteEventRequest=()=>{const{postDeleteEvent:e,eventId:t,sessionToken:a,closePopup:s}=this.props;e(t,a),s()},this.state={title:e.title,description:e.description,eventDate:e.date,start_time:e.startTime,end_time:e.endTime,selectedUsersIds:_.map(e.invited,e=>e.id)}}componentDidMount(){const{fetchUsers:e,sessionToken:t,userInfos:a}=this.props;e(_.get(a,"corpId"),t)}render(){const{title:e,description:t}=this.state,{invited:a,userInfos:s,isLoading:o}=this.props;return n.a.createElement("div",{className:"event-details-popup-container"},n.a.createElement("div",{className:"top-popup-container"},n.a.createElement("div",{className:"title"},"Event details"),n.a.createElement("div",{className:"edit-box"},n.a.createElement("div",{className:"left"},n.a.createElement(P,{value:e,onChange:this.updateTitle,placeholder:"Title here",isDescription:!1}),n.a.createElement(P,{value:t,onChange:this.updateDescription,placeholder:"Description here",isDescription:!0})),n.a.createElement("div",{className:"right"},n.a.createElement("div",{className:"date-picker"},this.state.eventDate),n.a.createElement("div",{className:"time-pickers-container"},n.a.createElement("div",{className:"time-picker"},n.a.createElement("div",{className:"time-label"},"from : "),n.a.createElement(I.a,{onChange:this.onChangeStartTime,value:this.state.start_time})),n.a.createElement("div",{className:"time-picker"},n.a.createElement("div",{className:"time-label"},"to : "),n.a.createElement(I.a,{onChange:this.onChangeEndTime,value:this.state.end_time}))))),n.a.createElement(L,{setSelectedUsersIds:this.setSelectedUsersIds,defaultSelected:a})),n.a.createElement("div",{className:"btns-container"},n.a.createElement("div",{className:"save-btn"},n.a.createElement(F,{clickAction:this.sendUpdateEventRequest,label:"Save modifications",isLoading:o})),"admin"===_.get(s,"status","user")&&n.a.createElement("div",{className:"delete-btn"},n.a.createElement(F,{isDanger:!0,clickAction:this.sendDeleteEventRequest,label:"Delete",isLoading:o}))))}}var J=Object(r.b)(e=>({loading:e.users.loading,users:e.users.users,hasErrors:e.users.hasErrors,sessionToken:e.me.sessionToken,userInfos:e.me.infos,isLoading:e.events.loading}),e=>Object(i.bindActionCreators)({postUpdateEvent:W,fetchUsers:U,postDeleteEvent:K},e))(Z);class Q extends s.Component{constructor(e){super(e),this.formatTime=e=>{const t=S.a.split(e,":"),a=S.a.parseInt(t[0])+S.a.parseInt(t[1])/60;return Math.floor(100*(a-6)/14)},this.calculateCoords=e=>({from:this.formatTime(e.time_from),to:this.formatTime(e.time_to)}),this.checkOverleap=(e,t)=>e.from<t.to&&t.from<e.to,this.formatWidth=e=>{const t={};S.a.forEach(e,a=>{const s=this.calculateCoords(a),n=[];S.a.forEach(e,e=>{const t=this.calculateCoords(e);e.id!==a.id&&this.checkOverleap(s,t)&&n.push(e.id)}),t[a.id]=n});const a=this.getGroupedOverleapMap(t),s={};return S.a.forEach(t,(e,t)=>{const n=S.a.size(S.a.maxBy(a[t],e=>S.a.size(e)))+1,o=Math.floor(100/n),i={},r=[];s[t]={width:o},S.a.forEach(S.a.orderBy(e,e=>S.a.get(s,"".concat(e,".width"),0),"asc"),e=>{if(!S.a.isNil(s[e])){const a=s[e].width;r.push(s[e].position),a>o&&(s[e].width=s[t].width),a<o&&(s[t].width=a,i[e]=o-a)}}),s[t].position=S.a.difference(S.a.times(n),r)[0]}),s},this.getGroupedOverleapMap=e=>{const t={};return S.a.forEach(e,(a,s)=>{if(S.a.isEmpty(a))t[s]=[[]];else{t[s]=[[a[0]]];let n=1;for(;n<S.a.size(a);){let o=0,i=!1;for(;o<S.a.size(t[s])&&!i;)S.a.includes(e[t[s][o]],a[n])&&(t[s][o].push(a[n]),i=!0),o++;i||t[s].push([a[n]]),n++}}}),t},this.state={}}render(){const{events:e,index:t,day:a,setPopupState:s,setPopupContent:o}=this.props,i=this.formatWidth(e),r=D()({"col-container":!0,"col-container--today":Object(y.a)(a)});return n.a.createElement("div",{className:r,style:{left:"".concat(20*t,"%")}},n.a.createElement("div",{className:"col-holder"},S.a.map(e,e=>{const t=this.calculateCoords(e);return n.a.createElement("div",{className:"event-container",style:{top:"".concat(t.from,"%"),height:"".concat(t.to-t.from,"%"),left:"".concat(i[e.id].position*i[e.id].width,"%"),width:"".concat(i[e.id].width,"%")}},n.a.createElement("div",{className:"event-holder",onClick:()=>{o(n.a.createElement(J,{closePopup:()=>{this.props.setPopupState(!1)},fetchEventsData:this.props.fetchEventsData,title:e.name,description:e.description,date:v(e.date).format("DD/MM/YYYY"),startTime:e.time_from,endTime:e.time_to,invited:e.invitations,eventId:e.id})),s(!0)}},n.a.createElement("div",{className:"event-holder-2"},n.a.createElement(b.Scrollbars,{className:"custom-scrollbars",renderTrackHorizontal:e=>n.a.createElement("div",{...e,style:{display:"none"},className:"track-horizontal"})},n.a.createElement("div",{className:"event-author"},e.name),n.a.createElement("div",{className:"event-recipients"},S.a.map(e.invitations,e=>n.a.createElement("div",{className:"event-recipient"},e.name))),n.a.createElement("div",{className:"event-description"},e.description)))))})))}}var X=Q,$=(a(340),a(13)),ee=a.n($);class te extends s.Component{constructor(e){super(e),this.handleChangeDate=e=>{this.setState({eventDate:e})},this.setSelectedUsersIds=e=>this.setState({selectedUsersIds:e}),this.onChangeStartTime=e=>this.setState({start_time:e}),this.onChangeEndTime=e=>this.setState({end_time:e}),this.updateTitle=e=>this.setState({title:e.target.value}),this.updateDescription=e=>this.setState({description:e.target.value}),this.sendCreateEventRequest=()=>{const{title:e,description:t,eventDate:a,start_time:s,end_time:n,selectedUsersIds:o}=this.state,{createEvent:i,fetchEventsData:r,closePopup:c,sessionToken:l,userInfos:p}=this.props;i(e,t,"".concat(v(a).year(),"-").concat(v(a).month()+1,"-").concat(v(a).date()),s,n,_.join(o,","),l,_.get(p,"corpId"),"rdv",1).then(()=>{r(),c()})},this.state={title:"Title",description:"Description",eventDate:new Date,start_time:"10:00",end_time:"12:00",selectedUsersIds:[]}}componentDidMount(){const{fetchUsers:e,sessionToken:t,userInfos:a}=this.props;e(_.get(a,"corpId"),t)}render(){const{title:e,description:t}=this.state,{isLoading:a}=this.props;return n.a.createElement("div",{className:"new-event-popup-container"},n.a.createElement("div",{className:"top-popup-container"},n.a.createElement("div",{className:"title"},"New event"),n.a.createElement("div",{className:"edit-box"},n.a.createElement("div",{className:"left"},n.a.createElement(P,{value:e,onChange:this.updateTitle,placeholder:"Title here",isDescription:!1}),n.a.createElement(P,{value:t,onChange:this.updateDescription,placeholder:"Description here",isDescription:!0})),n.a.createElement("div",{className:"right"},n.a.createElement("div",{className:"date-picker"},n.a.createElement(ee.a,{selected:this.state.eventDate,onChange:this.handleChangeDate})),n.a.createElement("div",{className:"time-pickers-container"},n.a.createElement("div",{className:"time-picker"},n.a.createElement("div",{className:"time-label"},"from : "),n.a.createElement(I.a,{onChange:this.onChangeStartTime,value:this.state.start_time})),n.a.createElement("div",{className:"time-picker"},n.a.createElement("div",{className:"time-label"},"to : "),n.a.createElement(I.a,{onChange:this.onChangeEndTime,value:this.state.end_time}))))),n.a.createElement(L,{setSelectedUsersIds:this.setSelectedUsersIds})),n.a.createElement("div",{className:"save-btn"},n.a.createElement(F,{clickAction:this.sendCreateEventRequest,label:"Save",isLoading:a})))}}var ae=Object(r.b)(e=>({loading:e.users.loading,users:e.users.users,hasErrors:e.users.hasErrors,sessionToken:e.me.sessionToken,userInfos:e.me.infos,isLoading:e.events.loading}),e=>Object(i.bindActionCreators)({createEvent:q,fetchUsers:U},e))(te);a(394),a(395),a(396);class se extends s.Component{render(){const{user:{name:e},inverted:t,isBright:a}=this.props;return n.a.createElement("div",{className:"single-user-container"},!t&&n.a.createElement("div",{className:"picto-container ".concat(a?"picto-bright":"")},n.a.createElement("svg",{viewBox:"-42 0 512 512.002",width:"18"},n.a.createElement("path",{d:"m210.351562 246.632812c33.882813 0 63.222657-12.152343 87.195313-36.128906 23.972656-23.972656 36.125-53.304687  36.125-87.191406 0-33.875-12.152344-63.210938-36.128906-87.191406-23.976563-23.96875-53.3125-36.121094-87.191407-36.121094-33.886718  0-63.21875 12.152344-87.191406 36.125s-36.128906 53.308594-36.128906 87.1875c0 33.886719 12.15625 63.222656 36.132812 87.195312 23.976563  23.96875 53.3125 36.125 87.1875 36.125zm0 0"}),n.a.createElement("path",{d:"m426.128906 393.703125c-.691406-9.976563-2.089844-20.859375-4.148437-32.351563-2.078125-11.578124-4.753907-22.523437-7.957031-32.527343-3.308594-10.339844-7.808594-20.550781-13.371094-30.335938-5.773438-10.15625-12.554688-19-20.164063-26.277343-7.957031-7.613282-17.699219-13.734376-28.964843-18.199219-11.226563-4.441407-23.667969-6.691407-36.976563-6.691407-5.226563  0-10.28125 2.144532-20.042969 8.5-6.007812 3.917969-13.035156 8.449219-20.878906 13.460938-6.707031 4.273438-15.792969 8.277344-27.015625  11.902344-10.949219 3.542968-22.066406 5.339844-33.039063 5.339844-10.972656 0-22.085937-1.796876-33.046874-5.339844-11.210938-3.621094-20.296876-7.625-26.996094-11.898438-7.769532-4.964844-14.800782-9.496094-20.898438-13.46875-9.75-6.355468-14.808594-8.5-20.035156-8.5-13.3125  0-25.75 2.253906-36.972656 6.699219-11.257813 4.457031-21.003906 10.578125-28.96875 18.199219-7.605469 7.28125-14.390625 16.121094-20.15625  26.273437-5.558594 9.785157-10.058594 19.992188-13.371094 30.339844-3.199219 10.003906-5.875 20.945313-7.953125 32.523437-2.058594 11.476563-3.457031  22.363282-4.148437 32.363282-.679688 9.796875-1.023438 19.964844-1.023438 30.234375 0 26.726562 8.496094 48.363281 25.25 64.320312 16.546875 15.746094  38.441406 23.734375 65.066406 23.734375h246.53125c26.625 0 48.511719-7.984375 65.0625-23.734375 16.757813-15.945312 25.253906-37.585937  25.253906-64.324219-.003906-10.316406-.351562-20.492187-1.035156-30.242187zm0 0"}))),n.a.createElement("div",{className:"infos-container ".concat(a?"bright":"")},e),t&&n.a.createElement("div",{className:"picto-container-inverted ".concat(a?"picto-bright":"")},n.a.createElement("svg",{viewBox:"-42 0 512 512.002",width:"18"},n.a.createElement("path",{d:"m210.351562 246.632812c33.882813 0 63.222657-12.152343 87.195313-36.128906 23.972656-23.972656 36.125-53.304687  36.125-87.191406 0-33.875-12.152344-63.210938-36.128906-87.191406-23.976563-23.96875-53.3125-36.121094-87.191407-36.121094-33.886718  0-63.21875 12.152344-87.191406 36.125s-36.128906 53.308594-36.128906 87.1875c0 33.886719 12.15625 63.222656 36.132812 87.195312 23.976563  23.96875 53.3125 36.125 87.1875 36.125zm0 0"}),n.a.createElement("path",{d:"m426.128906 393.703125c-.691406-9.976563-2.089844-20.859375-4.148437-32.351563-2.078125-11.578124-4.753907-22.523437-7.957031-32.527343-3.308594-10.339844-7.808594-20.550781-13.371094-30.335938-5.773438-10.15625-12.554688-19-20.164063-26.277343-7.957031-7.613282-17.699219-13.734376-28.964843-18.199219-11.226563-4.441407-23.667969-6.691407-36.976563-6.691407-5.226563  0-10.28125 2.144532-20.042969 8.5-6.007812 3.917969-13.035156 8.449219-20.878906 13.460938-6.707031 4.273438-15.792969 8.277344-27.015625  11.902344-10.949219 3.542968-22.066406 5.339844-33.039063 5.339844-10.972656 0-22.085937-1.796876-33.046874-5.339844-11.210938-3.621094-20.296876-7.625-26.996094-11.898438-7.769532-4.964844-14.800782-9.496094-20.898438-13.46875-9.75-6.355468-14.808594-8.5-20.035156-8.5-13.3125  0-25.75 2.253906-36.972656 6.699219-11.257813 4.457031-21.003906 10.578125-28.96875 18.199219-7.605469 7.28125-14.390625 16.121094-20.15625  26.273437-5.558594 9.785157-10.058594 19.992188-13.371094 30.339844-3.199219 10.003906-5.875 20.945313-7.953125 32.523437-2.058594 11.476563-3.457031  22.363282-4.148437 32.363282-.679688 9.796875-1.023438 19.964844-1.023438 30.234375 0 26.726562 8.496094 48.363281 25.25 64.320312 16.546875 15.746094  38.441406 23.734375 65.066406 23.734375h246.53125c26.625 0 48.511719-7.984375 65.0625-23.734375 16.757813-15.945312 25.253906-37.585937  25.253906-64.324219-.003906-10.316406-.351562-20.492187-1.035156-30.242187zm0 0"}))))}}var ne=se;class oe extends s.Component{constructor(...e){super(...e),this.updateStatus=(e,t)=>()=>{const{sessionToken:a,fetchUsers:s,requestUpdateUserStatus:n,userInfos:o}=this.props;n(e,t,a).then(()=>{s(S.a.get(o,"corpId"),a)})}}componentDidMount(){const{fetchUsers:e,sessionToken:t,userInfos:a}=this.props;e(S.a.get(a,"corpId"),t)}render(){const{users:e,userInfos:t,isBright:a}=this.props;S.a.get(t,"status","user"),S.a.get(t,"id");return n.a.createElement(b.Scrollbars,{autoHeight:!0,autoHeightMin:0,autoHeightMax:200},n.a.createElement("div",{className:"users-container".concat(a?"":"--bright")},S.a.map(S.a.orderBy(e,"name"),e=>{D()({"status-container":!0,"status-container--toggled":"admin"===e.status}),D()({"status-container":!0,"status-container--toggled":"user"===e.status});return n.a.createElement("div",{className:"user-item"},n.a.createElement(ne,{user:e}))})))}}var ie=Object(r.b)(e=>({loading:e.users.loading,users:e.users.users,hasErrors:e.users.hasErrors,sessionToken:e.me.sessionToken,userInfos:e.me.infos}),e=>Object(i.bindActionCreators)({fetchUsers:U,requestUpdateUserStatus:R},e))(oe);class re extends s.Component{constructor(e){super(e),this.updateMail=e=>this.setState({mail:e.target.value}),this.sendInvitation=()=>{const{requestInviteUser:e,sessionToken:t,userInfos:a}=this.props,{mail:s}=this.state;e(s,_.get(a,"corpId"),t).then(()=>{this.setState({mail:""})})},this.state={mail:""}}render(){const{mail:e}=this.state,{userInfos:t,isLoading:a}=this.props,s="admin"===_.get(t,"status","user");return n.a.createElement("div",{className:"invitation-popup-container"},n.a.createElement("div",{className:"title"},"Users"),n.a.createElement(ie,null),s&&n.a.createElement("div",{className:"bottom-space"},n.a.createElement(P,{value:e,onChange:this.updateMail,placeholder:"Mail",isDescription:!1})),s&&n.a.createElement(F,{clickAction:this.sendInvitation,label:"SEND INVITATION",isLoading:a}))}}var ce=Object(r.b)(e=>({sessionToken:e.me.sessionToken,userInfos:e.me.infos,isLoading:e.users.loading}),e=>Object(i.bindActionCreators)({requestInviteUser:M},e))(re);a(397);class le extends s.Component{constructor(e){super(e),this.state={}}render(){return n.a.createElement("div",{className:"hours-container"},S.a.map(S.a.range(15),e=>n.a.createElement("div",{style:{top:"".concat(Math.floor(100*e/14),"%")},className:"hour-container"},"".concat(e+6,"h"))))}}var pe=le;a(398);class de extends s.Component{constructor(e){super(e),this.state={}}render(){return n.a.createElement("div",{className:"hours-lines-container"},S.a.map(S.a.range(13),e=>n.a.createElement("div",{style:{top:"".concat(Math.floor(100*(e+1)/14),"%")},className:"hour-line-container"})))}}var he=de;a(399),a(400);class me extends s.Component{constructor(e){super(e),this.setToggle=()=>{const{applyToggle:e,id:t}=this.props;this.setState(e=>({isToggled:!e.isToggled}),()=>{e(t,this.state.isToggled)})},this.state={isToggled:!0}}render(){const{isToggled:e}=this.state,t=_.isEmpty(this.props.color)?"#43d8c9":this.props.color;D()({"sidebar-container":!0,"sidebar-container--toggled":e}),D()({"sidebar-item-label":!0,"sidebar-item-label--toggled":e});return n.a.createElement("div",{className:"checkbox",onClick:this.setToggle},n.a.createElement("svg",{viewBox:"0 0 512 512",width:"20",height:"20"},n.a.createElement("path",{d:"m512 58.667969c0-32.363281-26.304688-58.667969-58.667969-58.667969h-394.664062c-32.363281 0-58.667969 26.304688-58.667969 58.667969v394.664062c0 32.363281 26.304688 58.667969 58.667969 58.667969h394.664062c32.363281 0 58.667969-26.304688 58.667969-58.667969zm0 0",fill:e?t:"#ffffff"}),n.a.createElement("path",{d:"m385.75 171.585938c8.339844 8.339843 8.339844 21.820312 0 30.164062l-138.667969 138.664062c-4.160156 4.160157-9.621093 6.253907-15.082031 6.253907s-10.921875-2.09375-15.082031-6.253907l-69.332031-69.332031c-8.34375-8.339843-8.34375-21.824219 0-30.164062 8.339843-8.34375 21.820312-8.34375 30.164062 0l54.25 54.25 123.585938-123.582031c8.339843-8.34375 21.820312-8.34375 30.164062 0zm0 0",fill:e?"#000000":"#ffffff"})))}}a(401);class ue extends s.Component{constructor(e){super(e),this.state={}}render(){return n.a.createElement("div",null,"Settings menu")}}a(402);class Ee extends s.Component{constructor(e){super(e),this.state={}}render(){return n.a.createElement("div",null,"Team menu")}}class ve extends s.Component{constructor(e){super(e),this.setToggle=e=>()=>{this.setState({isToggled:e})},this.setSubMenuToggle=e=>()=>{this.setState({menuToggle:e})},this.state={isToggled:!0,menuToggle:-1}}render(){const{recipients:e,toggleRecipient:t,openInvitationPopup:a,logout:s,userName:o}=this.props,{isToggled:i,menuToggle:r}=this.state,c=D()({"sidebar-container":!0,"sidebar-container--toggled":i}),l=(D()({"sidebar-item-label":!0,"sidebar-item-label--toggled":i}),D()({"submenu-container":!0,"submenu-container--toggled":-1!==r})),p=D()({"submenu-halo-container":!0,"submenu-halo-container--toggled":-1!==r});return n.a.createElement("div",{className:"sidebar-big-container"},n.a.createElement("div",{className:"sidebar-user-display"},n.a.createElement(ne,{user:{name:o},inverted:!0,isBright:!0})),n.a.createElement("div",{className:c},n.a.createElement("div",{className:"recipients-container"},_.map(e,e=>n.a.createElement("div",{className:"recipient-container"}," ","".concat(e.name),n.a.createElement(me,{applyToggle:t,id:e.id})))),n.a.createElement("div",{className:"sidebar-bottom-menu"},n.a.createElement("div",{className:"sidebar-item-container",onClick:a},n.a.createElement("div",null,n.a.createElement("svg",{viewBox:"0 0 512 512",width:"20",height:"20"},n.a.createElement("g",null,n.a.createElement("g",null,n.a.createElement("path",{d:"M438.09,273.32h-39.596c4.036,11.05,6.241,22.975,6.241,35.404v149.65c0,5.182-0.902,10.156-2.543,14.782h65.461 c24.453,0,44.346-19.894,44.346-44.346v-81.581C512,306.476,478.844,273.32,438.09,273.32z"}))),n.a.createElement("g",null,n.a.createElement("g",null,n.a.createElement("path",{d:"M107.265,308.725c0-12.43,2.205-24.354,6.241-35.404H73.91c-40.754,0-73.91,33.156-73.91,73.91v81.581 c0,24.452,19.893,44.346,44.346,44.346h65.462c-1.641-4.628-2.543-9.601-2.543-14.783V308.725z"}))),n.a.createElement("g",null,n.a.createElement("g",null,n.a.createElement("path",{d:"M301.261,234.815h-90.522c-40.754,0-73.91,33.156-73.91,73.91v149.65c0,8.163,6.618,14.782,14.782,14.782h208.778 c8.164,0,14.782-6.618,14.782-14.782v-149.65C375.171,267.971,342.015,234.815,301.261,234.815z"}))),n.a.createElement("g",null,n.a.createElement("g",null,n.a.createElement("path",{d:"M256,38.84c-49.012,0-88.886,39.874-88.886,88.887c0,33.245,18.349,62.28,45.447,77.524 c12.853,7.23,27.671,11.362,43.439,11.362c15.768,0,30.586-4.132,43.439-11.362c27.099-15.244,45.447-44.28,45.447-77.524 C344.886,78.715,305.012,38.84,256,38.84z"}))),n.a.createElement("g",null,n.a.createElement("g",null,n.a.createElement("path",{d:"M99.918,121.689c-36.655,0-66.475,29.82-66.475,66.475c0,36.655,29.82,66.475,66.475,66.475 c9.298,0,18.152-1.926,26.195-5.388c13.906-5.987,25.372-16.585,32.467-29.86c4.98-9.317,7.813-19.946,7.813-31.227 C166.393,151.51,136.573,121.689,99.918,121.689z"}))),n.a.createElement("g",null,n.a.createElement("g",null,n.a.createElement("path",{d:"M412.082,121.689c-36.655,0-66.475,29.82-66.475,66.475c0,11.282,2.833,21.911,7.813,31.227 c7.095,13.276,18.561,23.874,32.467,29.86c8.043,3.462,16.897,5.388,26.195,5.388c36.655,0,66.475-29.82,66.475-66.475 C478.557,151.509,448.737,121.689,412.082,121.689z"})))))),n.a.createElement("div",{className:"sidebar-item-container",onClick:s},n.a.createElement("div",null,n.a.createElement("svg",{viewBox:"0 0 512 512",width:"20",height:"20"},n.a.createElement("path",{d:"m320 277.335938c-11.796875 0-21.332031 9.558593-21.332031 21.332031v85.335937c0 11.753906-9.558594 21.332032-21.335938 21.332032h-64v-320c0-18.21875-11.605469-34.496094-29.054687-40.554688l-6.316406-2.113281h99.371093c11.777344 0 21.335938 9.578125 21.335938 21.335937v64c0 11.773438 9.535156 21.332032 21.332031 21.332032s21.332031-9.558594 21.332031-21.332032v-64c0-35.285156-28.714843-63.99999975-64-63.99999975h-229.332031c-.8125 0-1.492188.36328175-2.28125.46874975-1.027344-.085937-2.007812-.46874975-3.050781-.46874975-23.53125 0-42.667969 19.13281275-42.667969 42.66406275v384c0 18.21875 11.605469 34.496093 29.054688 40.554687l128.386718 42.796875c4.351563 1.34375 8.679688 1.984375 13.226563 1.984375 23.53125 0 42.664062-19.136718 42.664062-42.667968v-21.332032h64c35.285157 0 64-28.714844 64-64v-85.335937c0-11.773438-9.535156-21.332031-21.332031-21.332031zm0 0"}),n.a.createElement("path",{d:"m505.75 198.253906-85.335938-85.332031c-6.097656-6.101563-15.273437-7.9375-23.25-4.632813-7.957031 3.308594-13.164062 11.09375-13.164062 19.714844v64h-85.332031c-11.777344 0-21.335938 9.554688-21.335938 21.332032 0 11.777343 9.558594 21.332031 21.335938 21.332031h85.332031v64c0 8.621093 5.207031 16.40625 13.164062 19.714843 7.976563 3.304688 17.152344 1.46875 23.25-4.628906l85.335938-85.335937c8.339844-8.339844 8.339844-21.824219 0-30.164063zm0 0"})))))),n.a.createElement("div",{className:l},0===r&&n.a.createElement(ue,null),1===r&&n.a.createElement(Ee,null)),n.a.createElement("div",{onClick:this.setSubMenuToggle(-1),className:p}))}}var ge=ve;a(403);function fe(e,t){return async a=>{a({type:"AUTHENTICATE"});try{const s=await fetch("https://i8jk577b46.execute-api.eu-west-3.amazonaws.com/alpha/authentication?mail=".concat(A(e),"&password=").concat(A(t))),n=await s.json();200===n.statusCode?a({type:"AUTHENTICATE_SUCCESS",payload:n.body}):(w.NotificationManager.error("Authentication error: ".concat(A(n).body,"!"),"Error!"),a({type:"AUTHENTICATE_FAILURE"}))}catch(e){w.NotificationManager.error("Authentication error!","Error!"),a({type:"AUTHENTICATE_FAILURE"})}}}function ye(e,t){return async a=>{a({type:"GET_OFFDAYS"});try{const s=await fetch("https://i8jk577b46.execute-api.eu-west-3.amazonaws.com/alpha/offdays?user_id=".concat(A(e)),{headers:{authorization:t}}),n=await s.json();200===n.statusCode?a({type:"GET_OFFDAYS_SUCCESS",payload:JSON.parse(n.body)}):(w.NotificationManager.error("Error when fetching off days","Error!"),a({type:"GET_OFFDAYS_FAILURE"}))}catch(e){w.NotificationManager.error("Error when fetching off days","Error!"),a({type:"GET_OFFDAYS_FAILURE"})}}}function Ne(e){return async t=>{t({type:"GET_COMPANY_OFFDAYS"});try{const a=await fetch("https://i8jk577b46.execute-api.eu-west-3.amazonaws.com/alpha/companyoffdays",{headers:{authorization:e}}),s=await a.json();200===s.statusCode?t({type:"GET_COMPANY_OFFDAYS_SUCCESS",payload:JSON.parse(s.body)}):(w.NotificationManager.error("Error when fetching off days","Error!"),t({type:"GET_COMPANY_OFFDAYS_FAILURE"}))}catch(e){w.NotificationManager.error("Error when fetching off days","Error!"),t({type:"GET_COMPANY_OFFDAYS_FAILURE"})}}}function Se(e,t,a){return async s=>{try{await fetch("https://i8jk577b46.execute-api.eu-west-3.amazonaws.com/alpha/offdays?user_id=".concat(A(e),"&date=").concat(A(t)),{headers:{authorization:a},method:"PUT"})}catch(e){w.NotificationManager.error("Error when adding off day","Error!"),s(addOffDayFailure())}}}function Te(e,t){return async a=>{try{await fetch("https://i8jk577b46.execute-api.eu-west-3.amazonaws.com/alpha/offdays?id=".concat(A(e)),{headers:{authorization:t},method:"DELETE"})}catch(e){w.NotificationManager.error("Error when deleting off day","Error!"),a(deleteOffDayFailure())}}}const De=()=>({type:"LOGOUT"});var Ce=a(35);class Oe extends s.Component{constructor(e){super(e),this.setPopupState=e=>{this.setState({isPopupDisplayed:e})},this.setPopupContent=e=>{this.setState({popupContent:e})},this.openNewEventPopup=()=>{const e=n.a.createElement(ae,{closePopup:()=>{this.setPopupState(!1)},fetchEventsData:this.fetchEventsData});this.setState({popupContent:e,isPopupDisplayed:!0})},this.openInvitationPopup=()=>{const e=n.a.createElement(ce,{closePopup:()=>{this.setPopupState(!1)}});this.setState({popupContent:e,isPopupDisplayed:!0})},this.fetchEventsData=()=>{const{sessionToken:e,fetchEvents:t,userInfos:a}=this.props;t(this.state.fetchDate,e,S.a.get(a,"corpId")).then(()=>{if(this.isWeekOnTwoMonths()){const s=v(this.state.weekStart).add(4,"d"),n=v(s).month()+1,o=v(s).year(),i=n<10?"0".concat(n):n;t("".concat(o,"_").concat(i),e,S.a.get(a,"corpId"),!0).then(()=>{this.setState({collabsToDisplay:S.a.map(this.getRecipients(this.props.events),"id")})})}else this.setState({collabsToDisplay:S.a.map(this.getRecipients(this.props.events),"id")})})},this.navigateToNextWeek=()=>{const{weekStart:e}=this.state,t=v(e).add(1,"w"),a=v(t).week(),s=v(t).year(),n=v(t).month()+1,o=n<10?"0".concat(n):n;this.props.history.push("/calendar/".concat(a,"/").concat(s)),this.setState({fetchDate:"".concat(s,"_").concat(o),weekStart:t,year:s,week:a})},this.navigateToPreviousWeek=()=>{const{weekStart:e}=this.state,t=v(e).add(-1,"w"),a=v(t).week(),s=v(t).year(),n=v(t).month()+1,o=n<10?"0".concat(n):n;this.props.history.push("/calendar/".concat(a,"/").concat(s)),this.setState({fetchDate:"".concat(s,"_").concat(o),weekStart:t,year:s,week:a})},this.navigateToDate=e=>{const t=Object(g.default)(e,{weekStartsOn:1}),a=v(t).week(),s=v(t).year(),n=v(t).month()+1,o=n<10?"0".concat(n):n;this.props.history.push("/calendar/".concat(a,"/").concat(s)),this.setState({fetchDate:"".concat(s,"_").concat(o),weekStart:t,year:s,week:a})},this.isWeekOnTwoMonths=()=>{const{weekStart:e}=this.state,t=v(e).month();return v(e).add(4,"d").month()!=t},this.getDayFromWeekAndYear=(e,t)=>v().day("Monday").year(t).week(e).add(1,"d").toDate(),this.getRecipients=e=>{let t=[];return S.a.each(e,e=>{t=S.a.uniqBy(S.a.concat(t,S.a.get(e,"invitations",[])),"id")}),t},this.toggleRecipient=(e,t)=>{t?this.setState(t=>({collabsToDisplay:S.a.uniq(S.a.concat(t.collabsToDisplay,e))})):this.setState(t=>({collabsToDisplay:S.a.difference(t.collabsToDisplay,[e])}))},this.logout=()=>{const{logout:e,history:t}=this.props;e(),t.push("/login")},this.openDatePicker=()=>{this.datePickerRef.current.setOpen(!0)},this.datePickerRef=n.a.createRef(),this.state={weekStart:null,year:S.a.parseInt(e.match.params.year)||v().year(),week:S.a.parseInt(e.match.params.week)||v().week(),sidebarOpen:!1,collabsToDisplay:[],isPopupDisplayed:!1,popupContent:null,fetchDate:""}}componentDidMount(){const{week:e,year:t}=this.props.match.params,{sessionToken:a,fetchEvents:s,history:n,userInfos:o}=this.props;if(v.locale("fr"),S.a.isNil(a)&&n.push("/login"),Ce.isMobileOnly&&n.push("/mcalendar"),S.a.isNil(e)||S.a.isNil(t))this.setState({weekStart:Object(g.default)(new Date,{weekStartsOn:1})},()=>{const e=v(this.state.weekStart).month()+1,t=v(this.state.weekStart).year(),n=e<10?"0".concat(e):e;this.setState({fetchDate:"".concat(t,"_").concat(n)},()=>{s(this.state.fetchDate,a,S.a.get(o,"corpId")).then(()=>{if(this.isWeekOnTwoMonths()){const e=v(this.state.weekStart).add(4,"d"),t=v(e).month()+1,n=v(e).year(),i=t<10?"0".concat(t):t;s("".concat(n,"_").concat(i),a,S.a.get(o,"corpId"),!0).then(()=>{this.setState({collabsToDisplay:S.a.map(this.getRecipients(this.props.events),"id")})})}else this.setState({collabsToDisplay:S.a.map(this.getRecipients(this.props.events),"id")})})})});else{const n=this.getDayFromWeekAndYear(e-1,t);this.setState({weekStart:n},()=>{const e=v(this.state.weekStart).month()+1,t=v(this.state.weekStart).year(),n=e<10?"0".concat(e):e;this.setState({fetchDate:"".concat(t,"_").concat(n)},()=>{s(this.state.fetchDate,a,S.a.get(o,"corpId")).then(()=>{if(this.isWeekOnTwoMonths()){const e=v(this.state.weekStart).add(4,"d"),t=v(e).month()+1,n=v(e).year(),i=t<10?"0".concat(t):t;s("".concat(n,"_").concat(i),a,S.a.get(o,"corpId"),!0).then(()=>{this.setState({collabsToDisplay:S.a.map(this.getRecipients(this.props.events),"id")})})}else this.setState({collabsToDisplay:S.a.map(this.getRecipients(this.props.events),"id")})})})})}}componentDidUpdate(e,t){const{sessionToken:a,fetchEvents:s,userInfos:n}=this.props;(t.fetchDate!==this.state.fetchDate||t.weekStart!==this.state.weekStart&&this.isWeekOnTwoMonths())&&s(this.state.fetchDate,a,S.a.get(n,"corpId")).then(()=>{if(this.isWeekOnTwoMonths()){const e=v(this.state.weekStart).add(4,"d"),t=v(e).month()+1,o=v(e).year(),i=t<10?"0".concat(t):t;s("".concat(o,"_").concat(i),a,S.a.get(n,"corpId"),!0).then(()=>{this.setState({collabsToDisplay:S.a.map(this.getRecipients(this.props.events),"id")})})}else this.setState({collabsToDisplay:S.a.map(this.getRecipients(this.props.events),"id")})})}onSetSidebarOpen(e){this.setState({sidebarOpen:e})}render(){const{weekStart:e,isPopupDisplayed:t,popupContent:a}=this.state,{userInfos:s}=this.props,o=S.a.filter(this.props.events,e=>!S.a.isEmpty(S.a.intersection(this.state.collabsToDisplay,S.a.map(e.invitations,"id")))),i=S.a.groupBy(o,e=>Object(f.a)(v(e.date)._d)),r=[];S.a.forEach(S.a.times(5),t=>{const a=v(e).add(t,"d")._d;r.push({day:a,isToday:Object(y.a)(a)})});const c=D()({"popup-halo":!0,"popup-halo--toggled":t});return!S.a.isNil(e)&&n.a.createElement("div",{className:"calendar-container"},n.a.createElement(ge,{recipients:this.getRecipients(this.props.events),toggleRecipient:this.toggleRecipient,openInvitationPopup:this.openInvitationPopup,logout:this.logout,userName:S.a.get(s,"name")}),n.a.createElement("div",{className:"week-navigation-container"},n.a.createElement("div",{className:"week-navigation-holder"},n.a.createElement("div",{className:"top"},n.a.createElement("div",{className:"calendar-navigation-container",onClick:this.navigateToPreviousWeek},n.a.createElement("svg",{viewBox:"0 0 512 512",width:"20",height:"20"},n.a.createElement("path",{d:"M198.608,246.104L382.664,62.04c5.068-5.056,7.856-11.816,7.856-19.024c0-7.212-2.788-13.968-7.856-19.032l-16.128-16.12\r C361.476,2.792,354.712,0,347.504,0s-13.964,2.792-19.028,7.864L109.328,227.008c-5.084,5.08-7.868,11.868-7.848,19.084\r c-0.02,7.248,2.76,14.028,7.848,19.112l218.944,218.932c5.064,5.072,11.82,7.864,19.032,7.864c7.208,0,13.964-2.792,19.032-7.864\r l16.124-16.12c10.492-10.492,10.492-27.572,0-38.06L198.608,246.104z"}))),n.a.createElement("div",{onClick:this.openDatePicker},"".concat(v(e).format("D MMM")," - ").concat(v(e).add(4,"d").format("D MMM"))),n.a.createElement("div",{className:"calendar-navigation-container",onClick:this.navigateToNextWeek},n.a.createElement("svg",{viewBox:"0 0 512 512",width:"20",height:"20"},n.a.createElement("path",{d:"M382.678,226.804L163.73,7.86C158.666,2.792,151.906,0,144.698,0s-13.968,2.792-19.032,7.86l-16.124,16.12\r c-10.492,10.504-10.492,27.576,0,38.064L293.398,245.9l-184.06,184.06c-5.064,5.068-7.86,11.824-7.86,19.028\r c0,7.212,2.796,13.968,7.86,19.04l16.124,16.116c5.068,5.068,11.824,7.86,19.032,7.86s13.968-2.792,19.032-7.86L382.678,265\r c5.076-5.084,7.864-11.872,7.848-19.088C390.542,238.668,387.754,231.884,382.678,226.804z"})))),n.a.createElement("div",{className:"bottom",onClick:this.openDatePicker},"".concat(v(e).format("YYYY"))),n.a.createElement(ee.a,{ref:this.datePickerRef,selected:e._d,onChange:this.navigateToDate}))),n.a.createElement("div",{className:"add-action-btn-container"},n.a.createElement(F,{clickAction:this.openNewEventPopup,label:"Add event"})),n.a.createElement("div",{className:"calendar-center-container"},n.a.createElement(O,{daysOfWeek:r}),n.a.createElement(pe,null),n.a.createElement(he,null),S.a.map(r,(e,t)=>n.a.createElement(X,{setPopupState:this.setPopupState,setPopupContent:this.setPopupContent,day:e.day,index:t,events:S.a.get(i,"[".concat(Object(f.a)(e.day),"]"),[]),fetchEventsData:this.fetchEventsData}))),t&&n.a.createElement("div",null,n.a.createElement("div",{className:c,onClick:()=>{this.setPopupState(!1)}}),n.a.createElement("div",{className:"popup-container"},a)))}}Object(r.b)(e=>({loading:e.events.loading,events:e.events.events,hasErrors:e.events.hasErrors,sessionToken:e.me.sessionToken,userInfos:e.me.infos}),e=>Object(i.bindActionCreators)({fetchEvents:G,logout:De},e))(Oe),a(405),a(406);function be(e){return async t=>{t({type:"GET_OPERATIONS"});try{const a=await fetch("https://i8jk577b46.execute-api.eu-west-3.amazonaws.com/alpha/operation",{headers:{authorization:e}}),s=await a.json();t({type:"GET_OPERATIONS_SUCCESS",payload:JSON.parse(s.body)})}catch(e){t({type:"GET_OPERATIONS_FAILURE"})}}}function _e(e,t){return async a=>{a({type:"GET_MY_OPERATIONS"});try{const s=await fetch("https://i8jk577b46.execute-api.eu-west-3.amazonaws.com/alpha/myoperations?user_id=".concat(e),{headers:{authorization:t}}),n=await s.json();a({type:"GET_MY_OPERATIONS_SUCCESS",payload:JSON.parse(n.body)})}catch(e){a({type:"GET_MY_OPERATIONS_FAILURE"})}}}function ke(e,t){return async a=>{a({type:"GET_OPERATION_SETTINGS"});try{const s=await fetch("https://i8jk577b46.execute-api.eu-west-3.amazonaws.com/alpha/operation/rdvsettings?id=".concat(A(t)),{headers:{authorization:e}}),n=await s.json();a({type:"GET_OPERATION_SETTINGS_SUCCESS",payload:JSON.parse(n.body)})}catch(e){a({type:"GET_OPERATION_SETTINGS_FAILURE"})}}}function Ie(e,t,a){return async s=>{s({type:"UPDATE_OPERATION_SETTINGS"});try{const n=await fetch("https://i8jk577b46.execute-api.eu-west-3.amazonaws.com/alpha/operation/rdvsettings?id=".concat(A(t)),{headers:{authorization:e,"Content-Type":"application/json"},method:"POST",body:A(a)}),o=await n.json();w.NotificationManager.success("You have edited operation settings!","Successful!",1500),s({type:"UPDATE_OPERATION_SETTINGS_SUCCESS",payload:JSON.parse(o.body)})}catch(e){w.NotificationManager.error("Error while editing operation settings!","Error!"),s({type:"UPDATE_OPERATION_SETTINGS_FAILURE"})}}}function Pe(e,t,a,s,n){return async o=>{o({type:"UPDATE_OPERATION_TOTAL"});try{await fetch("https://i8jk577b46.execute-api.eu-west-3.amazonaws.com/alpha/operation/totals?total_name=".concat(A(t),"&date=").concat(A(a),"&operation_id=").concat(A(s),"&total_value=").concat(A(n)),{headers:{authorization:e},method:"POST"});w.NotificationManager.success("Total successfully updated!","Successful!",1500),o((id,{type:"UPDATE_OPERATION_TOTAL_SUCCESS"}))}catch(e){console.log(e)}}}function we(e,t,a,s){return async n=>{n({type:"PUT_OPERATION"});try{const i=await fetch("https://i8jk577b46.execute-api.eu-west-3.amazonaws.com/alpha/operation?name=".concat(A(e),"&data=").concat(A(t),"&rdvloc=").concat(A(a)),{headers:{authorization:s},method:"PUT"});await i.json();w.NotificationManager.success("You have added an Operation!","Successful!",1500),n({type:"PUT_OPERATION_SUCCESS",payload:o})}catch(e){w.NotificationManager.error("Error while Creating Operation!","Error!"),n({type:"PUT_OPERATION_FAILURE"})}var o}}function Ae(e,t,a,s,n){return async o=>{o({type:"UPDATE_OPERATION"});try{await fetch("https://i8jk577b46.execute-api.eu-west-3.amazonaws.com/alpha/operation?id=".concat(A(e),"&data=").concat(A(t),"&name=").concat(A(s),"&rdvloc=").concat(A(a)),{headers:{authorization:n},method:"POST"});w.NotificationManager.success("You have edited an Operation!","Successful!",1500),o({type:"UPDATE_OPERATION_SUCCESS",payload:i})}catch(e){w.NotificationManager.error("Error while editing Operation!","Error!"),o({type:"UPDATE_OPERATION_FAILURE"})}var i}}const Ue=()=>({type:"DELETE_OPERATION"});function Me(e,t){return async a=>{a({type:"DELETE_OPERATION"});try{await fetch("https://i8jk577b46.execute-api.eu-west-3.amazonaws.com/alpha/operation?id=".concat(A(e)),{headers:{authorization:t},method:"DELETE"});w.NotificationManager.success("Event successfully deleted!","Successful!",1500),a((e=>({type:"DELETE_OPERATION_SUCCESS",payload:e}))(e))}catch(e){w.NotificationManager.error("Error while deleting Event!","Error!"),a({type:"DELETE_OPERATION_FAILURE"})}}}class je extends s.Component{constructor(e){super(e),this.onValueChange=e=>this.setState({value:e.target.value}),this.getSelectedUsersIds=()=>{const{selectedUsers:e}=this.state;return S.a.map(e,e=>e.id)},this.addUser=e=>()=>{const{selectedUsers:t}=this.state,{setSelectedUsersIds:a}=this.props,s=[e];this.setState({selectedUsers:s},()=>{a(this.getSelectedUsersIds())})},this.removeUser=e=>()=>{const{selectedUsers:t}=this.state,{setSelectedUsersIds:a}=this.props,s=S.a.differenceBy(t,[e],e=>e.id);this.setState({selectedUsers:s},()=>{a(this.getSelectedUsersIds())})},this.setFocus=e=>()=>this.setState({isFocused:e}),this.setHover=e=>()=>this.setState({isHovered:e}),this.state={selectedUsers:[],value:"",isFocused:!1,isHovered:!1}}componentDidMount(){const{fetchOperations:e,sessionToken:t,operations:a,defaultSelected:s}=this.props;e(t).then(()=>{this.setState({selectedUsers:S.a.filter(a,e=>S.a.includes(s,e.id))})})}render(){const{selectedUsers:e,value:t,isFocused:a,isHovered:s}=this.state,{operations:o,hideOperation:i}=this.props,r=this.getSelectedUsersIds(),c=S.a.filter(o,e=>!S.a.includes(r,e.id)),l=S.a.filter(c,e=>S.a.includes(S.a.lowerCase(e.name),S.a.lowerCase(t)));return n.a.createElement("div",null,n.a.createElement("input",{className:"user-selector-input",value:t,onChange:this.onValueChange,placeholder:"Search for operations",onFocus:this.setFocus(!0),onBlur:this.setFocus(!1)}),(a||s)&&n.a.createElement("div",{className:"selection-container",onMouseEnter:this.setHover(!0),onMouseLeave:this.setHover(!1)},S.a.map(l,e=>n.a.createElement("div",{className:"selection-item",onClick:this.addUser(e)},e.name))),!(a||s)&&n.a.createElement("div",{className:"selection-placebo"}),!i&&n.a.createElement("div",{className:"selected-container"},S.a.map(e,e=>n.a.createElement("div",{className:"selected-item",onClick:this.removeUser(e)},e.name))))}}var Re=Object(r.b)(e=>({loading:e.operations.loading,operations:e.operations.operations,hasErrors:e.operations.hasErrors,sessionToken:e.me.sessionToken}),e=>Object(i.bindActionCreators)({fetchOperations:be},e))(je);class xe extends s.Component{constructor(e){super(e),this.handleChangeDate=e=>{this.setState({eventDate:e})},this.setSelectedUsersIds=e=>this.setState({selectedUsersIds:e}),this.setSelectedOperationsIds=e=>this.setState({selectedOperationsIds:e}),this.onChangeStartTime=e=>this.setState({start_time:e}),this.onChangeEndTime=e=>this.setState({end_time:e}),this.updateTitle=e=>this.setState({title:e.target.value}),this.updateMail=e=>this.setState({mail:e.target.value}),this.updateDescription=e=>this.setState({description:e.target.value}),this.sendCreateEventRequest=()=>{const{title:e,description:t,eventDate:a,start_time:s,end_time:n,selectedOperationsIds:o,mail:i}=this.state,{createEvent:r,fetchEventsData:c,closePopup:l,sessionToken:p,userInfos:d}=this.props;r(e,t,"".concat(v(a).year(),"-").concat(v(a).month()+1,"-").concat(v(a).date()),s,n,"-",p,_.get(d,"corpId"),"rdv",o[0],"-",i).then(()=>{c(),l()})},this.state={title:"Title",description:"Description",eventDate:new Date,start_time:"10:00",end_time:"12:00",mail:"",selectedUsersIds:[],selectedOperationsIds:[]}}componentDidMount(){const{fetchUsers:e,sessionToken:t,userInfos:a}=this.props;e(_.get(a,"corpId"),t)}render(){const{title:e,description:t,mail:a}=this.state,{isLoading:s}=this.props;return n.a.createElement("div",{className:"new-event-popup-container"},n.a.createElement("div",{className:"top-popup-container"},n.a.createElement("div",{className:"title"},"New event"),n.a.createElement("div",{className:"edit-box"},n.a.createElement("div",{className:"left"},n.a.createElement(P,{value:e,onChange:this.updateTitle,placeholder:"Title here",isDescription:!1}),n.a.createElement(P,{value:t,onChange:this.updateDescription,placeholder:"Description here",isDescription:!0}),n.a.createElement(P,{value:a,onChange:this.updateMail,placeholder:"Email here",isDescription:!1})),n.a.createElement("div",{className:"right"},n.a.createElement("div",{className:"date-picker"},n.a.createElement(ee.a,{selected:this.state.eventDate,onChange:this.handleChangeDate})),n.a.createElement("div",{className:"time-pickers-container"},n.a.createElement("div",{className:"time-picker"},n.a.createElement("div",{className:"time-label"},"from : "),n.a.createElement(I.a,{onChange:this.onChangeStartTime,value:this.state.start_time})),n.a.createElement("div",{className:"time-picker"},n.a.createElement("div",{className:"time-label"},"to : "),n.a.createElement(I.a,{onChange:this.onChangeEndTime,value:this.state.end_time}))))),n.a.createElement(Re,{setSelectedUsersIds:this.setSelectedOperationsIds})),n.a.createElement("div",{className:"save-btn"},n.a.createElement(F,{clickAction:this.sendCreateEventRequest,label:"Save",isLoading:s})))}}var Le=Object(r.b)(e=>({loading:e.users.loading,users:e.users.users,hasErrors:e.users.hasErrors,sessionToken:e.me.sessionToken,userInfos:e.me.infos,isLoading:e.events.loading}),e=>Object(i.bindActionCreators)({createEvent:q,fetchUsers:U},e))(xe);a(407),a(408);class ze extends s.Component{constructor(e){super(e),this.setToggle=e=>{const{applyKey:t,id:a}=this.props,{toggledKey:s}=this.state,n="".concat(e,"/").concat(_.get(_.split(s,"/"),"[1]","nca"));this.setState({toggledKey:n},()=>{t(a,n)})},this.setIsca=e=>{const{applyKey:t,id:a}=this.props,{toggledKey:s}=this.state,n="".concat(_.split(s,"/")[0],"/").concat(e?"ca":"nca");this.setState({toggledKey:n},()=>{t(a,n)})},this.state={toggledKey:e.defaultToggledKey}}render(){const{toggledKey:e}=this.state,{keyValues:t,showLabels:a,name:s}=this.props,o=_.isEmpty(this.props.color)?"#43d8c9":this.props.color,i=_.isEqual(_.get(_.split(e,"/"),"[1]","nca"),"ca");return n.a.createElement("div",{className:"single-selection"},n.a.createElement("div",{className:"labels"},a&&_.map(t,e=>n.a.createElement("div",{className:"value-label"},e.value)),a&&n.a.createElement("div",{className:"value-label"},"C/A")),n.a.createElement("div",{className:"boxes"},n.a.createElement("div",{className:"name"},s),_.map(t,t=>{const a=_.isEqual(_.split(e,"/")[0],t.key);D()({"sidebar-container":!0,"sidebar-container--toggled":a}),D()({"sidebar-item-label":!0,"sidebar-item-label--toggled":a});return n.a.createElement("div",{className:"checkbox",onClick:_.partial(this.setToggle,t.key)},n.a.createElement("svg",{viewBox:"0 0 512 512",width:"20",height:"20"},n.a.createElement("path",{d:"m512 58.667969c0-32.363281-26.304688-58.667969-58.667969-58.667969h-394.664062c-32.363281\r 0-58.667969 26.304688-58.667969 58.667969v394.664062c0 32.363281 26.304688 58.667969 58.667969\r 58.667969h394.664062c32.363281 0 58.667969-26.304688 58.667969-58.667969zm0 0",fill:o}),n.a.createElement("path",{d:"m385.75 171.585938c8.339844 8.339843 8.339844 21.820312 0 30.164062l-138.667969 138.664062c-4.160156\r 4.160157-9.621093 6.253907-15.082031 6.253907s-10.921875-2.09375-15.082031-6.253907l-69.332031-69.332031c-8.34375-8.339843-8.34375-21.824219\r 0-30.164062 8.339843-8.34375 21.820312-8.34375 30.164062 0l54.25 54.25 123.585938-123.582031c8.339843-8.34375 21.820312-8.34375 30.164062 0zm0 0",fill:a?"#000000":o})))}),n.a.createElement("div",{className:"checkbox",onClick:_.partial(this.setIsca,!i)},n.a.createElement("svg",{viewBox:"0 0 512 512",width:"20",height:"20"},n.a.createElement("path",{d:"m512 58.667969c0-32.363281-26.304688-58.667969-58.667969-58.667969h-394.664062c-32.363281\r 0-58.667969 26.304688-58.667969 58.667969v394.664062c0 32.363281 26.304688 58.667969 58.667969\r 58.667969h394.664062c32.363281 0 58.667969-26.304688 58.667969-58.667969zm0 0",fill:o}),n.a.createElement("path",{d:"m385.75 171.585938c8.339844 8.339843 8.339844 21.820312 0 30.164062l-138.667969 138.664062c-4.160156\r 4.160157-9.621093 6.253907-15.082031 6.253907s-10.921875-2.09375-15.082031-6.253907l-69.332031-69.332031c-8.34375-8.339843-8.34375-21.824219\r 0-30.164062 8.339843-8.34375 21.820312-8.34375 30.164062 0l54.25 54.25 123.585938-123.582031c8.339843-8.34375 21.820312-8.34375 30.164062 0zm0 0",fill:i?"#000000":o})))))}}class Fe extends s.Component{constructor(e){super(e),this.applyUserHoursKey=(e,t)=>{const{hoursKeys:a}=this.state,s=_.cloneDeep(a);s[e]=t,this.setState({hoursKeys:s})},this.getOffAmos=()=>{const{eventDate:e}=this.state,{users:t,offDays:a}=this.props,s=_.filter(a,t=>v(e).year()===v(t.day).year()&&v(e).dayOfYear()===v(t.day).dayOfYear());if(_.isEmpty(s))return{label:"",ids:[]};const n=_.map(s,e=>_.find(t,{id:e.user_id}));let o="AMO(s) off ce jour : ";return _.each(n,e=>{o+="".concat(e.name,", ")}),{label:o,ids:_.map(s,e=>e.user_id)}},this.handleChangeDate=e=>{this.setState({eventDate:e})},this.setSelectedUsersIds=e=>this.setState({selectedUsersIds:e}),this.setSelectedOperationsIds=e=>this.setState({selectedOperationsIds:e}),this.onChangeStartTime=e=>this.setState({start_time:e}),this.onChangeEndTime=e=>this.setState({end_time:e}),this.updateTitle=e=>this.setState({title:e.target.value}),this.updateDescription=e=>this.setState({description:e.target.value}),this.sendCreateEventRequest=()=>{const{title:e,description:t,eventDate:a,start_time:s,end_time:n,selectedUsersIds:o,selectedOperationsIds:i,hoursKeys:r}=this.state,{createEvent:c,fetchEventsData:l,closePopup:p,sessionToken:d,userInfos:h}=this.props,m="".concat(v(a).year(),"-").concat(v(a).month()+1,"-").concat(v(a).date()),u=_.join(o,","),E=_.join(_.map(o,e=>_.get(r,"".concat(e),"all-day/nca")),",");c(e,t,m,s,n,u,d,_.get(h,"corpId"),"amo",i[0],E,"-").then(()=>{l(),p()})},this.state={title:"Title",description:"Description",eventDate:e.date||new Date,start_time:"10:00",end_time:"12:00",selectedUsersIds:e.selectedUsers||[],selectedOperationsIds:e.selectedOperation||[],hoursKeys:e.hoursKeyObject||{}}}componentDidMount(){const{fetchUsers:e,sessionToken:t,userInfos:a,requestGetCompanyOffDays:s}=this.props;e(_.get(a,"corpId"),t),s(t)}render(){const{title:e,description:t,selectedUsersIds:a,hoursKeys:s}=this.state,{isLoading:o,users:i}=this.props,r=this.getOffAmos();return n.a.createElement("div",{className:"new-event-popup-container"},n.a.createElement("div",{className:"top-popup-container"},n.a.createElement("div",{className:"title"},"Ajouter AMO(s)"),n.a.createElement("div",{className:"edit-box"},n.a.createElement("div",{className:"right"},n.a.createElement("div",{className:"date-picker"},n.a.createElement(ee.a,{selected:this.state.eventDate,onChange:this.handleChangeDate})))),!_.isEmpty(r.label)&&n.a.createElement("div",{className:"off-amos-display"},r.label),n.a.createElement(L,{setSelectedUsersIds:this.setSelectedUsersIds,defaultSelected:this.props.selectedUsers,offIds:r.ids}),n.a.createElement(Re,{setSelectedUsersIds:this.setSelectedOperationsIds,defaultSelected:this.props.selectedOperation})),n.a.createElement("div",{className:"day-time-selection"},_.map(a,(e,t)=>{const a=_.find(i,{id:e});return n.a.createElement(ze,{defaultToggledKey:_.get(s,"".concat(e),"all-day/nca"),keyValues:[{key:"am",value:"AM"},{key:"pm",value:"PM"},{key:"all-day",value:"journée"}],showLabels:0===t,id:a.id,name:a.name,applyKey:this.applyUserHoursKey})})),n.a.createElement("div",{className:"save-btn"},n.a.createElement(F,{clickAction:this.sendCreateEventRequest,label:"Save",isLoading:o})))}}var Ge=Object(r.b)(e=>({loading:e.users.loading,users:e.users.users,hasErrors:e.users.hasErrors,sessionToken:e.me.sessionToken,userInfos:e.me.infos,isLoading:e.events.loading,offDays:e.me.allOffDays}),e=>Object(i.bindActionCreators)({createEvent:q,fetchUsers:U,requestGetCompanyOffDays:Ne},e))(Fe);a(409);class Ye extends s.Component{constructor(e){super(e),this.updateMail=e=>this.setState({mail:e.target.value}),this.sendInvitation=()=>{const{requestInviteUser:e,sessionToken:t,userInfos:a}=this.props,{mail:s}=this.state;e(s,_.get(a,"corpId"),t).then(()=>{this.setState({mail:""})})},this.state={mail:""}}render(){const{mail:e}=this.state,{userInfos:t,isLoading:a}=this.props,s="admin"===_.get(t,"status","user");return n.a.createElement("div",{className:"invitation-popup-container"},n.a.createElement("div",{className:"title"},"Users"),n.a.createElement(ie,null),s&&n.a.createElement("div",{className:"bottom-space"},n.a.createElement(P,{value:e,onChange:this.updateMail,placeholder:"Mail",isDescription:!1})),s&&n.a.createElement(F,{clickAction:this.sendInvitation,label:"SEND INVITATION",isLoading:a}))}}var He=Object(r.b)(e=>({sessionToken:e.me.sessionToken,userInfos:e.me.infos,isLoading:e.users.loading}),e=>Object(i.bindActionCreators)({requestInviteUser:M},e))(Ye);a(410);class qe extends s.Component{constructor(e){super(e),this.callDeleteOperation=e=>()=>{const{postDeleteOperation:t,fetchOperations:a,fetchMyOperations:s,sessionToken:n,userInfos:o}=this.props,i="admin"===_.get(o,"status","user");t(e,n).then(()=>{i?a(n):s(_.get(o,"id"),n)})},this.copyToClipBoard=e=>{var t=document.getElementById(e);t.select(),t.setSelectionRange(0,99999),document.execCommand("copy")},this.state={mail:""}}componentDidMount(){const{fetchOperations:e,fetchMyOperations:t,sessionToken:a,userInfos:s}=this.props;"admin"===_.get(s,"status","user")?e(a):t(_.get(s,"id"),a)}render(){const{mail:e}=this.state,{operations:t,towardsCreateOperationPopup:a,towardsEditOperationPopup:s,userInfos:o,isLoading:i}=this.props,r="admin"===_.get(o,"status","user");return n.a.createElement("div",{className:"operations-popup-container"},n.a.createElement("div",{className:"title"},"Operations"),n.a.createElement(b.Scrollbars,{autoHeight:!0,autoHeightMin:0,autoHeightMax:400},_.map(t,e=>n.a.createElement("div",{className:"operation-container"},n.a.createElement("div",{className:"operation-top"},n.a.createElement("div",{className:"left-container"},n.a.createElement("div",{className:"operation-title"},e.name),n.a.createElement("div",{className:"edit-operation-btn",onClick:s(e.id,e.name,e.data,_.get(e,"location",""))},n.a.createElement("svg",{height:"18px",viewBox:"-15 -15 484.00019 484",width:"18px",xmlns:"http://www.w3.org/2000/svg"},n.a.createElement("path",{d:"m401.648438 18.234375c-24.394532-24.351563-63.898438-24.351563-88.292969 0l-22.101563 22.222656-235.269531 235.144531-.5.503907c-.121094.121093-.121094.25-.25.25-.25.375-.625.746093-.871094 1.121093 0 .125-.128906.125-.128906.25-.25.375-.371094.625-.625 1-.121094.125-.121094.246094-.246094.375-.125.375-.25.625-.378906 1 0 .121094-.121094.121094-.121094.25l-52.199219 156.96875c-1.53125 4.46875-.367187 9.417969 2.996094 12.734376 2.363282 2.332031 5.550782 3.636718 8.867188 3.625 1.355468-.023438 2.699218-.234376 3.996094-.625l156.847656-52.324219c.121094 0 .121094 0 .25-.121094.394531-.117187.773437-.285156 1.121094-.503906.097656-.011719.183593-.054688.253906-.121094.371094-.25.871094-.503906 1.246094-.753906.371093-.246094.75-.621094 1.125-.871094.125-.128906.246093-.128906.246093-.25.128907-.125.378907-.246094.503907-.5l257.371093-257.371094c24.351563-24.394531 24.351563-63.898437 0-88.289062zm-232.273438 353.148437-86.914062-86.910156 217.535156-217.535156 86.914062 86.910156zm-99.15625-63.808593 75.929688 75.925781-114.015626 37.960938zm347.664062-184.820313-13.238281 13.363282-86.917969-86.917969 13.367188-13.359375c14.621094-14.609375 38.320312-14.609375 52.945312 0l33.964844 33.964844c14.511719 14.6875 14.457032 38.332031-.121094 52.949218zm0 0"})))),r&&n.a.createElement(F,{clickAction:this.callDeleteOperation(e.id),label:"supprimer",isLoading:i,isDanger:!0})),n.a.createElement("div",{className:"operation-data"},e.data),n.a.createElement("div",{className:"link-exports"},n.a.createElement("div",{className:"link-export"},n.a.createElement("div",{onClick:_.partial(this.copyToClipBoard,"input-".concat(e.id))},"copier lien export : "),n.a.createElement("input",{type:"text",value:"http://orchestraconseil.fr/calendarexport/".concat(e.id),id:"input-".concat(e.id)})),n.a.createElement("div",{className:"link-export"},n.a.createElement("div",{onClick:_.partial(this.copyToClipBoard,"rdv-".concat(e.id))},"copier lien rdv : "),n.a.createElement("input",{type:"text",value:"http://orchestraconseil.fr/rdv/".concat(e.id),id:"rdv-".concat(e.id)})))))),r&&n.a.createElement(F,{clickAction:a,label:"Ajouter une opération",isLoading:!1}))}}var Be=Object(r.b)(e=>({sessionToken:e.me.sessionToken,userInfos:e.me.infos,isLoading:e.operations.loading,operations:e.operations.operations}),e=>Object(i.bindActionCreators)({fetchOperations:be,createOperation:we,postDeleteOperation:Me,fetchMyOperations:_e},e))(qe);a(411);class Ve extends s.Component{constructor(e){super(e),this.createOperation=()=>{const{createOperation:e,sessionToken:t,towardsOperationPopup:a}=this.props,{name:s,data:n,location:o}=this.state;e(s,n,o,t).then(()=>{a()})},this.updateName=e=>this.setState({name:e.target.value}),this.updateData=e=>this.setState({data:e.target.value}),this.updateLocation=e=>this.setState({location:e.target.value}),this.state={name:"",data:"",location:""}}render(){const{name:e,data:t,location:a}=this.state,{isLoading:s,userInfos:o}=this.props;_.get(o,"status","user");return n.a.createElement("div",{className:"invitation-popup-container"},n.a.createElement("div",{className:"title"},"Nouvelle opération"),n.a.createElement("div",{className:"bottom-space"},n.a.createElement(P,{value:e,onChange:this.updateName,placeholder:"nom de l'opération",isDescription:!1}),n.a.createElement(P,{value:t,onChange:this.updateData,placeholder:"description (liens drive, codes KALITI, infos d'accès, ...)",isDescription:!0}),n.a.createElement(P,{value:a,onChange:this.updateLocation,placeholder:"Lieu de rdv"})),n.a.createElement(F,{clickAction:this.createOperation,label:"Créer l'opération",isLoading:s}))}}var We=Object(r.b)(e=>({sessionToken:e.me.sessionToken,userInfos:e.me.infos,isLoading:e.operations.loading}),e=>Object(i.bindActionCreators)({fetchOperations:be,createOperation:we,deleteOperation:Ue},e))(Ve);a(412);class Ke extends s.Component{constructor(e){super(e),this.updateOperation=()=>{const{callUpdateOperation:e,sessionToken:t,towardsOperationPopup:a,id:s}=this.props,{data:n,location:o,name:i}=this.state;e(s,n,o,i,t).then(()=>{a()})},this.updateName=e=>this.setState({name:e.target.value}),this.updateData=e=>this.setState({data:e.target.value}),this.updateLocation=e=>this.setState({location:e.target.value}),this.state={data:e.data||"",location:e.location||"",name:e.name||""}}render(){const{data:e,location:t,name:a}=this.state,{isLoading:s,userInfos:o}=this.props;_.get(o,"status","user");return n.a.createElement("div",{className:"invitation-popup-container"},n.a.createElement("div",{className:"title"},"Edit opération"),n.a.createElement("div",{className:"bottom-space"},n.a.createElement(P,{value:a,onChange:this.updateName,placeholder:"Nom de l'opération"}),n.a.createElement(P,{value:e,onChange:this.updateData,placeholder:"description (liens drive, codes KALITI, infos d'accès, ...)",isDescription:!0}),n.a.createElement(P,{value:t,onChange:this.updateLocation,placeholder:"Lieu de rdv"})),n.a.createElement(F,{clickAction:this.updateOperation,label:"Sauvegarder",isLoading:s}))}}var Ze=Object(r.b)(e=>({sessionToken:e.me.sessionToken,userInfos:e.me.infos,isLoading:e.operations.loading}),e=>Object(i.bindActionCreators)({fetchOperations:be,createOperation:we,deleteOperation:Ue,callUpdateOperation:Ae},e))(Ke);a(413);class Je extends s.Component{constructor(e){super(e),this.handleChangeDate=e=>{this.setState({eventDate:e})},this.setSelectedUsersIds=e=>this.setState({selectedUsersIds:e}),this.setSelectedOperationsIds=e=>this.setState({selectedOperationsIds:e}),this.onChangeStartTime=e=>this.setState({start_time:e}),this.onChangeEndTime=e=>this.setState({end_time:e}),this.updateTitle=e=>this.setState({title:e.target.value}),this.updateMail=e=>this.setState({mail:e.target.value}),this.updateDescription=e=>this.setState({description:e.target.value}),this.sendCreateEventRequest=()=>{const{title:e,description:t,eventDate:a,start_time:s,end_time:n,selectedOperationsIds:o,mail:i}=this.state,{postUpdateEvent:r,fetchEventsData:c,closePopup:l,sessionToken:p,userInfos:d,eventData:h}=this.props,m="".concat(v(a).year(),"-").concat(v(a).month()+1,"-").concat(v(a).date());r(h.id,e,t,s,n,m,p).then(()=>{c(),l()})},this.state={title:_.get(e.eventData,"name","Title"),description:_.get(e.eventData,"description","Description"),eventDate:v(e.eventData.date).toDate(),start_time:_.get(e.eventData,"time_from","10:00"),end_time:_.get(e.eventData,"time_to","12:00"),mail:_.get(e.eventData,"mail",""),selectedUsersIds:[],selectedOperationId:_.get(e.eventData,"operation_id","")}}componentDidMount(){const{fetchUsers:e,sessionToken:t,userInfos:a}=this.props;e(_.get(a,"corpId"),t)}render(){const{title:e,description:t,mail:a,selectedOperationId:s}=this.state,{isLoading:o,operations:i}=this.props;return n.a.createElement("div",{className:"update-event-popup-container"},n.a.createElement("div",{className:"top-popup-container"},n.a.createElement("div",{className:"title"},"Update event"),n.a.createElement("div",{className:"edit-box"},n.a.createElement("div",{className:"left"},n.a.createElement(P,{value:e,onChange:this.updateTitle,placeholder:"Title here",isDescription:!1}),n.a.createElement(P,{value:t,onChange:this.updateDescription,placeholder:"Description here",isDescription:!0}),n.a.createElement("div",{className:"mail"},a)),n.a.createElement("div",{className:"right"},n.a.createElement("div",{className:"date-picker"},n.a.createElement(ee.a,{selected:this.state.eventDate,onChange:this.handleChangeDate})),n.a.createElement("div",{className:"time-pickers-container"},n.a.createElement("div",{className:"time-picker"},n.a.createElement("div",{className:"time-label"},"from : "),n.a.createElement(I.a,{onChange:this.onChangeStartTime,value:this.state.start_time})),n.a.createElement("div",{className:"time-picker"},n.a.createElement("div",{className:"time-label"},"to : "),n.a.createElement(I.a,{onChange:this.onChangeEndTime,value:this.state.end_time}))))),n.a.createElement("div",{className:"operation-edit-event"},_.find(i,{id:s}).name)),n.a.createElement("div",{className:"save-btn"},n.a.createElement(F,{clickAction:this.sendCreateEventRequest,label:"Save",isLoading:o})))}}var Qe=Object(r.b)(e=>({loading:e.users.loading,users:e.users.users,hasErrors:e.users.hasErrors,sessionToken:e.me.sessionToken,userInfos:e.me.infos,isLoading:e.events.loading,operations:e.operations.operations}),e=>Object(i.bindActionCreators)({postUpdateEvent:W,fetchUsers:U},e))(Je);a(414),a(415);class Xe extends s.Component{constructor(...e){super(...e),this.generateRGBAFromHex=(e,t)=>"rgba("+parseInt(e.substring(1,3),16)+","+parseInt(e.substring(3,5),16)+","+parseInt(e.substring(5,7),16)+","+t+")"}render(){const{operation:{name:e,color:t,data:a},amos:s}=this.props;return n.a.createElement("div",{className:"operation-card-container",style:{backgroundColor:this.generateRGBAFromHex(t,.3)}},n.a.createElement(b.Scrollbars,{autoHeight:!0,autoHeightMin:0,autoHeightMax:260},n.a.createElement("div",{className:"op-card-title"},e),n.a.createElement("div",{className:"op-card-desc"},a),n.a.createElement("div",{className:"op-card-amos"},_.map(s,e=>n.a.createElement("div",{className:"op-card-amo"},n.a.createElement("b",null,e.name)," : ".concat(_.get(e,"phone","pas de téléphone renseigné")||"Pas de téléphone renseigné"))))))}}var $e=Xe;class et extends s.Component{constructor(e){super(e),this.formatTime=e=>{const t=S.a.split(e,":"),a=S.a.parseInt(t[0])+S.a.parseInt(t[1])/60;return Math.floor(100*(a-6)/14)},this.calculateCoords=e=>({from:this.formatTime(e.time_from),to:this.formatTime(e.time_to)}),this.checkOverleap=(e,t)=>e.from<t.to&&t.from<e.to,this.formatWidth=e=>{const t={};S.a.forEach(e,a=>{const s=this.calculateCoords(a),n=[];S.a.forEach(e,e=>{const t=this.calculateCoords(e);e.id!==a.id&&this.checkOverleap(s,t)&&n.push(e.id)}),t[a.id]=n});const a=this.getGroupedOverleapMap(t),s={};return S.a.forEach(t,(e,t)=>{const n=S.a.size(S.a.maxBy(a[t],e=>S.a.size(e)))+1,o=Math.floor(100/n),i={},r=[];s[t]={width:o},S.a.forEach(S.a.orderBy(e,e=>S.a.get(s,"".concat(e,".width"),0),"asc"),e=>{if(!S.a.isNil(s[e])){const a=s[e].width;r.push(s[e].position),a>o&&(s[e].width=s[t].width),a<o&&(s[t].width=a,i[e]=o-a)}}),s[t].position=S.a.difference(S.a.times(n),r)[0]}),s},this.getGroupedOverleapMap=e=>{const t={};return S.a.forEach(e,(a,s)=>{if(S.a.isEmpty(a))t[s]=[[]];else{t[s]=[[a[0]]];let n=1;for(;n<S.a.size(a);){let o=0,i=!1;for(;o<S.a.size(t[s])&&!i;)S.a.includes(e[t[s][o]],a[n])&&(t[s][o].push(a[n]),i=!0),o++;i||t[s].push([a[n]]),n++}}}),t},this.renderAmoInfo=e=>{const{events:t,operations:a}=this.props;let s=[];return S.a.each(e,e=>{s=S.a.concat(s,S.a.map(e.invitations,t=>({operation_id:e.operation_id,...t})))}),S.a.size(s)>0&&n.a.createElement("div",{className:"event-day-recipients"},n.a.createElement(b.Scrollbars,{autoHeight:!0,autoHeightMin:0,autoHeightMax:600},S.a.map(S.a.groupBy(s,"operation_id"),e=>n.a.createElement($e,{operation:S.a.find(a,{id:e[0].operation_id}),amos:e}))))},this.generateRGBAFromHex=(e,t)=>"rgba("+parseInt(e.substring(1,3),16)+","+parseInt(e.substring(3,5),16)+","+parseInt(e.substring(5,7),16)+","+t+")",this.state={}}render(){const{events:e,index:t,day:a,setPopupState:s,setPopupContent:o,operations:i,openEditEventPopup:r}=this.props,c=S.a.filter(e,e=>"amo"===e.type),l=S.a.filter(e,e=>"rdv"===e.type),p=this.formatWidth(l),d=D()({"col-container":!0,"col-container--today":Object(y.a)(a)});return n.a.createElement("div",{className:d,style:{left:"calc(".concat(20*t,"% + 40px)")}},n.a.createElement("div",{className:"col-holder"},S.a.map(l,e=>{const t=this.calculateCoords(e);return n.a.createElement("div",{className:"event-container",style:{top:"".concat(t.from,"%"),height:"".concat(t.to-t.from,"%"),left:"".concat(p[e.id].position*p[e.id].width,"%"),width:"".concat(p[e.id].width,"%")},onClick:r(e)},n.a.createElement("div",{className:"event-holder",style:{backgroundColor:this.generateRGBAFromHex(S.a.find(i,{id:e.operation_id}).color,.3)}},n.a.createElement("div",{className:"event-holder-2"},n.a.createElement(b.Scrollbars,{className:"custom-scrollbars",renderTrackHorizontal:e=>n.a.createElement("div",{...e,style:{display:"none"},className:"track-horizontal"})},n.a.createElement("div",{className:"event-author"},e.name),n.a.createElement("div",{className:"event-recipients"},S.a.map(e.invitations,e=>n.a.createElement("div",{className:"event-recipient"},e.name))),n.a.createElement("div",{className:"event-description"},e.description)))))})),this.renderAmoInfo(c))}}var tt=et;a(416);class at extends s.Component{constructor(e){super(e),this.state={}}render(){return n.a.createElement("div",{className:"hours-container"},S.a.map(S.a.range(15),e=>n.a.createElement("div",{style:{top:"".concat(Math.floor(100*e/14),"%")},className:"hour-container"},"".concat(e+6,"h"))))}}var st=at;a(417);class nt extends s.Component{constructor(e){super(e),this.state={}}render(){return n.a.createElement("div",{className:"hours-lines-day-container"},S.a.map(S.a.range(13),e=>n.a.createElement("div",{style:{top:"".concat(Math.floor(100*(e+1)/14),"%")},className:"hour-line-container"})))}}var ot=nt;a(418),a(419);class it extends s.Component{constructor(e){super(e),this.state={}}render(){return n.a.createElement("div",null,"Settings menu")}}a(420);class rt extends s.Component{constructor(e){super(e),this.state={}}render(){return n.a.createElement("div",null,"Team menu")}}class ct extends s.Component{constructor(e){super(e),this.setToggle=e=>()=>{this.setState({isToggled:e})},this.setSubMenuToggle=e=>()=>{this.setState({menuToggle:e})},this.state={isToggled:!0,menuToggle:-1}}render(){const{recipients:e,toggleRecipient:t,openInvitationPopup:a,logout:s,userName:o,operations:i,toggleOperation:r,openOperationsPopup:c,towardsOffDaysBoard:l,openRdvSettingsPopup:p,isAdmin:d}=this.props,{isToggled:h,menuToggle:m}=this.state,u=D()({"sidebar-container-month":!0,"sidebar-container-month--toggled":h}),E=(D()({"sidebar-item-label":!0,"sidebar-item-label--toggled":h}),D()({"submenu-container":!0,"submenu-container--toggled":-1!==m})),v=D()({"submenu-halo-container":!0,"submenu-halo-container--toggled":-1!==m});return n.a.createElement("div",{className:"sidebar-big-container"},n.a.createElement("div",{className:"sidebar-user-display"}),n.a.createElement("div",{className:u},n.a.createElement("div",{className:"recipients-container"},n.a.createElement(b.Scrollbars,{autoHeight:!0,autoHeightMin:0,autoHeightMax:380},n.a.createElement("div",{className:"recipients-container"},_.map(e,e=>n.a.createElement("div",{className:"recipient-container"}," ","".concat(e.name),n.a.createElement(me,{applyToggle:t,id:e.id}))),n.a.createElement("div",{className:"space-div"}),_.map(i,e=>n.a.createElement("div",{className:"recipient-container"}," ","".concat(e.name),n.a.createElement(me,{applyToggle:r,id:e.id,color:e.color})))))),n.a.createElement("div",{className:"sidebar-bottom-menu"},n.a.createElement("div",{className:"sidebar-item-container",onClick:c},n.a.createElement("div",{className:"label"},"Operations"),n.a.createElement("svg",{id:"bold","enable-background":"new 0 0 24 24",height:"20",viewBox:"0 0 24 24",width:"20"},n.a.createElement("path",{d:"m13.03 1.87-10.99-1.67c-.51-.08-1.03.06-1.42.39-.39.34-.62.83-.62 1.34v21.07c0 .55.45 1 1 1h3.25v-5.25c0-.97.78-1.75 1.75-1.75h2.5c.97 0 \r 1.75.78 1.75 1.75v5.25h4.25v-20.4c0-.86-.62-1.59-1.47-1.73zm-7.53 12.88h-1.5c-.414 0-.75-.336-.75-.75s.336-.75.75-.75h1.5c.414 0 \r .75.336.75.75s-.336.75-.75.75zm0-3h-1.5c-.414 0-.75-.336-.75-.75s.336-.75.75-.75h1.5c.414 0 .75.336.75.75s-.336.75-.75.75zm0-3h-1.5c-.414 \r 0-.75-.336-.75-.75s.336-.75.75-.75h1.5c.414 0 .75.336.75.75s-.336.75-.75.75zm0-3h-1.5c-.414 0-.75-.336-.75-.75s.336-.75.75-.75h1.5c.414 0 \r .75.336.75.75s-.336.75-.75.75zm5 9h-1.5c-.414 0-.75-.336-.75-.75s.336-.75.75-.75h1.5c.414 0 .75.336.75.75s-.336.75-.75.75zm0-3h-1.5c-.414 \r 0-.75-.336-.75-.75s.336-.75.75-.75h1.5c.414 0 \r .75.336.75.75s-.336.75-.75.75zm0-3h-1.5c-.414 0-.75-.336-.75-.75s.336-.75.75-.75h1.5c.414 0 .75.336.75.75s-.336.75-.75.75zm0-3h-1.5c-.414 \r 0-.75-.336-.75-.75s.336-.75.75-.75h1.5c.414 0 .75.336.75.75s-.336.75-.75.75z"}),n.a.createElement("path",{d:"m22.62 10.842-7.12-1.491v14.649h6.75c.965 0 1.75-.785 1.75-1.75v-9.698c0-.826-.563-1.529-1.38-1.71zm-2.37 \r 10.158h-1.5c-.414 0-.75-.336-.75-.75s.336-.75.75-.75h1.5c.414 0 .75.336.75.75s-.336.75-.75.75zm0-3h-1.5c-.414 0-.75-.336-.75-.75s.336-.75.75-.75h1.5c.414 \r 0 .75.336.75.75s-.336.75-.75.75zm0-3h-1.5c-.414 0-.75-.336-.75-.75s.336-.75.75-.75h1.5c.414 0 .75.336.75.75s-.336.75-.75.75z"}))),n.a.createElement("div",{className:"sidebar-item-container",onClick:l},n.a.createElement("div",{className:"label"},"Jours Off"),n.a.createElement("svg",{height:"20",viewBox:"0 0 64 64",width:"20"},n.a.createElement("path",{d:"m12 47h4.001v3h-4.001z"}),n.a.createElement("path",{d:"m49 38a11 11 0 1 0 11 11 11.013 11.013 0 0 0 -11-11zm7.192 8.222-8.485 8.485a1 1 0 0 1 -1.414 0l-4.242-4.243a1 1 0 0 1 \r 1.414-1.414l3.535 3.536 7.778-7.778a1 1 0 0 1 1.414 1.414z"}),n.a.createElement("path",{d:"m24 29h4.001v3h-4.001z"}),n.a.createElement("path",{d:"m36 29h4v3h-4z"}),n.a.createElement("path",{d:"m12 38h4.001v3h-4.001z"}),n.a.createElement("path",{d:"m24 38h4.001v3h-4.001z"}),n.a.createElement("path",{d:"m12 29h4.001v3h-4.001z"}),n.a.createElement("path",{d:"m16 14a2.006 2.006 0 0 0 2-2v-6a2 2 0 0 0 -4 0v6a2.006 2.006 0 0 0 2 2z"}),n.a.createElement("path",{d:"m32 14a2.006 2.006 0 0 0 2-2v-6a2 2 0 0 0 -4 0v6a2.006 2.006 0 0 0 2 2z"}),n.a.createElement("path",{d:"m48 14a2.006 2.006 0 0 0 2-2v-6a2 2 0 0 0 -4 0v6a2.006 2.006 0 0 0 2 2z"}),n.a.createElement("path",{d:"m48 29h4v3h-4z"}),n.a.createElement("path",{d:"m57 10h-5v2a4 4 0 0 1 -8 0v-2h-8v2a4 4 0 0 1 -8 0v-2h-8v2a4 4 0 0 1 -8 0v-2h-5a3.009 3.009 0 0 0 -3 3v7h56v-7a3.009 3.009 0 0 0 -3-3z"}),n.a.createElement("path",{d:"m24 47h4.001v3h-4.001z"}),n.a.createElement("path",{d:"m4 22v31a3.009 3.009 0 0 0 3 3h31.063a12.984 12.984 0 1 1 21.937-13.9v-20.1zm14 28a2 2 0 0 1 -2 2h-4a2 2 0 0 1 -2-2v-3a2 2 0 0 1 2-2h4a2 2 0 0 1 2 \r 2zm0-9a2 2 0 0 1 -2 2h-4a2 2 0 0 1 -2-2v-3a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2zm0-9a2 2 0 0 1 -2 2h-4a2 2 0 0 1 -2-2v-3a2 2 0 0 1 2-2h4a2 2 0 0 1 2 \r 2zm12 18a2 2 0 0 1 -2 2h-4a2 2 0 0 1 -2-2v-3a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2zm0-9a2 2 0 0 1 -2 2h-4a2 2 0 0 1 -2-2v-3a2 2 0 0 1 2-2h4a2 2 0 0 1 2 \r 2zm0-9a2 2 0 0 1 -2 2h-4a2 2 0 0 1 -2-2v-3a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2zm10 6h-4v3a1 1 0 0 1 0 2 2 2 0 0 1 -2-2v-3a2 2 0 0 1 2-2h4a1 1 0 0 1 0 \r 2zm2-6a2 2 0 0 1 -2 2h-4a2 2 0 0 1 -2-2v-3a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2zm12 0a2 2 0 0 1 -2 2h-4a2 2 0 0 1 -2-2v-3a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2z"}))),n.a.createElement("div",{className:"sidebar-item-container",onClick:a},n.a.createElement("div",{className:"label"},"Utilisateurs"),n.a.createElement("svg",{viewBox:"0 0 512 512",width:"20",height:"20"},n.a.createElement("g",null,n.a.createElement("g",null,n.a.createElement("path",{d:"M438.09,273.32h-39.596c4.036,11.05,6.241,22.975,6.241,35.404v149.65c0,5.182-0.902,10.156-2.543,14.782h65.461\r c24.453,0,44.346-19.894,44.346-44.346v-81.581C512,306.476,478.844,273.32,438.09,273.32z"}))),n.a.createElement("g",null,n.a.createElement("g",null,n.a.createElement("path",{d:"M107.265,308.725c0-12.43,2.205-24.354,6.241-35.404H73.91c-40.754,0-73.91,33.156-73.91,73.91v81.581\r c0,24.452,19.893,44.346,44.346,44.346h65.462c-1.641-4.628-2.543-9.601-2.543-14.783V308.725z"}))),n.a.createElement("g",null,n.a.createElement("g",null,n.a.createElement("path",{d:"M301.261,234.815h-90.522c-40.754,0-73.91,33.156-73.91,73.91v149.65c0,8.163,6.618,14.782,14.782,14.782h208.778\r c8.164,0,14.782-6.618,14.782-14.782v-149.65C375.171,267.971,342.015,234.815,301.261,234.815z"}))),n.a.createElement("g",null,n.a.createElement("g",null,n.a.createElement("path",{d:"M256,38.84c-49.012,0-88.886,39.874-88.886,88.887c0,33.245,18.349,62.28,45.447,77.524\r c12.853,7.23,27.671,11.362,43.439,11.362c15.768,0,30.586-4.132,43.439-11.362c27.099-15.244,45.447-44.28,45.447-77.524\r C344.886,78.715,305.012,38.84,256,38.84z"}))),n.a.createElement("g",null,n.a.createElement("g",null,n.a.createElement("path",{d:"M99.918,121.689c-36.655,0-66.475,29.82-66.475,66.475c0,36.655,29.82,66.475,66.475,66.475\r c9.298,0,18.152-1.926,26.195-5.388c13.906-5.987,25.372-16.585,32.467-29.86c4.98-9.317,7.813-19.946,7.813-31.227\r C166.393,151.51,136.573,121.689,99.918,121.689z"}))),n.a.createElement("g",null,n.a.createElement("g",null,n.a.createElement("path",{d:"M412.082,121.689c-36.655,0-66.475,29.82-66.475,66.475c0,11.282,2.833,21.911,7.813,31.227\r c7.095,13.276,18.561,23.874,32.467,29.86c8.043,3.462,16.897,5.388,26.195,5.388c36.655,0,66.475-29.82,66.475-66.475\r C478.557,151.509,448.737,121.689,412.082,121.689z"}))))),d&&n.a.createElement("div",{className:"sidebar-item-container",onClick:p},n.a.createElement("div",{className:"label"},"Prise de rdv"),n.a.createElement("svg",{viewBox:"0 0 512 512",width:"20",height:"20"},n.a.createElement("g",{id:"_30-appointment","data-name":"30-appointment"},n.a.createElement("path",{d:"M393.265,129.522a12,12,0,1,0,0-24,28,28,0,1,1,14.405-52h31.7a51.991,51.991,0,1,0-46.107,76Z"}),n.a.createElement("path",{d:"M272.211,129.522a12,12,0,1,0,0-24,28,28,0,1,1,14.4-52h31.7a51.991,51.991,0,1,0-46.107,76Z"}),n.a.createElement("path",{d:"M468.927,80.349a12,12,0,0,0-11.662-14.827H382.717a15.979,15.979,0,0,0,10.548,28,24,24,0,1,1,0,48,63.957,63.957,0,0,1-62.856-76H261.664a15.978,15.978,0,0,0,10.547,28,24,24,0,1,1,0,48,63.953,63.953,0,0,1-62.855-76H140.61a15.978,15.978,0,0,0,10.547,28,24,24,0,1,1,0,48,63.953,63.953,0,0,1-62.855-76H81.265A12,12,0,0,0,69.6,74.695L50.978,151.522h400.7Z"}),n.a.createElement("path",{d:"M151.157,129.522a12,12,0,1,0,0-24,28,28,0,1,1,14.405-52h31.7a51.992,51.992,0,1,0-46.108,76Z"}),n.a.createElement("path",{d:"M469.265,298.541V129.889l-36.727,151.5A119.558,119.558,0,0,1,469.265,298.541Z"}),n.a.createElement("path",{d:"M401,277.174a120.287,120.287,0,0,1,19.813,1.645l27.951-115.3H48.069L5.6,338.694a12,12,0,0,0,11.662,14.827H289.221A120.2,120.2,0,0,1,401,277.174Zm-59.735-79.652h32a12,12,0,0,1,0,24h-32a12,12,0,0,1,0-24Zm-232,120h-32a12,12,0,1,1,0-24h32a12,12,0,0,1,0,24Zm8-48h-32a12,12,0,1,1,0-24h32a12,12,0,1,1,0,24Zm16-48h-32a12,12,0,1,1,0-24h32a12,12,0,0,1,0,24Zm56,96h-32a12,12,0,0,1,0-24h32a12,12,0,0,1,0,24Zm8-48h-32a12,12,0,1,1,0-24h32a12,12,0,1,1,0,24Zm16-48h-32a12,12,0,0,1,0-24h32a12,12,0,0,1,0,24Zm56,96h-32a12,12,0,0,1,0-24h32a12,12,0,0,1,0,24Zm8-48h-32a12,12,0,1,1,0-24h32a12,12,0,1,1,0,24Zm16-48h-32a12,12,0,0,1,0-24h32a12,12,0,0,1,0,24Zm32,24h32a12,12,0,1,1,0,24h-32a12,12,0,1,1,0-24Z"}),n.a.createElement("path",{d:"M69.265,365.521v32a12,12,0,0,0,12,12H281.632a120.352,120.352,0,0,1,3.613-44Z"}),n.a.createElement("path",{d:"M497.265,65.522H478.036a23.845,23.845,0,0,1,3.229,12V308.049a120.677,120.677,0,0,1,28,37.394V77.522A12,12,0,0,0,497.265,65.522Z"}),n.a.createElement("path",{d:"M401,289.174a108,108,0,1,0,108,108A108.122,108.122,0,0,0,401,289.174ZM413,480.3V469.174a12,12,0,0,0-24,0V480.3a84.171,84.171,0,0,1-71.129-71.129H329a12,12,0,0,0,0-24H317.871A84.17,84.17,0,0,1,389,314.045v11.129a12,12,0,0,0,24,0V314.045a84.17,84.17,0,0,1,71.129,71.129H473a12,12,0,0,0,0,24h11.129A84.171,84.171,0,0,1,413,480.3Z"}),n.a.createElement("path",{d:"M424.515,356.688l-25.884,25.884L374.366,370.44a12,12,0,0,0-10.732,21.467l32,16a12,12,0,0,0,13.851-2.248l32-32a12,12,0,0,0-16.97-16.971Z"})))),n.a.createElement("div",{className:"sidebar-item-container",onClick:s},n.a.createElement("div",{className:"label"},"Déconnexion"),n.a.createElement("svg",{viewBox:"0 0 512 512",width:"20",height:"20"},n.a.createElement("path",{d:"m320 277.335938c-11.796875 0-21.332031 9.558593-21.332031 21.332031v85.335937c0 11.753906-9.558594\r 21.332032-21.335938 21.332032h-64v-320c0-18.21875-11.605469-34.496094-29.054687-40.554688l-6.316406-2.113281h99.371093c11.777344\r 0 21.335938 9.578125 21.335938 21.335937v64c0 11.773438 9.535156 21.332032 21.332031 21.332032s21.332031-9.558594\r 21.332031-21.332032v-64c0-35.285156-28.714843-63.99999975-64-63.99999975h-229.332031c-.8125\r 0-1.492188.36328175-2.28125.46874975-1.027344-.085937-2.007812-.46874975-3.050781-.46874975-23.53125 0-42.667969\r 19.13281275-42.667969 42.66406275v384c0 18.21875 11.605469 34.496093 29.054688 40.554687l128.386718 42.796875c4.351563\r 1.34375 8.679688 1.984375 13.226563 1.984375 23.53125 0 42.664062-19.136718 42.664062-42.667968v-21.332032h64c35.285157 0\r 64-28.714844 64-64v-85.335937c0-11.773438-9.535156-21.332031-21.332031-21.332031zm0 0"}),n.a.createElement("path",{d:"m505.75 198.253906-85.335938-85.332031c-6.097656-6.101563-15.273437-7.9375-23.25-4.632813-7.957031\r 3.308594-13.164062 11.09375-13.164062 19.714844v64h-85.332031c-11.777344 0-21.335938 9.554688-21.335938 21.332032 0\r 11.777343 9.558594 21.332031 21.335938 21.332031h85.332031v64c0 8.621093 5.207031 16.40625 13.164062 19.714843 7.976563\r 3.304688 17.152344 1.46875 23.25-4.628906l85.335938-85.335937c8.339844-8.339844 8.339844-21.824219 0-30.164063zm0 0"}))))),n.a.createElement("div",{className:E},0===m&&n.a.createElement(it,null),1===m&&n.a.createElement(rt,null)),n.a.createElement("div",{onClick:this.setSubMenuToggle(-1),className:v}))}}var lt=ct,pt=(a(421),a.p+"assets/orchestra_logo_blanc.9f226887.png");a(422);class dt extends s.Component{constructor(e){super(e),this.handleChangeDate=e=>{this.setState({eventDate:e})},this.setSelectedUsersIds=e=>this.setState({selectedUsersIds:e}),this.onChangeStartTime=e=>this.setState({start_time:e}),this.onChangeEndTime=e=>this.setState({end_time:e}),this.updateTitle=e=>this.setState({title:e.target.value}),this.updateDescription=e=>this.setState({description:e.target.value}),this.sendUpdateEventRequest=()=>{const{title:e,description:t,start_time:a,end_time:s,selectedUsersIds:n}=this.state,{postUpdateEvent:o,fetchEventsData:i,closePopup:r,sessionToken:c,eventId:l}=this.props;o(l,e,t,a,s,_.join(n,","),c).then(()=>{i(),r()})},this.sendDeleteEventRequest=()=>{const{postDeleteEvent:e,eventId:t,sessionToken:a,closePopup:s}=this.props;e(t,a),s()},this.state={title:e.title,description:e.description,eventDate:e.date,start_time:e.startTime,end_time:e.endTime,selectedUsersIds:_.map(e.invited,e=>e.id)}}componentDidMount(){const{fetchUsers:e,sessionToken:t,userInfos:a}=this.props;e(_.get(a,"corpId"),t)}render(){const{title:e,description:t}=this.state,{invited:a,userInfos:s,isLoading:o}=this.props;return n.a.createElement("div",{className:"event-details-popup-container"},n.a.createElement("div",{className:"top-popup-container"},n.a.createElement("div",{className:"title"},"Event details"),n.a.createElement("div",{className:"edit-box"},n.a.createElement("div",{className:"left"},n.a.createElement(P,{value:e,onChange:this.updateTitle,placeholder:"Title here",isDescription:!1}),n.a.createElement(P,{value:t,onChange:this.updateDescription,placeholder:"Description here",isDescription:!0})),n.a.createElement("div",{className:"right"},n.a.createElement("div",{className:"date-picker"},this.state.eventDate),n.a.createElement("div",{className:"time-pickers-container"},n.a.createElement("div",{className:"time-picker"},n.a.createElement("div",{className:"time-label"},"from : "),n.a.createElement(I.a,{onChange:this.onChangeStartTime,value:this.state.start_time})),n.a.createElement("div",{className:"time-picker"},n.a.createElement("div",{className:"time-label"},"to : "),n.a.createElement(I.a,{onChange:this.onChangeEndTime,value:this.state.end_time}))))),n.a.createElement(L,{setSelectedUsersIds:this.setSelectedUsersIds,defaultSelected:a})),n.a.createElement("div",{className:"btns-container"},n.a.createElement("div",{className:"save-btn"},n.a.createElement(F,{clickAction:this.sendUpdateEventRequest,label:"Save modifications",isLoading:o})),"admin"===_.get(s,"status","user")&&n.a.createElement("div",{className:"delete-btn"},n.a.createElement(F,{isDanger:!0,clickAction:this.sendDeleteEventRequest,label:"Delete",isLoading:o}))))}}Object(r.b)(e=>({loading:e.users.loading,users:e.users.users,hasErrors:e.users.hasErrors,sessionToken:e.me.sessionToken,userInfos:e.me.infos,isLoading:e.events.loading}),e=>Object(i.bindActionCreators)({postUpdateEvent:W,fetchUsers:U,postDeleteEvent:K},e))(dt);class ht extends s.Component{constructor(e){super(e),this.setPopupState=e=>{this.setState({isPopupDisplayed:e})},this.setPopupContent=e=>{this.setState({popupContent:e})},this.openNewEventPopup=()=>{const{userInfos:e}=this.props;if(!("admin"===e.status))return;const t=n.a.createElement(Le,{closePopup:()=>{this.setPopupState(!1)},fetchEventsData:this.fetchEventsData});this.setState({popupContent:t,isPopupDisplayed:!0})},this.openNewEventPopupDay=e=>()=>{const{userInfos:t}=this.props;if(!("admin"===t.status))return;const a=n.a.createElement(Ge,{closePopup:()=>{this.setPopupState(!1)},fetchEventsData:this.fetchEventsData,date:e});this.setState({popupContent:a,isPopupDisplayed:!0})},this.openEditEventPopup=e=>()=>{const{userInfos:t}=this.props;if(!("admin"===t.status))return;const a=n.a.createElement(Qe,{closePopup:()=>{this.setPopupState(!1)},fetchEventsData:this.fetchEventsData,eventData:e});this.setState({popupContent:a,isPopupDisplayed:!0})},this.openAMOPopup=(e,t,a)=>{const{userInfos:s}=this.props;if(!("admin"===s.status))return;const o=n.a.createElement(Ge,{closePopup:()=>{this.setPopupState(!1)},fetchEventsData:this.fetchEventsData,date:e,selectedUsers:t,selectedOperation:a});this.setState({popupContent:o,isPopupDisplayed:!0})},this.openInvitationPopup=()=>{const e=n.a.createElement(He,{closePopup:()=>{this.setPopupState(!1)}});this.setState({popupContent:e,isPopupDisplayed:!0})},this.openOperationsPopup=()=>{const e=n.a.createElement(Be,{closePopup:()=>{this.setPopupState(!1)},towardsCreateOperationPopup:this.openCreateOperationPopup,towardsEditOperationPopup:this.openEditOperationPopup});this.setState({popupContent:e,isPopupDisplayed:!0})},this.openCreateOperationPopup=()=>{const e=n.a.createElement(We,{closePopup:()=>{this.setPopupState(!1)},towardsOperationPopup:this.openOperationsPopup});this.setState({popupContent:e,isPopupDisplayed:!0})},this.openEditOperationPopup=(e,t,a,s)=>()=>{const o=n.a.createElement(Ze,{closePopup:()=>{this.setPopupState(!1)},towardsOperationPopup:this.openOperationsPopup,id:e,name:t,data:a,location:s});this.setState({popupContent:o,isPopupDisplayed:!0})},this.fetchEventsData=()=>{const{sessionToken:e,fetchEvents:t,userInfos:a,fetchAmoEvents:s}=this.props;"admin"===a.status?t(this.state.fetchDate,e,S.a.get(a,"corpId")).then(()=>{this.setState({collabsToDisplay:S.a.map(this.getRecipients(this.props.events),"id"),operationsToDisplay:this.getOperations(this.props.events)})}):s(e,this.state.fetchDate,S.a.get(a,"id"),S.a.get(a,"corpId")).then(()=>{this.setState({collabsToDisplay:S.a.map(this.getRecipients(this.props.events),"id"),operationsToDisplay:this.getOperations(this.props.events)})})},this.navigateToNextWeek=()=>{const{day:e}=this.state,t=v(e).add(1,"d"),a=v(t).dayOfYear(),s=v(t).year(),n=v(t).month()+1,o=n<10?"0".concat(n):n;this.props.history.push("/mcalendar/".concat(a,"/").concat(s)),this.setState({fetchDate:"".concat(s,"_").concat(o),day:t,year:s,dayCount:a})},this.navigateToPreviousWeek=()=>{const{day:e}=this.state,t=v(e).add(-1,"d"),a=v(t).dayOfYear(),s=v(t).year(),n=v(t).month()+1,o=n<10?"0".concat(n):n;this.props.history.push("/mcalendar/".concat(a,"/").concat(s)),this.setState({fetchDate:"".concat(s,"_").concat(o),day:t,year:s,dayCount:a})},this.navigateToDate=e=>{const t=v(e).dayOfYear(),a=v(e).year(),s=v(e).month()+1,n=s<10?"0".concat(s):s;this.props.history.push("/mcalendar/".concat(t,"/").concat(a)),this.setState({fetchDate:"".concat(a,"_").concat(n),day:e,year:a,dayCount:t})},this.getRecipients=e=>{let t=[];return S.a.each(e,e=>{t=S.a.uniqBy(S.a.concat(t,S.a.get(e,"invitations",[])),"id")}),t},this.getOperations=e=>{let t=[];return S.a.each(e,e=>{t=S.a.uniq(S.a.concat(t,S.a.get(e,"operation_id",[])))}),t},this.toggleRecipient=(e,t)=>{t?this.setState(t=>({collabsToDisplay:S.a.uniq(S.a.concat(t.collabsToDisplay,e))})):this.setState(t=>({collabsToDisplay:S.a.difference(t.collabsToDisplay,[e])}))},this.toggleOperation=(e,t)=>{t?this.setState(t=>({operationsToDisplay:S.a.uniq(S.a.concat(t.operationsToDisplay,e))})):this.setState(t=>({operationsToDisplay:S.a.difference(t.operationsToDisplay,[e])}))},this.logout=()=>{const{logout:e,history:t}=this.props;e(),t.push("/login")},this.openDatePicker=()=>{this.datePickerRef.current.setOpen(!0)},this.getDaysInMonth=(e,t)=>{let a=new Date(t,e,1);const s=[];for(;a.getMonth()===e;)s.push(new Date(a)),a.setDate(a.getDate()+1);return s},this.towardsOffDaysBoard=()=>{const{history:e,userInfos:t}=this.props;"admin"===t.status?e.push("/calendaroffdaysboard"):e.push("/calendaroffdays")},this.towardsMonthlyCalendar=()=>{const{history:e}=this.props;e.push("/calendarmonth")},this.datePickerRef=n.a.createRef(),this.state={day:null,year:S.a.parseInt(e.match.params.year)||v().year(),dayCount:S.a.parseInt(e.match.params.day)||v().dayOfYear(),sidebarOpen:!1,collabsToDisplay:[],operationsToDisplay:[],isPopupDisplayed:!1,popupContent:null,fetchDate:""}}componentDidMount(){const{sessionToken:e,fetchEvents:t,history:a,userInfos:s,fetchOperations:n,fetchMyOperations:o}=this.props,{day:i,year:r}=this.props.match.params;if(v.locale("fr"),S.a.isNil(e)&&a.push("/login"),Ce.isMobileOnly&&a.push("/mcalendar"),"admin"===S.a.get(s,"status","user")?n(e):o(S.a.get(s,"id"),e),S.a.isNil(i)||S.a.isNil(r))this.setState({day:new Date},()=>{const a=v(this.state.day).month()+1,n=v(this.state.day).year(),o=a<10?"0".concat(a):a;this.setState({fetchDate:"".concat(n,"_").concat(o)},()=>{t(this.state.fetchDate,e,S.a.get(s,"corpId"))})});else{const a=v().dayOfYear(i);this.setState({day:a},()=>{const a=v(this.state.day).month()+1,n=v(this.state.day).year(),o=a<10?"0".concat(a):a;this.setState({fetchDate:"".concat(n,"_").concat(o)},()=>{t(this.state.fetchDate,e,S.a.get(s,"corpId"))})})}}componentDidUpdate(e,t){const{sessionToken:a,fetchEvents:s,userInfos:n}=this.props;t.fetchDate!==this.state.fetchDate&&this.fetchEventsData()}onSetSidebarOpen(e){this.setState({sidebarOpen:e})}render(){const{isPopupDisplayed:e,popupContent:t,day:a,fetchDate:s,operationsToDisplay:o}=this.state,{userInfos:i,operations:r}=this.props,c=S.a.filter(this.props.events,e=>v(e.date).dayOfYear()===v(a).dayOfYear()&&("amo"!==e.type||!S.a.isEmpty(S.a.intersection(this.state.collabsToDisplay,S.a.map(e.invitations,"id"))))),l=S.a.filter(c,e=>S.a.includes(o,e.operation_id)),p=(this.getOperations(this.props.events),"admin"===i.status),d=D()({"popup-halo":!0,"popup-halo--toggled":e});return!S.a.isEmpty(s)&&n.a.createElement("div",{className:"calendar-container-mobile-day"},p&&n.a.createElement("div",{className:"add-action-btn-container"},n.a.createElement(F,{clickAction:this.openNewEventPopup,label:"Nouveau RDV"})),n.a.createElement("div",{className:"calendar-center-container months-container"},n.a.createElement(st,null),n.a.createElement(ot,null),n.a.createElement(tt,{day:a,index:0,events:l,fetchEventsData:this.fetchEventsData,operations:r,openEditEventPopup:this.openEditEventPopup})),n.a.createElement("div",{className:"week-navigation-container-month"},n.a.createElement("div",{className:"week-navigation-holder-month"},n.a.createElement("div",{className:"calendar-navigation-container",onClick:this.navigateToPreviousWeek},n.a.createElement("svg",{viewBox:"0 0 512 512",width:"20",height:"20"},n.a.createElement("path",{d:"M198.608,246.104L382.664,62.04c5.068-5.056,7.856-11.816,7.856-19.024c0-7.212-2.788-13.968-7.856-19.032l-16.128-16.12\r C361.476,2.792,354.712,0,347.504,0s-13.964,2.792-19.028,7.864L109.328,227.008c-5.084,5.08-7.868,11.868-7.848,19.084\r c-0.02,7.248,2.76,14.028,7.848,19.112l218.944,218.932c5.064,5.072,11.82,7.864,19.032,7.864c7.208,0,13.964-2.792,19.032-7.864\r l16.124-16.12c10.492-10.492,10.492-27.572,0-38.06L198.608,246.104z"}))),n.a.createElement("div",{className:"top"},n.a.createElement("div",{onClick:this.openDatePicker},"".concat(v(a).format("D MMM"))),n.a.createElement("div",{className:"bottom",onClick:this.openDatePicker},"".concat(v(a).format("YYYY")))),n.a.createElement("div",{className:"calendar-navigation-container",onClick:this.navigateToNextWeek},n.a.createElement("svg",{viewBox:"0 0 512 512",width:"20",height:"20"},n.a.createElement("path",{d:"M382.678,226.804L163.73,7.86C158.666,2.792,151.906,0,144.698,0s-13.968,2.792-19.032,7.86l-16.124,16.12\r c-10.492,10.504-10.492,27.576,0,38.064L293.398,245.9l-184.06,184.06c-5.064,5.068-7.86,11.824-7.86,19.028\r c0,7.212,2.796,13.968,7.86,19.04l16.124,16.116c5.068,5.068,11.824,7.86,19.032,7.86s13.968-2.792,19.032-7.86L382.678,265\r c5.076-5.084,7.864-11.872,7.848-19.088C390.542,238.668,387.754,231.884,382.678,226.804z"}))),n.a.createElement(ee.a,{ref:this.datePickerRef,selected:a._d,onChange:this.navigateToDate,popperPlacement:"top-end"}))),e&&n.a.createElement("div",null,n.a.createElement("div",{className:d,onClick:()=>{this.setPopupState(!1)}}),n.a.createElement("div",{className:"popup-container"},t)))}}var mt=Object(r.b)(e=>({loading:e.events.loading,events:e.events.events,hasErrors:e.events.hasErrors,sessionToken:e.me.sessionToken,userInfos:e.me.infos,operations:e.operations.operations,isOperationsLoading:e.operations.loading}),e=>Object(i.bindActionCreators)({fetchOperations:be,fetchEvents:G,fetchAmoEvents:H,logout:De,fetchMyOperations:_e},e))(ht);a(423);class ut extends s.Component{constructor(e){super(e),this.state={mail:""}}componentDidMount(){const{fetchOperations:e,sessionToken:t}=this.props;e(t)}render(){const{mail:e}=this.state,{operations:t,towardsRdvSettingsPage:a}=this.props;return n.a.createElement("div",{className:"rdv-settings-popup-container"},n.a.createElement("div",{className:"title"},"Choisir l'opération ..."),n.a.createElement(b.Scrollbars,{autoHeight:!0,autoHeightMin:0,autoHeightMax:400},_.map(t,e=>n.a.createElement("div",{className:"operation-container",onClick:_.partial(a,e.id)},n.a.createElement("div",{className:"operation-top"},n.a.createElement("div",{className:"left-container"},n.a.createElement("div",{className:"operation-title"},e.name)))))))}}var Et=Object(r.b)(e=>({sessionToken:e.me.sessionToken,userInfos:e.me.infos,isLoading:e.operations.loading,operations:e.operations.operations}),e=>Object(i.bindActionCreators)({fetchOperations:be,createOperation:we,postDeleteOperation:Me},e))(ut);a(424);class vt extends s.Component{constructor(e){super(e),this.openAMOPopup=(e,t,a,s)=>n=>{const{openAMOPopup:o}=this.props;n.stopPropagation(),o(e,t,a,s)},this.state={}}render(){const{events:e,index:t,day:a,setPopupState:s,setPopupContent:o,openAddEvent:i,operations:r,goToDaily:c,isAdmin:l,isOff:p}=this.props,d=D()({"day-month-master-1-container":!0,"day-month-master-1-container--today":Object(y.a)(a),"day-month-master-1-container--weekend":!Object(y.a)(a)&&S.a.includes([0,6],v(a).day()),"day-month-master-1-container--off":!Object(y.a)(a)&&!S.a.includes([0,6],v(a).day())&&p}),h=S.a.groupBy(e,"operation_id");return n.a.createElement("div",{className:d,onClick:c(a)},n.a.createElement("div",{className:"top-day"},n.a.createElement("div",null,t+1),l&&n.a.createElement("div",{className:"add-icon",onClick:i(a)},n.a.createElement("svg",{height:"20px",viewBox:"0 -24 512 511",width:"20px",xmlns:"http://www.w3.org/2000/svg"},n.a.createElement("path",{fill:"#84a9ac",d:"m400.601562 241.5c-61.425781 0-111.398437 49.972656-111.398437 111.398438 0 61.425781 49.972656 111.402343 111.398437 \r 111.402343 61.425782 0 111.398438-49.972656 111.398438-111.402343 0-61.425782-49.976562-111.398438-111.398438-111.398438zm32.132813 \r 126.398438h-17.132813v17.132812c0 8.285156-6.714843 15-15 15-8.285156 0-15-6.714844-15-15v-17.132812h-17.132812c-8.285156 0-15-6.714844-15-15 \r 0-8.28125 6.714844-15 15-15h17.132812v-17.132813c0-8.28125 6.714844-15 15-15 8.285157 0 15 6.71875 15 15v17.132813h17.132813c8.285156 0 15 6.71875 \r 15 15 0 8.285156-6.714844 15-15 15zm0 0"}),n.a.createElement("path",{fill:"#84a9ac",d:"m159.601562 223.300781c61.425782 0 111.398438-49.976562 111.398438-111.402343 0-61.425782-49.976562-111.398438-111.398438-111.398438-61.425781 \r 0-111.402343 49.972656-111.402343 111.398438 0 61.429687 49.976562 111.402343 111.402343 111.402343zm0 0"}),n.a.createElement("path",{fill:"#84a9ac",d:"m291.453125 263.101562c-11.269531-16.496093-25.546875-30.792968-42.042969-42.066406-24.4375 20.148438-55.734375 32.265625-89.808594 \r 32.265625-34.074218 0-65.371093-12.117187-89.8125-32.265625-42.097656 28.765625-69.789062 77.140625-69.789062 131.863282v56.234374c0 30.421876 \r 24.746094 55.167969 55.164062 55.167969h208.867188c13.421875 0 25.734375-4.820312 \r 35.308594-12.816406-24.820313-25.492187-40.140625-60.28125-40.140625-98.585937 0-34.066407 12.113281-65.359376 32.253906-89.796876zm0 0"})))),n.a.createElement(b.Scrollbars,{autoHeight:!0,autoHeightMin:0,autoHeightMax:160},S.a.map(h,(e,t)=>{const s=S.a.filter(e,e=>"amo"===e.type),o=S.a.filter(e,e=>"rdv"===e.type),i=S.a.reduce(s,(e,t,a)=>S.a.uniqBy(S.a.concat(e,t.invitations),"id"),[]),c=S.a.find(r,["id",S.a.parseInt(t)]);let l={};return S.a.each(i,e=>{l[e.id]=e.hours}),n.a.createElement("div",{onClick:this.openAMOPopup(a,S.a.map(i,e=>e.id),[S.a.parseInt(t)],l),className:"event-day-container",style:{backgroundColor:"".concat(c.color)}},n.a.createElement("div",null,S.a.map(i,e=>n.a.createElement("div",null,e.name))),S.a.size(o)>0&&n.a.createElement("div",null,"".concat(S.a.size(o)," rdv acquéreur")))})))}}var gt=vt;a(425);class ft extends s.Component{constructor(e){super(e),this.setTotal1=e=>this.setState({total1:e.target.value}),this.setTotal2=e=>this.setState({total2:e.target.value}),this.onUpdateTotal1=()=>{const{id:e,fetchUpdateOperationTotal:t,fetchDate:a,sessionToken:s,fetchOperations:n}=this.props,{total1:o}=this.state;t(s,"total1",a,e,o).then(()=>{n(s)})},this.onUpdateTotal2=()=>{const{id:e,fetchUpdateOperationTotal:t,fetchDate:a,sessionToken:s,fetchOperations:n}=this.props,{total2:o}=this.state;t(s,"total2",a,e,o).then(()=>{n(s)})},this.updateTotals=()=>{const{total1:e,total2:t}=this.state;this.props.total1!==e&&this.onUpdateTotal1(),this.props.total2!==t&&this.onUpdateTotal2()},this.state={saveTotal1:e.total1,saveTotal2:e.total2,total1:e.total1,total2:e.total2}}static getDerivedStateFromProps(e,t){if(t.saveTotal1!==e.total1||t.saveTotal2!==e.total2)return{saveTotal1:e.total1,saveTotal2:e.total2,total1:e.total1,total2:e.total2}}render(){const{total1:e,total2:t}=this.state,{name:a,isLoading:s,recessionValue:o,nbCa:i}=this.props,r=this.props.total1!==e||this.props.total2!==t;return n.a.createElement("div",{className:"operation-totals-display-container"},n.a.createElement("div",{className:"name-container"},a),n.a.createElement("div",{className:"total-container"},n.a.createElement(P,{value:e,onChange:this.setTotal1,placeholder:"Total 1",isDescription:!1})),n.a.createElement("div",{className:"total-container"},n.a.createElement("div",{className:"auto-total"},"".concat(o," + ")),n.a.createElement(P,{value:t,onChange:this.setTotal2,placeholder:"Total 2",isDescription:!1}),n.a.createElement("div",{className:"ca-info"},"(".concat(i," conciergerie/accueil) = ").concat(_.parseInt(t)+_.parseInt(o)))),r&&n.a.createElement("div",{className:"btn-container"},n.a.createElement(F,{clickAction:this.updateTotals,label:"Save",isLoading:s})))}}var yt=Object(r.b)(e=>({}),e=>Object(i.bindActionCreators)({fetchUpdateOperationTotal:Pe,fetchOperations:be},e))(ft);a(426);class Nt extends s.Component{constructor(e){super(e),this.setPopupState=e=>{this.setState({isPopupDisplayed:e})},this.setPopupContent=e=>{this.setState({popupContent:e})},this.openNewEventPopup=()=>{const{userInfos:e}=this.props;if(!("admin"===e.status))return;const t=n.a.createElement(Le,{closePopup:()=>{this.setPopupState(!1)},fetchEventsData:this.fetchEventsData});this.setState({popupContent:t,isPopupDisplayed:!0})},this.goToDaily=e=>()=>{const{userInfos:t,history:a}=this.props;a.push("/calendarday/".concat(v(e).dayOfYear(),"/").concat(v(e).year()))},this.openNewEventPopupDay=e=>t=>{const{userInfos:a,history:s}=this.props;if(t.stopPropagation(),!("admin"===a.status))return;const o=n.a.createElement(Ge,{closePopup:()=>{this.setPopupState(!1)},fetchEventsData:this.fetchEventsData,date:e});this.setState({popupContent:o,isPopupDisplayed:!0})},this.openAMOPopup=(e,t,a,s)=>{const{userInfos:o}=this.props;if(!("admin"===o.status))return;const i=n.a.createElement(Ge,{closePopup:()=>{this.setPopupState(!1)},fetchEventsData:this.fetchEventsData,date:e,selectedUsers:t,selectedOperation:a,hoursKeyObject:s});this.setState({popupContent:i,isPopupDisplayed:!0})},this.openInvitationPopup=()=>{const e=n.a.createElement(He,{closePopup:()=>{this.setPopupState(!1)}});this.setState({popupContent:e,isPopupDisplayed:!0})},this.openOperationsPopup=()=>{const e=n.a.createElement(Be,{closePopup:()=>{this.setPopupState(!1)},towardsCreateOperationPopup:this.openCreateOperationPopup,towardsEditOperationPopup:this.openEditOperationPopup});this.setState({popupContent:e,isPopupDisplayed:!0})},this.openCreateOperationPopup=()=>{const e=n.a.createElement(We,{closePopup:()=>{this.setPopupState(!1)},towardsOperationPopup:this.openOperationsPopup});this.setState({popupContent:e,isPopupDisplayed:!0})},this.openEditOperationPopup=(e,t,a,s)=>()=>{const o=n.a.createElement(Ze,{closePopup:()=>{this.setPopupState(!1)},towardsOperationPopup:this.openOperationsPopup,id:e,name:t,data:a,location:s});this.setState({popupContent:o,isPopupDisplayed:!0})},this.openRdvSettingsPopup=()=>{const e=n.a.createElement(Et,{closePopup:()=>{this.setPopupState(!1)},towardsRdvSettingsPage:this.towardsRdvSettingsPage});this.setState({popupContent:e,isPopupDisplayed:!0})},this.towardsRdvSettingsPage=e=>{this.props.history.push("/rdvconfig/".concat(e))},this.fetchEventsData=()=>{const{sessionToken:e,fetchEvents:t,userInfos:a,fetchAmoEvents:s}=this.props;"admin"===a.status?t(this.state.fetchDate,e,S.a.get(a,"corpId")).then(()=>{this.setState({collabsToDisplay:S.a.map(this.getRecipients(this.props.events),"id"),operationsToDisplay:this.getOperations(this.props.events)})}):s(e,this.state.fetchDate,S.a.get(a,"id"),S.a.get(a,"corpId")).then(()=>{this.setState({collabsToDisplay:S.a.map(this.getRecipients(this.props.events),"id"),operationsToDisplay:this.getOperations(this.props.events)})})},this.navigateToNextMonth=()=>{const{month:e,year:t}=this.state,a=12===e,s=a?t+1:t,n=a?1:e+1,o=n<10?"0".concat(n):n;this.props.history.push("/calendarmonth/".concat(n,"/").concat(s)),this.setState({fetchDate:"".concat(s,"_").concat(o),year:s,month:n})},this.navigateToPreviousMonth=()=>{const{month:e,year:t}=this.state,a=1===e,s=a?t-1:t,n=a?12:e-1,o=n<10?"0".concat(n):n;this.props.history.push("/calendarmonth/".concat(n,"/").concat(s)),this.setState({fetchDate:"".concat(s,"_").concat(o),year:s,month:n})},this.navigateToDate=e=>{const t=v(e).month()+1,a=v(e).year(),s=t<10?"0".concat(t):t;this.props.history.push("/calendarmonth/".concat(t,"/").concat(a)),this.setState({fetchDate:"".concat(a,"_").concat(s),year:a,month:t})},this.getRecipients=e=>{let t=[];return S.a.each(e,e=>{t=S.a.uniqBy(S.a.concat(t,S.a.get(e,"invitations",[])),"id")}),t},this.getOperations=e=>{let t=[];return S.a.each(e,e=>{t=S.a.uniq(S.a.concat(t,S.a.get(e,"operation_id",[])))}),t},this.toggleRecipient=(e,t)=>{t?this.setState(t=>({collabsToDisplay:S.a.uniq(S.a.concat(t.collabsToDisplay,e))})):this.setState(t=>({collabsToDisplay:S.a.difference(t.collabsToDisplay,[e])}))},this.toggleOperation=(e,t)=>{t?this.setState(t=>({operationsToDisplay:S.a.uniq(S.a.concat(t.operationsToDisplay,e))})):this.setState(t=>({operationsToDisplay:S.a.difference(t.operationsToDisplay,[e])}))},this.logout=()=>{const{logout:e,history:t}=this.props;e(),t.push("/login")},this.openDatePicker=()=>{this.datePickerRef.current.setOpen(!0)},this.getDaysInMonth=(e,t)=>{let a=new Date(t,e,1);const s=[];for(;a.getMonth()===e;)s.push(new Date(a)),a.setDate(a.getDate()+1);return s},this.towardsOffDaysBoard=()=>{const{history:e,userInfos:t}=this.props;"admin"===t.status?e.push("/calendaroffdaysboard"):e.push("/calendaroffdays")},this.calculateRecession=e=>{const{events:t}=this.props,{month:a,year:s}=this.state;let n=0,o=0;const i=S.a.filter(this.props.events,t=>v(t.date).month()+1===a&&v(t.date).year()===s&&"amo"===t.type&&t.operation_id===e);return S.a.each(i,e=>{S.a.each(e.invitations,e=>{const t="ca"===S.a.get(S.a.split(S.a.get(e,"hours","all-day/nca"),"/"),"[1]","nca"),a="all-day"===S.a.get(S.a.split(S.a.get(e,"hours","all-day/nca"),"/"),"[0]","all-day");t?o++:n+=a?400:200})}),{calculatedTotal:n,caEvents:o}},this.renderDoubleTotals=()=>{const{operations:e,sessionToken:t,isOperationsLoading:a}=this.props,{fetchDate:s}=this.state;return n.a.createElement("div",{className:"totals-container"},S.a.map(S.a.orderBy(e,"id"),e=>{const o=JSON.parse(S.a.get(e,"totals","fetchDate: {total1: 0, total2: 0,}")),i=S.a.get(o,"".concat(s),{total1:0,total2:0}),r=this.calculateRecession(e.id);return n.a.createElement("div",null,n.a.createElement(yt,{name:e.name,id:e.id,total1:S.a.get(i,"total1",0),total2:S.a.get(i,"total2",0),fetchDate:s,sessionToken:t,recessionValue:r.calculatedTotal,nbCa:r.caEvents,isLoading:a}))}))},this.towardsDailyCalendar=()=>{const{history:e}=this.props;e.push("/calendarday")},this.datePickerRef=n.a.createRef(),this.state={year:S.a.parseInt(e.match.params.year)||v().year(),month:S.a.parseInt(e.match.params.month)||v().month()+1,sidebarOpen:!1,collabsToDisplay:[],operationsToDisplay:[],isPopupDisplayed:!1,popupContent:null,fetchDate:""}}componentDidMount(){const{month:e,year:t}=this.state,{sessionToken:a,fetchEvents:s,history:n,userInfos:o,fetchOperations:i,requestGetOffDays:r,fetchMyOperations:c}=this.props;v.locale("fr"),S.a.isNil(a)&&n.push("/login"),Ce.isMobileOnly&&n.push("/mcalendar"),"admin"===S.a.get(o,"status","user")?i(a):c(S.a.get(o,"id"),a),r(S.a.get(o,"id"),a);const l=e<10?"0".concat(e):e;this.setState({fetchDate:"".concat(t,"_").concat(l)},()=>{this.fetchEventsData()})}componentDidUpdate(e,t){const{sessionToken:a,fetchEvents:s,userInfos:n}=this.props;t.fetchDate!==this.state.fetchDate&&this.fetchEventsData()}onSetSidebarOpen(e){this.setState({sidebarOpen:e})}render(){const{isPopupDisplayed:e,popupContent:t,month:a,year:s,fetchDate:o,operationsToDisplay:i}=this.state,{userInfos:r,operations:c,offDays:l}=this.props,p=S.a.filter(this.props.events,e=>"amo"!==e.type||!S.a.isEmpty(S.a.intersection(this.state.collabsToDisplay,S.a.map(e.invitations,"id")))),d=S.a.filter(p,e=>S.a.includes(i,e.operation_id)),h=S.a.groupBy(d,e=>Object(f.a)(v(e.date)._d)),m=this.getOperations(this.props.events),u=this.getDaysInMonth(a-1,s),E=[];S.a.each(u,(e,t)=>{t%7==0?E.push([e]):E[Math.trunc(t/7)].push(e)});const g="admin"===r.status,y=D()({"popup-halo":!0,"popup-halo--toggled":e});return!S.a.isEmpty(o)&&n.a.createElement("div",{className:"calendar-container"},n.a.createElement("img",{src:pt,className:"orchestra-logo-monthly"}),n.a.createElement(lt,{recipients:this.getRecipients(this.props.events),operations:S.a.filter(c,e=>S.a.includes(m,e.id)),toggleRecipient:this.toggleRecipient,toggleOperation:this.toggleOperation,openInvitationPopup:this.openInvitationPopup,openOperationsPopup:this.openOperationsPopup,logout:this.logout,userName:S.a.get(r,"name"),towardsOffDaysBoard:this.towardsOffDaysBoard,openRdvSettingsPopup:this.openRdvSettingsPopup,isAdmin:g}),n.a.createElement("div",{className:"week-navigation-container-month"},n.a.createElement("div",{className:"week-navigation-holder-month"},n.a.createElement("div",{className:"calendar-navigation-container",onClick:this.navigateToPreviousMonth},n.a.createElement("svg",{viewBox:"0 0 512 512",width:"20",height:"20"},n.a.createElement("path",{d:"M198.608,246.104L382.664,62.04c5.068-5.056,7.856-11.816,7.856-19.024c0-7.212-2.788-13.968-7.856-19.032l-16.128-16.12\r C361.476,2.792,354.712,0,347.504,0s-13.964,2.792-19.028,7.864L109.328,227.008c-5.084,5.08-7.868,11.868-7.848,19.084\r c-0.02,7.248,2.76,14.028,7.848,19.112l218.944,218.932c5.064,5.072,11.82,7.864,19.032,7.864c7.208,0,13.964-2.792,19.032-7.864\r l16.124-16.12c10.492-10.492,10.492-27.572,0-38.06L198.608,246.104z"}))),n.a.createElement("div",{className:"top"},n.a.createElement("div",{onClick:this.openDatePicker},"".concat(S.a.capitalize(v(new Date(s,a-1,1)).format("MMM")))),n.a.createElement("div",{className:"bottom",onClick:this.openDatePicker},"".concat(v(new Date(s,a-1,1)).format("YYYY")))),n.a.createElement("div",{className:"calendar-navigation-container",onClick:this.navigateToNextMonth},n.a.createElement("svg",{viewBox:"0 0 512 512",width:"20",height:"20"},n.a.createElement("path",{d:"M382.678,226.804L163.73,7.86C158.666,2.792,151.906,0,144.698,0s-13.968,2.792-19.032,7.86l-16.124,16.12\r c-10.492,10.504-10.492,27.576,0,38.064L293.398,245.9l-184.06,184.06c-5.064,5.068-7.86,11.824-7.86,19.028\r c0,7.212,2.796,13.968,7.86,19.04l16.124,16.116c5.068,5.068,11.824,7.86,19.032,7.86s13.968-2.792,19.032-7.86L382.678,265\r c5.076-5.084,7.864-11.872,7.848-19.088C390.542,238.668,387.754,231.884,382.678,226.804z"}))),n.a.createElement(ee.a,{ref:this.datePickerRef,selected:new Date(s,a-1,1),onChange:this.navigateToDate}))),g&&n.a.createElement("div",{className:"add-action-btn-container"},n.a.createElement(F,{clickAction:this.openNewEventPopup,label:"Nouveau RDV"})),n.a.createElement("div",{className:"switch-action-btn-container"},n.a.createElement(F,{clickAction:this.towardsDailyCalendar,label:"Planning quotidien"})),n.a.createElement("div",{className:"calendar-center-container months-groups-container"},S.a.map(E,(e,t)=>n.a.createElement("div",{className:"week-of-month"},S.a.map(e,(e,a)=>{const s=S.a.some(l,t=>v(t.day).format("DD/MM/YYYY")===v(e).format("DD/MM/YYYY"));return n.a.createElement(gt,{isOff:s,setPopupState:this.setPopupState,setPopupContent:this.setPopupContent,day:e,index:7*t+a,events:S.a.get(h,"[".concat(Object(f.a)(e),"]"),[]),fetchEventsData:this.fetchEventsData,openAddEvent:this.openNewEventPopupDay,openAMOPopup:this.openAMOPopup,goToDaily:this.goToDaily,operations:c,isAdmin:g})}))),g&&this.renderDoubleTotals()),e&&n.a.createElement("div",null,n.a.createElement("div",{className:y,onClick:()=>{this.setPopupState(!1)}}),n.a.createElement("div",{className:"popup-container"},t)))}}var St=Object(r.b)(e=>({loading:e.events.loading,events:e.events.events,hasErrors:e.events.hasErrors,sessionToken:e.me.sessionToken,userInfos:e.me.infos,operations:e.operations.operations,isOperationsLoading:e.operations.loading,offDays:e.me.offDays}),e=>Object(i.bindActionCreators)({fetchOperations:be,fetchEvents:G,fetchAmoEvents:H,logout:De,requestGetOffDays:ye,fetchMyOperations:_e},e))(Nt),Tt=(a(427),a.p+"assets/orchestra_logo.575c2fed.jpeg");class Dt extends s.Component{constructor(e){super(e),this.updateEditName=e=>this.setState({editingName:e.target.value}),this.updateEditTime=e=>this.setState({editingTime:e.target.value}),this.updateEditMins=e=>this.setState({editingMins:e.target.value}),this.updateEditDuplex=e=>this.setState({editDuplex:e.target.checked}),this.updateDefaultNb=e=>this.setState({defaultNb:e.target.value},()=>{this.generateTimeSpans()}),this.updateCount=(e,t,a,s)=>()=>{const{timeSpans:n}=this.state;let o=S.a.findIndex(n,s=>s.date===e&&s.from===t&&s.to===a),i=S.a.cloneDeep(n);i[o].count=Math.max(S.a.parseInt(i[o].count)+s,0),this.setState({timeSpans:i})},this.removeFormat=e=>{const{rdvFormats:t}=this.state,a=S.a.filter(t,(t,a)=>a!==e);this.setState({rdvFormats:a})},this.removeHour=e=>{const{hours:t}=this.state,a=S.a.filter(t,(t,a)=>a!==e);this.setState({hours:a},()=>{this.generateTimeSpans()})},this.addHour=(e,t)=>()=>{const{hours:a}=this.state,s=S.a.concat(a,{from:e,to:t});this.setState({hours:s},()=>{this.setState({fromTime:"08:00",toTime:"18:00"}),this.generateTimeSpans()})},this.updateFrom=e=>this.setState({from:e},()=>{this.generateTimeSpans()}),this.updateTo=e=>this.setState({to:e},()=>{this.generateTimeSpans()}),this.updateFromTime=e=>this.setState({fromTime:e}),this.updateToTime=e=>this.setState({toTime:e}),this.addFormat=(e,t,a)=>()=>{const{rdvFormats:s,editDuplex:n}=this.state,o=S.a.concat(s,{name:"".concat(e).concat(n?"-duplex":""),duration:t,mins:a});this.setState({rdvFormats:o},()=>{this.setState({editingName:"",editingTime:"",editingMins:""})})},this.setSelectedOperationsIds=e=>this.setState({selectedOperationsIds:e}),this.generateTimeSpans=()=>{const{from:e,to:t,hours:a,timeSpans:s,defaultNb:n}=this.state;let o=[],i=v(e);const r=v(t);for(;!v(i).isAfter(r);)S.a.each(a,e=>{const t=S.a.findIndex(s,t=>t.from===e.from&&t.to===e.to&&t.date===i);-1!==t?o.push(s[t]):o.push({...e,date:i,count:this.isWeekend(v(i).toDate())?0:S.a.isEmpty(n)?1:n})}),i=v(i).add(1,"d");this.setState({timeSpans:o})},this.isWeekend=e=>{const t=new Date(e);return 6==t.getDay()||0==t.getDay()},this.showValidation=()=>{const{rdvFormats:e,timeSpans:t}=this.state;return!S.a.isEmpty(e)&&!S.a.isEmpty(t)},this.navigateToCalendar=()=>{const{history:e}=this.props;e.push("/calendarmonth")},this.submit=()=>{const{fetchUpdateOperationSettings:e,sessionToken:t}=this.props,{selectedOperationsIds:a,rdvFormats:s,from:n,to:o,hours:i,timeSpans:r,defaultNb:c}=this.state,l={settings:{formats:s,spans:r,from:n,to:o,defaultamo:c,hours:i}};e(t,S.a.head(a),JSON.stringify(l))},this.state={savedOperationSettings:e.operationSettings,rdvFormats:S.a.get(e.operationSettings,"formats",[]),hours:S.a.get(e.operationSettings,"hours",[]),timeSpans:S.a.get(e.operationSettings,"spans",[]),selectedOperationsIds:[S.a.parseInt(e.match.params.operation_id)],from:v(S.a.get(e.operationSettings,"from",v())).toDate(),to:v(S.a.get(e.operationSettings,"to",v().add(1,"w"))).toDate(),fromTime:"08:00",toTime:"18:00",editingName:"1 pièce",editingTime:"",editDuplex:!1,editingMins:"",defaultNb:S.a.get(e.operationSettings,"defaultamo","")}}componentDidMount(){const{fetchOperations:e,sessionToken:t,fetchOperationSettings:a,userInfos:s}=this.props,{selectedOperationsIds:n}=this.state;"admin"===s.status||history.push("/calendarmonth"),v.locale("fr"),e(t),a(t,S.a.first(n))}static getDerivedStateFromProps(e,t){return S.a.isEqual(e.operationSettings,t.savedOperationSettings)?null:{savedOperationSettings:e.operationSettings,rdvFormats:S.a.get(e.operationSettings,"formats",[]),hours:S.a.get(e.operationSettings,"hours",[]),timeSpans:S.a.get(e.operationSettings,"spans",[]),selectedOperationsIds:[S.a.parseInt(e.match.params.operation_id)],from:v(S.a.get(e.operationSettings,"from",v())).toDate(),to:v(S.a.get(e.operationSettings,"to",v().add(1,"w"))).toDate(),defaultNb:S.a.get(e.operationSettings,"defaultamo","")}}render(){const{operations:e}=this.props,{rdvFormats:t,editingName:a,editingTime:s,hours:o,timeSpans:i,selectedOperationsIds:r,defaultNb:c,editingMins:l,editDuplex:p}=this.state;return n.a.createElement("div",{className:"rdv-acq-config"},n.a.createElement("img",{src:Tt,className:"orchestra-logo"}),n.a.createElement("div",{className:"back-action-btn-container"},n.a.createElement(F,{clickAction:this.navigateToCalendar,label:"Retour au planning"})),n.a.createElement("div",{className:"operation"},n.a.createElement("div",{className:"title"},"Opération : ".concat(S.a.isEmpty(r)?"choisir":S.a.find(e,{id:r[0]}).name))),n.a.createElement("div",{className:"formats"},n.a.createElement("div",{className:"title"},"Insérer les formats possibles"),S.a.map(t,(e,t)=>n.a.createElement("div",{className:"format-container"},n.a.createElement("div",{className:"format-name"},e.name),n.a.createElement("div",{className:"format-duration"},n.a.createElement("div",null,"".concat(e.duration,"h").concat(S.a.get(e,"mins","00"))),n.a.createElement("div",{className:"remove",onClick:S.a.partial(this.removeFormat,t)},"x")))),n.a.createElement("div",{className:"format-new-container"},n.a.createElement("div",{className:"inputs"},n.a.createElement("select",{value:a,onChange:this.updateEditName,className:"input1"},n.a.createElement("option",{value:"1 pièce"},"1 pièce"),n.a.createElement("option",{value:"2 pièces"},"2 pièces"),n.a.createElement("option",{value:"3 pièces"},"3 pièces"),n.a.createElement("option",{value:"4 pièces"},"4 pièces"),n.a.createElement("option",{value:"5 pièces"},"5 pièces"),n.a.createElement("option",{value:"6 pièces"},"6 pièces")),n.a.createElement("input",{className:"input2",value:s,onChange:this.updateEditTime,placeholder:"heures",type:"number"}),n.a.createElement("input",{className:"input2",value:l,onChange:this.updateEditMins,placeholder:"mins",type:"number"}),n.a.createElement("input",{name:"duplex",type:"checkbox",checked:p,onChange:this.updateEditDuplex}),n.a.createElement("div",{className:"duplex-label"},"duplex")),n.a.createElement("div",{className:"cta"},!S.a.isEmpty(s)&&!S.a.isEmpty(a)&&n.a.createElement(F,{clickAction:this.addFormat(a,s,l),label:"Ajouter"})))),n.a.createElement("div",{className:"duration"},n.a.createElement("div",{className:"title"},"Choisir les dates d'ouverture et le nombre d'AMOs par défaut"),n.a.createElement("div",{className:"date-pickers"},n.a.createElement("div",{className:"date-picker"},n.a.createElement("span",{className:"pronoun"},"De"),n.a.createElement(ee.a,{selected:this.state.from,onChange:this.updateFrom})),n.a.createElement("div",{className:"date-picker"},n.a.createElement("span",{className:"pronoun"},"A"),n.a.createElement(ee.a,{selected:this.state.to,onChange:this.updateTo}))),n.a.createElement("div",{className:"inputAMO"},n.a.createElement("input",{value:c,onChange:this.updateDefaultNb,placeholder:"AMOs par défaut",type:"number"}))),n.a.createElement("div",{className:"time"},n.a.createElement("div",{className:"title"},"Choisir les plages horaires"),S.a.map(o,(e,t)=>n.a.createElement("div",{className:"format-container"},n.a.createElement("div",{className:"format-name"},e.from),n.a.createElement("div",{className:"format-duration"},n.a.createElement("div",null,"".concat(e.to,"h")),n.a.createElement("div",{className:"remove",onClick:S.a.partial(this.removeHour,t)},"x")))),n.a.createElement("div",{className:"date-pickers-container"},n.a.createElement("div",{className:"date-pickers"},n.a.createElement("div",{className:"date-picker"},n.a.createElement("span",{className:"pronoun"},"De"),n.a.createElement(I.a,{onChange:this.updateFromTime,value:this.state.fromTime})),n.a.createElement("div",{className:"date-picker"},n.a.createElement("span",{className:"pronoun"},"A"),n.a.createElement(I.a,{onChange:this.updateToTime,value:this.state.toTime}))),n.a.createElement("div",{className:"cta"},n.a.createElement(F,{clickAction:this.addHour(this.state.fromTime,this.state.toTime),label:"Ajouter"})))),n.a.createElement("div",{className:"half-days"},n.a.createElement("div",{className:"title"},"Ajuster les créneaux"),n.a.createElement("div",{className:"day-boxes"},S.a.map(i,e=>{const t=D()({"day-box__count-container":!0,"day-box__count-container--disabled":0===e.count});return n.a.createElement("div",{className:"day-box"},n.a.createElement("div",{className:"day-box__day"},v(e.date).format("dddd Do MMM YYYY")),n.a.createElement("div",{className:"day-box__time"},"".concat(e.from," - ").concat(e.to)),n.a.createElement("div",{className:t},n.a.createElement("div",{className:"day-box__count-remove",onClick:this.updateCount(e.date,e.from,e.to,-1)},"-"),n.a.createElement("div",{className:"day-box__count-icon"},n.a.createElement("svg",{viewBox:"-42 0 512 512.002",width:"18"},n.a.createElement("path",{fill:"#84a9ac",d:"m210.351562 246.632812c33.882813 0 63.222657-12.152343 87.195313-36.128906 23.972656-23.972656 36.125-53.304687 \r 36.125-87.191406 0-33.875-12.152344-63.210938-36.128906-87.191406-23.976563-23.96875-53.3125-36.121094-87.191407-36.121094-33.886718 \r 0-63.21875 12.152344-87.191406 36.125s-36.128906 53.308594-36.128906 87.1875c0 33.886719 12.15625 63.222656 36.132812 87.195312 23.976563 \r 23.96875 53.3125 36.125 87.1875 36.125zm0 0"}),n.a.createElement("path",{fill:"#84a9ac",d:"m426.128906 393.703125c-.691406-9.976563-2.089844-20.859375-4.148437-32.351563-2.078125-11.578124-4.753907-22.523437-7.957031-32.527343-3.308594-10.339844-7.808594-20.550781-13.371094-30.335938-5.773438-10.15625-12.554688-19-20.164063-26.277343-7.957031-7.613282-17.699219-13.734376-28.964843-18.199219-11.226563-4.441407-23.667969-6.691407-36.976563-6.691407-5.226563 \r 0-10.28125 2.144532-20.042969 8.5-6.007812 3.917969-13.035156 8.449219-20.878906 13.460938-6.707031 4.273438-15.792969 8.277344-27.015625 \r 11.902344-10.949219 3.542968-22.066406 5.339844-33.039063 5.339844-10.972656 0-22.085937-1.796876-33.046874-5.339844-11.210938-3.621094-20.296876-7.625-26.996094-11.898438-7.769532-4.964844-14.800782-9.496094-20.898438-13.46875-9.75-6.355468-14.808594-8.5-20.035156-8.5-13.3125 \r 0-25.75 2.253906-36.972656 6.699219-11.257813 4.457031-21.003906 10.578125-28.96875 18.199219-7.605469 7.28125-14.390625 16.121094-20.15625 \r 26.273437-5.558594 9.785157-10.058594 19.992188-13.371094 30.339844-3.199219 10.003906-5.875 20.945313-7.953125 32.523437-2.058594 11.476563-3.457031 \r 22.363282-4.148437 32.363282-.679688 9.796875-1.023438 19.964844-1.023438 30.234375 0 26.726562 8.496094 48.363281 25.25 64.320312 16.546875 15.746094 \r 38.441406 23.734375 65.066406 23.734375h246.53125c26.625 0 48.511719-7.984375 65.0625-23.734375 16.757813-15.945312 25.253906-37.585937 \r 25.253906-64.324219-.003906-10.316406-.351562-20.492187-1.035156-30.242187zm0 0"}))),n.a.createElement("div",{className:"day-box__count-title"},e.count),n.a.createElement("div",{className:"day-box__count-add",onClick:this.updateCount(e.date,e.from,e.to,1)},"+")))}))),this.showValidation()&&n.a.createElement(F,{clickAction:this.submit,label:"Appliquer"}))}}var Ct=Object(r.b)(e=>({sessionToken:e.me.sessionToken,userInfos:e.me.infos,operations:e.operations.operations,isOperationsLoading:e.operations.loading,operationSettings:e.operations.settings}),e=>Object(i.bindActionCreators)({fetchOperations:be,fetchEvents:G,fetchAmoEvents:H,fetchOperationSettings:ke,fetchUpdateOperationSettings:Ie},e))(Dt);a(428);class Ot extends s.Component{constructor(e){super(e),this.isEmailTaken=()=>{const{editingMail:e,takenEmails:t}=this.state;return S.a.includes(t,e)},this.submit=()=>{const{fetchCreateNoauthEvent:e}=this.props,{editingName:t,editingMail:a,editingPhone:s,chosenFormatIdx:n,selectedDay:o,rdvFormats:i,timeSpans:r,operationId:c}=this.state,l=this.generateAvailableTimes()[o],p=l.date,d="".concat(v(p).year(),"-").concat(v(p).month()+1,"-").concat(v(p).date());e("Rdv ".concat(t),"tel: ".concat(s,", visite: ").concat(i[n].name),d,l.from,l.to,"-",3,"rdv",c,a).then(()=>{this.setState({hasValidated:!0})}).catch(e=>{console.log(e)})},this.updateEditName=e=>this.setState({editingName:e.target.value}),this.updateEditMail=e=>this.setState({editingMail:e.target.value}),this.updateEditPhone=e=>this.setState({editingPhone:e.target.value}),this.setSelectedDay=e=>this.setState({selectedDay:e}),this.chooseFormatIdx=e=>this.setState({chosenFormatIdx:e},()=>{this.setSelectedDay(-1)}),this.getHoursAndMinutes=e=>{const t=S.a.split(e,":");return{hours:S.a.parseInt(t[0]),minutes:S.a.parseInt(t[1])}},this.compareHoursAndMins=(e,t,a,s)=>e<a||e===a&&t<=s,this.generatePotentials=(e,t,a)=>{let s=[];const n=[];let o=-1,i=0;for(;i<S.a.size(e);)e[i]>0?-1===o&&(o=i):-1!==o&&(n.push({from:o,to:i-1}),o=-1),i++;return-1!==o&&n.push({from:o,to:i-1}),S.a.each(n,e=>{e.from-e.to===t?s.push(e):e.to-e.from>t&&(s=a?S.a.concat(s,{from:e.from,to:e.from+t}):S.a.concat(s,[{from:e.from,to:e.from+t},{from:e.to-t,to:e.to}]))}),s},this.generateAvailableTimes=()=>{const{rdvFormats:e,chosenFormatIdx:t,timeSpans:a,takenRdvs:s,hasValidated:n}=this.state;if(-1===t)return[];const o=e[t].name,i=S.a.includes(o,"duplex"),r=S.a.parseInt(o)>=4||i,c=60*S.a.parseInt(e[t].duration)+S.a.parseInt(S.a.get(e[t],"mins","0"));let l=[];return S.a.each(a,e=>{const t=S.a.filter(s,t=>v(t.date).format("DD/MM/YYYY")===v(e.date).format("DD/MM/YYYY"));let{hours:a,minutes:n}=this.getHoursAndMinutes(e.from),o=a,i=n;const{hours:p,minutes:d}=this.getHoursAndMinutes(e.to);let h=[];for(;this.compareHoursAndMins(o,i,p,d);){let a=e.count;S.a.each(t,e=>{const{hours:t,minutes:s}=this.getHoursAndMinutes(e.from);let{hours:n,minutes:r}=this.getHoursAndMinutes(e.to);0!==r?r--:(n--,r=59),this.compareHoursAndMins(t,s,o,i)&&this.compareHoursAndMins(o,i,n,r)&&a--}),h.push(a),i++,60===i&&(i=0,o++)}const m=S.a.min(h),u=S.a.map(h,e=>e>m?e:0);if(S.a.size(S.a.filter(u,e=>0!==e))>60&&(h=u),r){let e=0;for(;e<S.a.size(h)&&h[e]>0&&e<=c;)e++;h=S.a.map(h,(t,a)=>a>e?0:t)}const E=this.generatePotentials(h,c,r);S.a.each(E,t=>{const s=(n+t.from)%60,o=(n+t.to)%60,i=a+Math.floor(t.from/60),r=a+Math.floor(t.to/60);l.push({from:"".concat(i,":").concat(s<10?"0".concat(s):s),to:"".concat(r,":").concat(o<10?"0".concat(o):o),date:e.date})})}),l},this.isFormValid=()=>{const{selectedDay:e,chosenFormatIdx:t,editingName:a,editingMail:s,editingPhone:n}=this.state;return!(this.isEmailTaken()||-1===e||-1===t||S.a.isEmpty(a)||S.a.isEmpty(s)||S.a.isEmpty(n))},this.state={savedPageInfos:e.pageInfos,operationId:S.a.parseInt(e.match.params.operation_id),rdvFormats:S.a.get(e.pageInfos,"settings.formats",[]),timeSpans:S.a.get(e.pageInfos,"settings.spans",[]),takenRdvs:S.a.map(S.a.get(e.pageInfos,"rdvs",[]),e=>({date:e.date,from:e.time_from,to:e.time_to})),takenEmails:S.a.map(S.a.get(e.pageInfos,"rdvs",[]),e=>e.mail),editingName:"",editingMail:"",editingPhone:"",chosenFormatIdx:-1,selectedDay:-1,hasValidated:!1}}componentDidMount(){v.locale("fr");const{operationId:e}=this.state,{fetchGetNoAuthRdvInfos:t}=this.props;t(e)}static getDerivedStateFromProps(e,t){return S.a.isEqual(e.pageInfos,t.savedPageInfos)?null:{savedPageInfos:e.pageInfos,rdvFormats:S.a.get(e.pageInfos,"settings.formats",[]),timeSpans:S.a.get(e.pageInfos,"settings.spans",[]),takenRdvs:S.a.map(S.a.get(e.pageInfos,"rdvs",[]),e=>({date:e.date,from:e.time_from,to:e.time_to}))}}render(){const{operationId:e,selectedDay:t,rdvFormats:a,chosenFormatIdx:s,editingName:o,editingMail:i,editingPhone:r,hasValidated:c}=this.state,l=this.generateAvailableTimes();return n.a.createElement("div",{className:"rdv-acq"},n.a.createElement("img",{src:Tt,className:"orchestra-logo"}),!c&&n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{className:"client-inputs"},n.a.createElement("div",{className:"welcome-text-title"},"Bienvenue,"),n.a.createElement("div",{className:"welcome-text"}," Veuillez remplir ce formulaire afin de prendre rendez-vous avec notre équipe"),n.a.createElement("div",{className:"title"},"Coordonnées"),n.a.createElement("div",{className:"inputs"},n.a.createElement(P,{value:o,onChange:this.updateEditName,placeholder:"Nom"}),n.a.createElement(P,{value:i,onChange:this.updateEditMail,placeholder:"email"}),this.isEmailTaken()&&n.a.createElement("div",{className:"email-taken"},"Un rendez-vous a déjà été pris avec ce mail ! Vérifiez vos emails"),n.a.createElement(P,{value:r,onChange:this.updateEditPhone,placeholder:"téléphone"}))),n.a.createElement("div",{className:"formats-container"},n.a.createElement("div",{className:"title"},"Type de visite"),S.a.map(a,(e,t)=>{const a=D()({"format-container":!0,"format-container--selected":t===s});return n.a.createElement("div",{className:a,onClick:S.a.partial(this.chooseFormatIdx,t)},n.a.createElement("div",{className:"format-title"},e.name))})),n.a.createElement("div",{className:"boxes-container"},n.a.createElement("div",{className:"title"},"Créneau"),n.a.createElement("div",{className:"day-boxes"},S.a.map(l,(e,a)=>{const s=D()({"day-box":!0,"day-box--disabled":-1!==t&&a!==t,"day-box--selected":a===t});return n.a.createElement("div",{className:s,onClick:S.a.partial(this.setSelectedDay,a)},n.a.createElement("div",{className:"day-box__day"},v(e.date).format("dddd Do MMM YYYY")),n.a.createElement("div",{className:"day-box__time"},"".concat(e.from," - ").concat(e.to)))}))),this.isFormValid()&&n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{className:"privacy-link"},"En validant, prenez connaissance de notre ",n.a.createElement("a",{href:"/privacypolicy"},"Politique de confidentialité")),n.a.createElement(F,{clickAction:this.submit,label:"Envoyer"}))),c&&n.a.createElement("div",{className:"validation-container"},n.a.createElement("div",{className:"title"},"Votre rendez-vous a bien été enregistré, vous receverez sous peu un mail de confirmation :"),n.a.createElement("div",{className:"date"},v(l[t].date).format("dddd Do MMM YYYY")),n.a.createElement("div",{className:"time"},"".concat(l[t].from," - ").concat(l[t].to))))}}var bt=Object(r.b)(e=>({sessionToken:e.me.sessionToken,userInfos:e.me.infos,operations:e.operations.operations,isOperationsLoading:e.operations.loading,pageInfos:e.events.rdvPageInfos}),e=>Object(i.bindActionCreators)({fetchOperations:be,fetchEvents:G,fetchAmoEvents:H,fetchCreateNoauthEvent:B,fetchGetNoAuthRdvInfos:V},e))(Ot);a(429);class _t extends s.Component{render(){return n.a.createElement("div",{className:"privacy-popup-container"},n.a.createElement("div",{className:"privacy-big-title"},"DÉCLARATION DE CONFIDENTIALITÉ"),n.a.createElement("div",{className:"privacy-title"},"ARTICLE 1 – RENSEIGNEMENTS PERSONNELS RECUEILLIS"),n.a.createElement("div",{className:"privacy-deco"}),n.a.createElement("div",{className:"privacy-content"},"Lorsque vous effectuez une réservation de rendez-vous en ligne sur notre site, nous recueillons les renseignements personnels que vous nous fournissez, tels que votre nom et votre adresse e-mail."),n.a.createElement("div",{className:"privacy-content"},"Lorsque vous naviguez sur notre site, nous recevons également automatiquement l’adresse de protocole Internet (adresse IP) de votre ordinateur, qui nous permet d’obtenir plus de détails au sujet du navigateur et du système d’exploitation que vous utilisez."),n.a.createElement("div",{className:"privacy-title"},"ARTICLE 2 - CONSENTEMENT"),n.a.createElement("div",{className:"privacy-deco"}),n.a.createElement("div",{className:"privacy-content"},"Comment obtenez-vous mon consentement?"),n.a.createElement("div",{className:"privacy-content"},"Lorsque vous nous fournissez vos renseignements personnels pour prendre rendez-vous, nous présumons que vous consentez à ce que nous recueillions vos renseignements et à ce que nous les utilisions à cette fin uniquement."),n.a.createElement("div",{className:"privacy-content"},"Comment puis-je retirer mon consentement?"),n.a.createElement("div",{className:"privacy-content"},"Si après nous avoir donné votre consentement, vous changez d’avis et ne consentez plus à ce que nous puissions vous contacter, vous pouvez nous en aviser en nous contactant à alexis.raimbault.web@gmail.com ou par courrier à: Orchestra conseil 6 Rue Mouton-Duvernet, Paris, J, 75014, France"),n.a.createElement("div",{className:"privacy-title"},"ARTICLE 3 – DIVULGATION"),n.a.createElement("div",{className:"privacy-deco"}),n.a.createElement("div",{className:"privacy-content"},"Nous pouvons divulguer vos renseignements personnels si la loi nous oblige à le faire ou si vous violez nos Conditions Générales de Vente et d’Utilisation."),n.a.createElement("div",{className:"privacy-title"},"ARTICLE 4 – SÉCURITÉ"),n.a.createElement("div",{className:"privacy-deco"}),n.a.createElement("div",{className:"privacy-content"},"Pour protéger vos données personnelles, nous prenons des précautions raisonnables et suivons les meilleures pratiques de l’industrie pour nous assurer qu’elles ne soient pas perdues, détournées, consultées, divulguées, modifiées ou détruites de manière inappropriée."),n.a.createElement("div",{className:"privacy-title"},"QUESTIONS ET COORDONNÉES"),n.a.createElement("div",{className:"privacy-deco"}),n.a.createElement("div",{className:"privacy-content"},"Si vous souhaitez: accéder à, corriger, modifier ou supprimer toute information personnelle que nous avons à votre sujet, déposer une plainte, ou si vous souhaitez simplement avoir plus d’informations, contactez notre agent responsable des normes de confidentialité à alexis.raimbault.web@gmail.com ou par courrier à Orchestra conseil"),n.a.createElement("div",{className:"privacy-content"},"[Re: Agent des Normes de Confidentialité]"),n.a.createElement("div",{className:"privacy-content"},"[6 Rue Mouton-Duvernet, Paris, J, 75014, France]"),n.a.createElement("div",{className:"logo-container"},n.a.createElement("img",{src:Tt,className:"orchestra-logo"})))}}var kt=_t;a(430);class It extends s.Component{constructor(e){super(e),this.state={}}render(){const{offDays:e,index:t,day:a,setPopupState:s,setPopupContent:o,createOrDeleteOffDay:i}=this.props;return n.a.createElement("div",{className:"day-off-perso-container",onClick:i(e,a)},n.a.createElement("div",{className:"day-number"},t+1),!S.a.isEmpty(e)&&n.a.createElement("div",{className:"close"}))}}var Pt=It;a(431);class wt extends s.Component{constructor(e){super(e),this.setPopupState=e=>{this.setState({isPopupDisplayed:e})},this.setPopupContent=e=>{this.setState({popupContent:e})},this.navigateToNextMonth=()=>{const{month:e,year:t}=this.state,a=12===e,s=a?t+1:t,n=a?1:e+1;this.props.history.push("/calendaroffdays/".concat(n,"/").concat(s)),this.setState({year:s,month:n})},this.navigateToPreviousMonth=()=>{const{month:e,year:t}=this.state,a=1===e,s=a?t-1:t,n=a?12:e-1;this.props.history.push("/calendaroffdays/".concat(n,"/").concat(s)),this.setState({year:s,month:n})},this.navigateToDate=e=>{const t=v(e).month()+1,a=v(e).year();this.props.history.push("/calendaroffdays/".concat(t,"/").concat(a)),this.setState({year:a,month:t})},this.logout=()=>{const{logout:e,history:t}=this.props;e(),t.push("/login")},this.openDatePicker=()=>{this.datePickerRef.current.setOpen(!0)},this.getDaysInMonth=(e,t)=>{let a=new Date(t,e,1);const s=[];for(;a.getMonth()===e;)s.push(new Date(a)),a.setDate(a.getDate()+1);return s},this.createOrDeleteOffDay=(e,t)=>()=>{const{sessionToken:a,history:s,userInfos:n,requestGetOffDays:o,addOffDay:i,deleteOffDay:r}=this.props;if(!S.a.isEmpty(e))r(e.id,a).then(()=>{o(S.a.get(n,"id"),a)});else{const e="".concat(v(t).year(),"-").concat(v(t).month()+1,"-").concat(v(t).date());i(S.a.get(n,"id"),e,a).then(()=>{o(S.a.get(n,"id"),a)})}},this.navigateToCalendar=()=>{const{history:e}=this.props;e.push("/calendarmonth")},this.datePickerRef=n.a.createRef(),this.state={year:S.a.parseInt(e.match.params.year)||v().year(),month:S.a.parseInt(e.match.params.week)||v().month()+1,sidebarOpen:!1,collabsToDisplay:[],operationsToDisplay:[],isPopupDisplayed:!1,popupContent:null}}componentDidMount(){const{month:e,year:t}=this.state,{sessionToken:a,history:s,userInfos:n,requestGetOffDays:o,fetchUsers:i}=this.props;v.locale("fr"),S.a.isNil(a)&&s.push("/login"),o(S.a.get(n,"id"),a),i(S.a.get(n,"corpId"),a)}onSetSidebarOpen(e){this.setState({sidebarOpen:e})}render(){const{isPopupDisplayed:e,popupContent:t,month:a,year:s}=this.state,{userInfos:o,offDays:i}=this.props,r=this.getDaysInMonth(a-1,s),c=D()({"popup-halo":!0,"popup-halo--toggled":e});return n.a.createElement("div",{className:"calendar-container"},n.a.createElement("div",{className:"back-action-btn-container"},n.a.createElement(F,{clickAction:this.navigateToCalendar,label:"Retour au planning"})),n.a.createElement("div",{className:"week-navigation-container-month"},n.a.createElement("div",{className:"week-navigation-holder-month"},n.a.createElement("div",{className:"calendar-navigation-container",onClick:this.navigateToPreviousMonth},n.a.createElement("svg",{viewBox:"0 0 512 512",width:"20",height:"20"},n.a.createElement("path",{d:"M198.608,246.104L382.664,62.04c5.068-5.056,7.856-11.816,7.856-19.024c0-7.212-2.788-13.968-7.856-19.032l-16.128-16.12\r C361.476,2.792,354.712,0,347.504,0s-13.964,2.792-19.028,7.864L109.328,227.008c-5.084,5.08-7.868,11.868-7.848,19.084\r c-0.02,7.248,2.76,14.028,7.848,19.112l218.944,218.932c5.064,5.072,11.82,7.864,19.032,7.864c7.208,0,13.964-2.792,19.032-7.864\r l16.124-16.12c10.492-10.492,10.492-27.572,0-38.06L198.608,246.104z"}))),n.a.createElement("div",{className:"top"},n.a.createElement("div",{onClick:this.openDatePicker},"".concat(v(new Date(s,a-1,1)).format("MMM"))),n.a.createElement("div",{className:"bottom",onClick:this.openDatePicker},"".concat(v(new Date(s,a-1,1)).format("YYYY")))),n.a.createElement("div",{className:"calendar-navigation-container",onClick:this.navigateToNextMonth},n.a.createElement("svg",{viewBox:"0 0 512 512",width:"20",height:"20"},n.a.createElement("path",{d:"M382.678,226.804L163.73,7.86C158.666,2.792,151.906,0,144.698,0s-13.968,2.792-19.032,7.86l-16.124,16.12\r c-10.492,10.504-10.492,27.576,0,38.064L293.398,245.9l-184.06,184.06c-5.064,5.068-7.86,11.824-7.86,19.028\r c0,7.212,2.796,13.968,7.86,19.04l16.124,16.116c5.068,5.068,11.824,7.86,19.032,7.86s13.968-2.792,19.032-7.86L382.678,265\r c5.076-5.084,7.864-11.872,7.848-19.088C390.542,238.668,387.754,231.884,382.678,226.804z"}))),n.a.createElement(ee.a,{ref:this.datePickerRef,selected:new Date(s,a-1,1),onChange:this.navigateToDate}))),n.a.createElement("div",{className:"calendar-center-container months-container"},S.a.map(r,(e,t)=>n.a.createElement(Pt,{setPopupState:this.setPopupState,setPopupContent:this.setPopupContent,day:e,index:t,offDays:S.a.find(i,t=>v(t.day).isSame(e,"date")),createOrDeleteOffDay:this.createOrDeleteOffDay}))),e&&n.a.createElement("div",null,n.a.createElement("div",{className:c,onClick:()=>{this.setPopupState(!1)}}),n.a.createElement("div",{className:"popup-container"},t)))}}var At=Object(r.b)(e=>({loading:e.me.loading,offDays:e.me.offDays,hasErrors:e.me.hasErrors,sessionToken:e.me.sessionToken,userInfos:e.me.infos}),e=>Object(i.bindActionCreators)({requestGetOffDays:ye,addOffDay:Se,deleteOffDay:Te,fetchUsers:U,logout:De},e))(wt);a(432);class Ut extends s.Component{constructor(e){super(e),this.state={}}render(){const{offDays:e,index:t,day:a,setPopupState:s,setPopupContent:o,createOrDeleteOffDay:i,users:r}=this.props;return n.a.createElement("div",{className:"day-off-container"},n.a.createElement("div",{className:"index-container"},t+1),S.a.map(e,e=>n.a.createElement("div",{className:"name-container"},S.a.find(r,{id:e.user_id}).name)))}}var Mt=Ut;a(433);class jt extends s.Component{constructor(e){super(e),this.setPopupState=e=>{this.setState({isPopupDisplayed:e})},this.setPopupContent=e=>{this.setState({popupContent:e})},this.navigateToNextMonth=()=>{const{month:e,year:t}=this.state,a=12===e,s=a?t+1:t,n=a?1:e+1;this.props.history.push("/calendaroffdaysboard/".concat(n,"/").concat(s)),this.setState({year:s,month:n})},this.navigateToPreviousMonth=()=>{const{month:e,year:t}=this.state,a=1===e,s=a?t-1:t,n=a?12:e-1;this.props.history.push("/calendaroffdaysboard/".concat(n,"/").concat(s)),this.setState({year:s,month:n})},this.navigateToDate=e=>{const t=v(e).month()+1,a=v(e).year();this.props.history.push("/calendaroffdaysboard/".concat(t,"/").concat(a)),this.setState({year:a,month:t})},this.logout=()=>{const{logout:e,history:t}=this.props;e(),t.push("/login")},this.openDatePicker=()=>{this.datePickerRef.current.setOpen(!0)},this.getDaysInMonth=(e,t)=>{let a=new Date(t,e,1);const s=[];for(;a.getMonth()===e;)s.push(new Date(a)),a.setDate(a.getDate()+1);return s},this.navigateToCalendar=()=>{const{history:e}=this.props;e.push("/calendarmonth")},this.datePickerRef=n.a.createRef(),this.state={year:S.a.parseInt(e.match.params.year)||v().year(),month:S.a.parseInt(e.match.params.week)||v().month()+1,sidebarOpen:!1,collabsToDisplay:[],operationsToDisplay:[],isPopupDisplayed:!1,popupContent:null}}componentDidMount(){const{month:e,year:t}=this.state,{sessionToken:a,history:s,userInfos:n,requestGetCompanyOffDays:o,fetchUsers:i}=this.props;v.locale("fr"),S.a.isNil(a)&&s.push("/login"),o(a),i(S.a.get(n,"corpId"),a)}onSetSidebarOpen(e){this.setState({sidebarOpen:e})}render(){const{isPopupDisplayed:e,popupContent:t,month:a,year:s}=this.state,{users:o,offDays:i}=this.props,r=this.getDaysInMonth(a-1,s),c=D()({"popup-halo":!0,"popup-halo--toggled":e});return n.a.createElement("div",{className:"calendar-container"},n.a.createElement("div",{className:"back-action-btn-container"},n.a.createElement(F,{clickAction:this.navigateToCalendar,label:"Retour au planning"})),n.a.createElement("div",{className:"week-navigation-container-month"},n.a.createElement("div",{className:"week-navigation-holder-month"},n.a.createElement("div",{className:"calendar-navigation-container",onClick:this.navigateToPreviousMonth},n.a.createElement("svg",{viewBox:"0 0 512 512",width:"20",height:"20"},n.a.createElement("path",{d:"M198.608,246.104L382.664,62.04c5.068-5.056,7.856-11.816,7.856-19.024c0-7.212-2.788-13.968-7.856-19.032l-16.128-16.12\r C361.476,2.792,354.712,0,347.504,0s-13.964,2.792-19.028,7.864L109.328,227.008c-5.084,5.08-7.868,11.868-7.848,19.084\r c-0.02,7.248,2.76,14.028,7.848,19.112l218.944,218.932c5.064,5.072,11.82,7.864,19.032,7.864c7.208,0,13.964-2.792,19.032-7.864\r l16.124-16.12c10.492-10.492,10.492-27.572,0-38.06L198.608,246.104z"}))),n.a.createElement("div",{className:"top"},n.a.createElement("div",{onClick:this.openDatePicker},"".concat(v(new Date(s,a-1,1)).format("MMM"))),n.a.createElement("div",{className:"bottom",onClick:this.openDatePicker},"".concat(v(new Date(s,a-1,1)).format("YYYY")))),n.a.createElement("div",{className:"calendar-navigation-container",onClick:this.navigateToNextMonth},n.a.createElement("svg",{viewBox:"0 0 512 512",width:"20",height:"20"},n.a.createElement("path",{d:"M382.678,226.804L163.73,7.86C158.666,2.792,151.906,0,144.698,0s-13.968,2.792-19.032,7.86l-16.124,16.12\r c-10.492,10.504-10.492,27.576,0,38.064L293.398,245.9l-184.06,184.06c-5.064,5.068-7.86,11.824-7.86,19.028\r c0,7.212,2.796,13.968,7.86,19.04l16.124,16.116c5.068,5.068,11.824,7.86,19.032,7.86s13.968-2.792,19.032-7.86L382.678,265\r c5.076-5.084,7.864-11.872,7.848-19.088C390.542,238.668,387.754,231.884,382.678,226.804z"}))),n.a.createElement(ee.a,{ref:this.datePickerRef,selected:new Date(s,a-1,1),onChange:this.navigateToDate}))),n.a.createElement("div",{className:"calendar-center-offDays-container months-container"},S.a.map(r,(e,t)=>n.a.createElement(Mt,{setPopupState:this.setPopupState,setPopupContent:this.setPopupContent,day:e,index:t,offDays:S.a.filter(i,t=>v(t.day).isSame(e,"date")),users:o}))),e&&n.a.createElement("div",null,n.a.createElement("div",{className:c,onClick:()=>{this.setPopupState(!1)}}),n.a.createElement("div",{className:"popup-container"},t)))}}var Rt=Object(r.b)(e=>({loading:e.me.loading,offDays:e.me.allOffDays,hasErrors:e.me.hasErrors,sessionToken:e.me.sessionToken,userInfos:e.me.infos,users:e.users.users}),e=>Object(i.bindActionCreators)({requestGetCompanyOffDays:Ne,addOffDay:Se,deleteOffDay:Te,fetchUsers:U,logout:De},e))(jt),xt=a(80),Lt=a(234),zt=a.n(Lt);a(434);class Ft extends s.Component{constructor(e){super(e),this.formatTime=e=>{const t=S.a.split(e,":"),a=S.a.parseInt(t[0])+S.a.parseInt(t[1])/60;return Math.floor(100*(a-6)/14)},this.calculateCoords=e=>({from:this.formatTime(e.time_from),to:this.formatTime(e.time_to)}),this.checkOverleap=(e,t)=>e.from<t.to&&t.from<e.to,this.formatWidth=e=>{const t={};S.a.forEach(e,a=>{const s=this.calculateCoords(a),n=[];S.a.forEach(e,e=>{const t=this.calculateCoords(e);e.id!==a.id&&this.checkOverleap(s,t)&&n.push(e.id)}),t[a.id]=n});const a=this.getGroupedOverleapMap(t),s={};return S.a.forEach(t,(e,t)=>{const n=S.a.size(S.a.maxBy(a[t],e=>S.a.size(e)))+1,o=Math.floor(100/n),i={},r=[];s[t]={width:o},S.a.forEach(S.a.orderBy(e,e=>S.a.get(s,"".concat(e,".width"),0),"asc"),e=>{if(!S.a.isNil(s[e])){const a=s[e].width;r.push(s[e].position),a>o&&(s[e].width=s[t].width),a<o&&(s[t].width=a,i[e]=o-a)}}),s[t].position=S.a.difference(S.a.times(n),r)[0]}),s},this.getGroupedOverleapMap=e=>{const t={};return S.a.forEach(e,(a,s)=>{if(S.a.isEmpty(a))t[s]=[[]];else{t[s]=[[a[0]]];let n=1;for(;n<S.a.size(a);){let o=0,i=!1;for(;o<S.a.size(t[s])&&!i;)S.a.includes(e[t[s][o]],a[n])&&(t[s][o].push(a[n]),i=!0),o++;i||t[s].push([a[n]]),n++}}}),t},this.renderAmoInfo=e=>{const{events:t}=this.props;let a=[];S.a.each(e,e=>{a=S.a.concat(a,e.invitations)});const s=S.a.uniqBy(a,"id");return n.a.createElement("div",{className:"event-recipients"},n.a.createElement(b.Scrollbars,{autoHeight:!0,autoHeightMin:0,autoHeightMax:70},n.a.createElement("div",{className:"container-inside-scroll"},S.a.map(s,e=>n.a.createElement("div",{className:"amo-name right-margin"},e.name)))))},this.state={}}render(){const{events:e,index:t,day:a,setPopupState:s,setPopupContent:o,openDisplayEventPopup:i}=this.props,r=S.a.filter(e,e=>"amo"===e.type),c=S.a.filter(e,e=>"rdv"===e.type),l=this.formatWidth(c),p=D()({"col-container":!0,"col-container--today":Object(y.a)(a)});return n.a.createElement("div",{className:p,style:{left:"calc(".concat(20*t,"% + 40px)")}},n.a.createElement("div",{className:"col-holder"},S.a.map(c,e=>{const t=this.calculateCoords(e);return n.a.createElement("div",{className:"event-container",style:{top:"".concat(t.from,"%"),height:"".concat(t.to-t.from,"%"),left:"".concat(l[e.id].position*l[e.id].width,"%"),width:"".concat(l[e.id].width,"%")},onClick:i(e)},n.a.createElement("div",{className:"event-holder"},n.a.createElement("div",{className:"event-holder-2"},n.a.createElement(b.Scrollbars,{className:"custom-scrollbars",renderTrackHorizontal:e=>n.a.createElement("div",{...e,style:{display:"none"},className:"track-horizontal"})},n.a.createElement("div",{className:"event-author"},e.name),n.a.createElement("div",{className:"event-recipients"},S.a.map(e.invitations,e=>n.a.createElement("div",{className:"event-recipient"},e.name))),n.a.createElement("div",{className:"event-description"},e.description)))))})),this.renderAmoInfo(r))}}var Gt=Ft;a(435);class Yt extends s.Component{constructor(e){super(e),this.state={}}render(){return n.a.createElement("div",{className:"hours-container"},S.a.map(S.a.range(15),e=>n.a.createElement("div",{style:{top:"".concat(Math.floor(100*e/14),"%")},className:"hour-container"},"".concat(e+6,"h"))))}}var Ht=Yt;a(436);class qt extends s.Component{constructor(e){super(e),this.state={title:_.get(e.eventData,"name","Title"),description:_.get(e.eventData,"description","Description"),eventDate:v(e.eventData.date).toDate(),start_time:_.get(e.eventData,"time_from","10:00"),end_time:_.get(e.eventData,"time_to","12:00"),mail:_.get(e.eventData,"mail",""),selectedUsersIds:[],selectedOperationId:_.get(e.eventData,"operation_id","")}}render(){const{title:e,description:t,mail:a,selectedOperationId:s}=this.state,{isLoading:o,operations:i}=this.props;return n.a.createElement("div",{className:"display-event-popup-container"},n.a.createElement("div",{className:"top-popup-container"},n.a.createElement("div",{className:"title"},"Event details"),n.a.createElement("div",{className:"edit-box"},n.a.createElement("div",{className:"left"},n.a.createElement("div",{className:"mail"},e),n.a.createElement("div",{className:"mail"},t),n.a.createElement("div",{className:"mail"},a)),n.a.createElement("div",{className:"right"},n.a.createElement("div",{className:"time-pickers-container"},n.a.createElement("div",{className:"time-picker"},n.a.createElement("div",{className:"time-label"},"date :"),v(this.state.eventDate).format("DD/MM/YYYY")),n.a.createElement("div",{className:"time-picker"},n.a.createElement("div",{className:"time-label"},"from : "),n.a.createElement("div",{className:"time-label"},this.state.start_time)),n.a.createElement("div",{className:"time-picker"},n.a.createElement("div",{className:"time-label"},"to : "),n.a.createElement("div",{className:"time-label"},this.state.end_time)))))))}}var Bt=Object(r.b)(e=>({}),e=>Object(i.bindActionCreators)({},e))(qt);a(437);class Vt extends s.Component{constructor(e){super(e),this.setPopupState=e=>{this.setState({isPopupDisplayed:e})},this.fetchEventsData=()=>{const{sessionToken:e,fetchOperationEvents:t,userInfos:a}=this.props,{operation_id:s}=this.props.match.params;t(this.state.fetchDate,s).then(()=>{if(this.isWeekOnTwoMonths()){const e=v(this.state.weekStart).add(4,"d"),a=v(e).month()+1,n=v(e).year(),o=a<10?"0".concat(a):a;t("".concat(n,"_").concat(o),s,!0).then(()=>{this.setState({collabsToDisplay:S.a.map(this.getRecipients(this.props.events),"id")})})}else this.setState({collabsToDisplay:S.a.map(this.getRecipients(this.props.events),"id")})})},this.isWeekOnTwoMonths=()=>{const{weekStart:e}=this.state,t=v(e).month();return v(e).add(4,"d").month()!=t},this.getDayFromWeekAndYear=(e,t)=>v().day("Monday").year(t).week(e).add(1,"d").toDate(),this.getRecipients=e=>{let t=[];return S.a.each(e,e=>{t=S.a.uniqBy(S.a.concat(t,S.a.get(e,"invitations",[])),"id")}),t},this.toggleRecipient=(e,t)=>{t?this.setState(t=>({collabsToDisplay:S.a.uniq(S.a.concat(t.collabsToDisplay,e))})):this.setState(t=>({collabsToDisplay:S.a.difference(t.collabsToDisplay,[e])}))},this.navigateToNextMonth=()=>{const{weekStart:e}=this.state,{operation_id:t}=this.props.match.params,a=v(e).add(1,"w"),s=v(a).month()+1,n=s<10?"0".concat(s):s;this.props.history.push("/calendarexport/".concat(t,"/").concat(v(a).week(),"/").concat(v(a).year())),this.setState({weekStart:a,fetchDate:"".concat(v(a).year(),"_").concat(n),year:v(a).year(),week:v(a).week()})},this.navigateToPreviousMonth=()=>{const{weekStart:e}=this.state,{operation_id:t}=this.props.match.params,a=v(e).add(-1,"w"),s=v(a).month()+1,n=s<10?"0".concat(s):s;this.props.history.push("/calendarexport/".concat(t,"/").concat(v(a).week(),"/").concat(v(a).year())),this.setState({weekStart:a,fetchDate:"".concat(v(a).year(),"_").concat(n),year:v(a).year(),week:v(a).week()})},this.navigateToDate=e=>{const{operation_id:t}=this.props.match.params,a=v(e).week(),s=v(e).year(),n=Object(g.default)(v(e).toDate(),{weekStartsOn:1}),o=v(n).month()+1,i=o<10?"0".concat(o):o;this.props.history.push("/calendarexport/".concat(t,"/").concat(a,"/").concat(s)),this.setState({weekStart:n,fetchDate:"".concat(v(n).year(),"_").concat(i),year:s,week:a})},this.logout=()=>{const{logout:e,history:t}=this.props;e(),t.push("/login")},this.renderAmoInfo=e=>{const{events:t}=this.props,{nbAmos:a}=this.state;let s=[];S.a.each(e,e=>{s=S.a.concat(s,e.invitations)});const o=S.a.uniqBy(s,"id");return-1===a&&this.setState({nbAmos:S.a.size(s)}),n.a.createElement("div",{className:"amo-infos-container",id:"divId2ToPrint"},S.a.map(o,e=>n.a.createElement("div",{className:"amo-infos"},n.a.createElement("div",{className:"amo-name"},e.name),n.a.createElement("div",{className:"amo-contact"},e.phone||e.mail))))},this.exportToPdf=async()=>{const{fetchDate:e,nbAmos:t}=this.state,{operationName:a}=this.props;this.setState({isLoading:!0});const s=document.getElementById("divIdToPrint"),n=document.getElementById("divId2ToPrint");var o=s.clientWidth,i=n.clientWidth;s.style.width="1170px",n.style.width="500px";const[r,c]=await Promise.all([xt(s,{scale:3}),xt(n,{scale:3})]),l=r.toDataURL("image/png"),p=c.toDataURL("image/png"),d=new Image;d.src=Tt;const h=new zt.a("l","pt","a4");h.addImage(l,"PNG",20,10,800,566),h.addImage(d,"png",10,20,200,63),h.text(600,20,a),h.addPage(),h.addImage(p,"PNG",210,180,400,10*t),h.addImage(d,"png",10,20,200,63),h.text(600,20,a),h.save("export_orchestra_".concat(e,".pdf")),s.style.width=o+"px",n.style.width=i+"px",this.setState({isLoading:!1})},this.openDisplayEventPopup=e=>()=>{const t=n.a.createElement(Bt,{closePopup:()=>{this.setPopupState(!1)},eventData:e});this.setState({popupContent:t,isPopupDisplayed:!0})},this.openDatePicker=()=>{this.datePickerRef.current.setOpen(!0)},this.datePickerRef=n.a.createRef(),this.state={weekStart:null,year:S.a.parseInt(e.match.params.year)||v().year(),week:S.a.parseInt(e.match.params.week)||v().week(),sidebarOpen:!1,collabsToDisplay:[],isPopupDisplayed:!1,popupContent:null,fetchDate:"",isLoading:!1,nbAmos:-1}}componentDidMount(){const{operation_id:e,week:t,year:a}=this.props.match.params,{sessionToken:s,fetchOperationEvents:n,history:o,userInfos:i}=this.props;if(v.locale("fr"),S.a.isNil(t)||S.a.isNil(a))this.setState({weekStart:Object(g.default)(new Date,{weekStartsOn:1})},()=>{const t=v(this.state.weekStart).month()+1,a=v(this.state.weekStart).year(),s=t<10?"0".concat(t):t;this.setState({fetchDate:"".concat(a,"_").concat(s)},()=>{n(this.state.fetchDate,e).then(()=>{if(this.isWeekOnTwoMonths()){const t=v(this.state.weekStart).add(4,"d"),a=v(t).month()+1,s=v(t).year(),o=a<10?"0".concat(a):a;n("".concat(s,"_").concat(o),e,!0).then(()=>{this.setState({collabsToDisplay:S.a.map(this.getRecipients(this.props.events),"id")})})}else this.setState({collabsToDisplay:S.a.map(this.getRecipients(this.props.events),"id")})})})});else{const s=this.getDayFromWeekAndYear(t-1,a);this.setState({weekStart:s},()=>{const t=v(this.state.weekStart).month()+1,a=v(this.state.weekStart).year(),s=t<10?"0".concat(t):t;this.setState({fetchDate:"".concat(a,"_").concat(s)},()=>{n(this.state.fetchDate,e).then(()=>{if(this.isWeekOnTwoMonths()){const t=v(this.state.weekStart).add(4,"d"),a=v(t).month()+1,s=v(t).year(),o=a<10?"0".concat(a):a;n("".concat(s,"_").concat(o),e,!0).then(()=>{this.setState({collabsToDisplay:S.a.map(this.getRecipients(this.props.events),"id")})})}else this.setState({collabsToDisplay:S.a.map(this.getRecipients(this.props.events),"id")})})})})}}componentDidUpdate(e,t){t.fetchDate!==this.state.fetchDate&&this.fetchEventsData()}render(){const{weekStart:e,isPopupDisplayed:t,popupContent:a,isLoading:s}=this.state,{events:o,operationName:i}=this.props,r=S.a.groupBy(o,e=>Object(f.a)(v(e.date)._d)),c=[];let l=[];S.a.forEach(S.a.times(5),t=>{const a=v(e).add(t,"d")._d;c.push({day:a,isToday:Object(y.a)(a)})}),S.a.each(c,e=>{const t=S.a.get(r,"[".concat(Object(f.a)(e.day),"]"),[]);S.a.isEmpty(t)||(l=S.a.concat(l,t))});const p=D()({"popup-halo":!0,"popup-halo--toggled":t});return!S.a.isNil(e)&&n.a.createElement("div",{className:"calendar-export-container"},n.a.createElement("img",{src:Tt,className:"orchestra-logo"}),n.a.createElement("div",{className:"export-btn"},n.a.createElement(F,{clickAction:this.exportToPdf,label:"EXPORT PDF",isLoading:s})),n.a.createElement("div",{className:"operation-name"},i),n.a.createElement("div",{className:"calendar-center-container-export",id:"divIdToPrint"},n.a.createElement("div",{className:"week-navigation-container-export"},n.a.createElement("div",{className:"week-navigation-holder-month"},n.a.createElement("div",{className:"calendar-navigation-container",onClick:this.navigateToPreviousMonth},n.a.createElement("svg",{viewBox:"0 0 512 512",width:"20",height:"20"},n.a.createElement("path",{d:"M198.608,246.104L382.664,62.04c5.068-5.056,7.856-11.816,7.856-19.024c0-7.212-2.788-13.968-7.856-19.032l-16.128-16.12\r C361.476,2.792,354.712,0,347.504,0s-13.964,2.792-19.028,7.864L109.328,227.008c-5.084,5.08-7.868,11.868-7.848,19.084\r c-0.02,7.248,2.76,14.028,7.848,19.112l218.944,218.932c5.064,5.072,11.82,7.864,19.032,7.864c7.208,0,13.964-2.792,19.032-7.864\r l16.124-16.12c10.492-10.492,10.492-27.572,0-38.06L198.608,246.104z"}))),n.a.createElement("div",{className:"top"},n.a.createElement("div",{onClick:this.openDatePicker},"".concat(v(e).format("D MMM")," - ").concat(v(e).add(4,"d").format("D MMM"))),n.a.createElement("div",{className:"bottom",onClick:this.openDatePicker},"".concat(v(e).format("YYYY")))),n.a.createElement("div",{className:"calendar-navigation-container",onClick:this.navigateToNextMonth},n.a.createElement("svg",{viewBox:"0 0 512 512",width:"20",height:"20"},n.a.createElement("path",{d:"M382.678,226.804L163.73,7.86C158.666,2.792,151.906,0,144.698,0s-13.968,2.792-19.032,7.86l-16.124,16.12\r c-10.492,10.504-10.492,27.576,0,38.064L293.398,245.9l-184.06,184.06c-5.064,5.068-7.86,11.824-7.86,19.028\r c0,7.212,2.796,13.968,7.86,19.04l16.124,16.116c5.068,5.068,11.824,7.86,19.032,7.86s13.968-2.792,19.032-7.86L382.678,265\r c5.076-5.084,7.864-11.872,7.848-19.088C390.542,238.668,387.754,231.884,382.678,226.804z"}))),n.a.createElement(ee.a,{ref:this.datePickerRef,selected:v(e).toDate(),onChange:this.navigateToDate}))),n.a.createElement(O,{daysOfWeek:c}),n.a.createElement(Ht,null),n.a.createElement(he,null),S.a.map(c,(e,t)=>n.a.createElement(Gt,{setPopupState:()=>{},setPopupContent:()=>{},day:e.day,index:t,events:S.a.get(r,"[".concat(Object(f.a)(e.day),"]"),[]),fetchEventsData:this.fetchEventsData,openDisplayEventPopup:this.openDisplayEventPopup}))),this.renderAmoInfo(l),t&&n.a.createElement("div",null,n.a.createElement("div",{className:p,onClick:()=>{this.setPopupState(!1)}}),n.a.createElement("div",{className:"popup-container"},a)))}}var Wt=Object(r.b)(e=>({loading:e.events.loading,events:e.events.operationEvents,hasErrors:e.events.hasErrors,operationName:e.events.exportPageName}),e=>Object(i.bindActionCreators)({fetchOperationEvents:Y,logout:De},e))(Vt);a(438);class Kt extends s.Component{constructor(e){super(e),this.handleChangeDate=e=>{this.setState({eventDate:e})},this.setSelectedUsersIds=e=>this.setState({selectedUsersIds:e}),this.setSelectedOperationsIds=e=>this.setState({selectedOperationsIds:e}),this.onChangeStartTime=e=>this.setState({start_time:e}),this.onChangeEndTime=e=>this.setState({end_time:e}),this.updateTitle=e=>this.setState({title:e.target.value}),this.updateMail=e=>this.setState({mail:e.target.value}),this.updateDescription=e=>this.setState({description:e.target.value}),this.sendCreateEventRequest=()=>{const{title:e,description:t,eventDate:a,start_time:s,end_time:n,selectedOperationsIds:o,mail:i}=this.state,{postUpdateEvent:r,fetchEventsData:c,closePopup:l,sessionToken:p,userInfos:d,eventData:h}=this.props,m="".concat(v(a).year(),"-").concat(v(a).month()+1,"-").concat(v(a).date());r(h.id,e,t,s,n,m,p).then(()=>{c(),l()})},this.state={title:_.get(e.eventData,"name","Title"),description:_.get(e.eventData,"description","Description"),eventDate:v(e.eventData.date).toDate(),start_time:_.get(e.eventData,"time_from","10:00"),end_time:_.get(e.eventData,"time_to","12:00"),mail:_.get(e.eventData,"mail",""),selectedUsersIds:[],selectedOperationId:_.get(e.eventData,"operation_id","")}}componentDidMount(){const{fetchUsers:e,sessionToken:t,userInfos:a}=this.props;e(_.get(a,"corpId"),t)}render(){const{title:e,description:t,mail:a,selectedOperationId:s}=this.state,{isLoading:o,operations:i}=this.props;return n.a.createElement("div",{className:"update-event-popup-container"},n.a.createElement("div",{className:"top-popup-container"},n.a.createElement("div",{className:"title"},"Update event"),n.a.createElement("div",{className:"edit-box"},n.a.createElement("div",{className:"left"},n.a.createElement(P,{value:e,onChange:this.updateTitle,placeholder:"Title here",isDescription:!1}),n.a.createElement(P,{value:t,onChange:this.updateDescription,placeholder:"Description here",isDescription:!0}),n.a.createElement("div",{className:"mail"},a)),n.a.createElement("div",{className:"right"},n.a.createElement("div",{className:"date-picker"},n.a.createElement(ee.a,{selected:this.state.eventDate,onChange:this.handleChangeDate})),n.a.createElement("div",{className:"time-pickers-container"},n.a.createElement("div",{className:"time-picker"},n.a.createElement("div",{className:"time-label"},"from : "),n.a.createElement(I.a,{onChange:this.onChangeStartTime,value:this.state.start_time})),n.a.createElement("div",{className:"time-picker"},n.a.createElement("div",{className:"time-label"},"to : "),n.a.createElement(I.a,{onChange:this.onChangeEndTime,value:this.state.end_time}))))),n.a.createElement("div",{className:"operation-edit-event"},_.find(i,{id:s}).name)),n.a.createElement("div",{className:"save-btn"},n.a.createElement(F,{clickAction:this.sendCreateEventRequest,label:"Save",isLoading:o})))}}var Zt=Object(r.b)(e=>({loading:e.users.loading,users:e.users.users,hasErrors:e.users.hasErrors,sessionToken:e.me.sessionToken,userInfos:e.me.infos,isLoading:e.events.loading,operations:e.operations.operations}),e=>Object(i.bindActionCreators)({postUpdateEvent:W,fetchUsers:U},e))(Kt);a(439),a(440);class Jt extends s.Component{constructor(...e){super(...e),this.generateRGBAFromHex=(e,t)=>"rgba("+parseInt(e.substring(1,3),16)+","+parseInt(e.substring(3,5),16)+","+parseInt(e.substring(5,7),16)+","+t+")"}render(){const{operation:{name:e,color:t,data:a},amos:s}=this.props;return n.a.createElement("div",{className:"operation-card-container",style:{backgroundColor:this.generateRGBAFromHex(t,.3)}},n.a.createElement(b.Scrollbars,{autoHeight:!0,autoHeightMin:0,autoHeightMax:260},n.a.createElement("div",{className:"op-card-title"},e),n.a.createElement("div",{className:"op-card-desc"},a),n.a.createElement("div",{className:"op-card-amos"},_.map(s,e=>n.a.createElement("div",{className:"op-card-amo"},n.a.createElement("b",null,e.name)," : ".concat(_.get(e,"phone","pas de téléphone renseigné")||"Pas de téléphone renseigné"))))))}}var Qt=Jt;class Xt extends s.Component{constructor(e){super(e),this.formatTime=e=>{const t=S.a.split(e,":"),a=S.a.parseInt(t[0])+S.a.parseInt(t[1])/60;return Math.floor(100*(a-6)/14)},this.calculateCoords=e=>({from:this.formatTime(e.time_from),to:this.formatTime(e.time_to)}),this.checkOverleap=(e,t)=>e.from<t.to&&t.from<e.to,this.formatWidth=e=>{const t={};S.a.forEach(e,a=>{const s=this.calculateCoords(a),n=[];S.a.forEach(e,e=>{const t=this.calculateCoords(e);e.id!==a.id&&this.checkOverleap(s,t)&&n.push(e.id)}),t[a.id]=n});const a=this.getGroupedOverleapMap(t),s={};return S.a.forEach(t,(e,t)=>{const n=S.a.size(S.a.maxBy(a[t],e=>S.a.size(e)))+1,o=Math.floor(100/n),i={},r=[];s[t]={width:o},S.a.forEach(S.a.orderBy(e,e=>S.a.get(s,"".concat(e,".width"),0),"asc"),e=>{if(!S.a.isNil(s[e])){const a=s[e].width;r.push(s[e].position),a>o&&(s[e].width=s[t].width),a<o&&(s[t].width=a,i[e]=o-a)}}),s[t].position=S.a.difference(S.a.times(n),r)[0]}),s},this.getGroupedOverleapMap=e=>{const t={};return S.a.forEach(e,(a,s)=>{if(S.a.isEmpty(a))t[s]=[[]];else{t[s]=[[a[0]]];let n=1;for(;n<S.a.size(a);){let o=0,i=!1;for(;o<S.a.size(t[s])&&!i;)S.a.includes(e[t[s][o]],a[n])&&(t[s][o].push(a[n]),i=!0),o++;i||t[s].push([a[n]]),n++}}}),t},this.renderAmoInfo=e=>{const{events:t,operations:a}=this.props;let s=[];return S.a.each(e,e=>{s=S.a.concat(s,S.a.map(e.invitations,t=>({operation_id:e.operation_id,...t})))}),S.a.size(s)>0&&n.a.createElement("div",{className:"event-day-recipients"},S.a.map(S.a.groupBy(s,"operation_id"),e=>n.a.createElement(Qt,{operation:S.a.find(a,{id:e[0].operation_id}),amos:e})))},this.generateRGBAFromHex=(e,t)=>"rgba("+parseInt(e.substring(1,3),16)+","+parseInt(e.substring(3,5),16)+","+parseInt(e.substring(5,7),16)+","+t+")",this.state={}}render(){const{events:e,index:t,day:a,setPopupState:s,setPopupContent:o,operations:i,openEditEventPopup:r}=this.props,c=S.a.filter(e,e=>"amo"===e.type),l=S.a.filter(e,e=>"rdv"===e.type),p=this.formatWidth(l),d=D()({"col-container":!0,"col-container--today":Object(y.a)(a)});return n.a.createElement("div",{className:d,style:{left:"calc(".concat(20*t,"% + 40px)")}},n.a.createElement("div",{className:"col-holder"},S.a.map(l,e=>{const t=this.calculateCoords(e);return n.a.createElement("div",{className:"event-container",style:{top:"".concat(t.from,"%"),height:"".concat(t.to-t.from,"%"),left:"".concat(p[e.id].position*p[e.id].width,"%"),width:"".concat(p[e.id].width,"%")},onClick:r(e)},n.a.createElement("div",{className:"event-holder",style:{backgroundColor:this.generateRGBAFromHex(S.a.find(i,{id:e.operation_id}).color,.3)}},n.a.createElement("div",{className:"event-holder-2"},n.a.createElement(b.Scrollbars,{className:"custom-scrollbars",renderTrackHorizontal:e=>n.a.createElement("div",{...e,style:{display:"none"},className:"track-horizontal"})},n.a.createElement("div",{className:"event-author"},e.name),n.a.createElement("div",{className:"event-recipients"},S.a.map(e.invitations,e=>n.a.createElement("div",{className:"event-recipient"},e.name))),n.a.createElement("div",{className:"event-description"},e.description)))))})),this.renderAmoInfo(c))}}var $t=Xt;a(441);class ea extends s.Component{constructor(e){super(e),this.state={}}render(){return n.a.createElement("div",{className:"hours-container"},S.a.map(S.a.range(15),e=>n.a.createElement("div",{style:{top:"".concat(Math.floor(100*e/14),"%")},className:"hour-container"},"".concat(e+6,"h"))))}}var ta=ea;a(442);class aa extends s.Component{constructor(e){super(e),this.state={}}render(){return n.a.createElement("div",{className:"hours-lines-day-container"},S.a.map(S.a.range(13),e=>n.a.createElement("div",{style:{top:"".concat(Math.floor(100*(e+1)/14),"%")},className:"hour-line-container"})))}}var sa=aa;a(443);class na extends s.Component{constructor(e){super(e),this.setPopupState=e=>{this.setState({isPopupDisplayed:e})},this.setPopupContent=e=>{this.setState({popupContent:e})},this.openNewEventPopup=()=>{const{userInfos:e}=this.props;if(!("admin"===e.status))return;const t=n.a.createElement(Le,{closePopup:()=>{this.setPopupState(!1)},fetchEventsData:this.fetchEventsData});this.setState({popupContent:t,isPopupDisplayed:!0})},this.openNewEventPopupDay=e=>()=>{const{userInfos:t}=this.props;if(!("admin"===t.status))return;const a=n.a.createElement(Ge,{closePopup:()=>{this.setPopupState(!1)},fetchEventsData:this.fetchEventsData,date:e});this.setState({popupContent:a,isPopupDisplayed:!0})},this.openEditEventPopup=e=>()=>{const{userInfos:t}=this.props;if(!("admin"===t.status))return;const a=n.a.createElement(Zt,{closePopup:()=>{this.setPopupState(!1)},fetchEventsData:this.fetchEventsData,eventData:e});this.setState({popupContent:a,isPopupDisplayed:!0})},this.openAMOPopup=(e,t,a)=>{const{userInfos:s}=this.props;if(!("admin"===s.status))return;const o=n.a.createElement(Ge,{closePopup:()=>{this.setPopupState(!1)},fetchEventsData:this.fetchEventsData,date:e,selectedUsers:t,selectedOperation:a});this.setState({popupContent:o,isPopupDisplayed:!0})},this.openInvitationPopup=()=>{const e=n.a.createElement(He,{closePopup:()=>{this.setPopupState(!1)}});this.setState({popupContent:e,isPopupDisplayed:!0})},this.openOperationsPopup=()=>{const e=n.a.createElement(Be,{closePopup:()=>{this.setPopupState(!1)},towardsCreateOperationPopup:this.openCreateOperationPopup,towardsEditOperationPopup:this.openEditOperationPopup});this.setState({popupContent:e,isPopupDisplayed:!0})},this.openCreateOperationPopup=()=>{const e=n.a.createElement(We,{closePopup:()=>{this.setPopupState(!1)},towardsOperationPopup:this.openOperationsPopup});this.setState({popupContent:e,isPopupDisplayed:!0})},this.openEditOperationPopup=(e,t,a,s)=>()=>{const o=n.a.createElement(Ze,{closePopup:()=>{this.setPopupState(!1)},towardsOperationPopup:this.openOperationsPopup,id:e,name:t,data:a,location:s});this.setState({popupContent:o,isPopupDisplayed:!0})},this.fetchEventsData=()=>{const{sessionToken:e,fetchEvents:t,userInfos:a,fetchAmoEvents:s}=this.props;"admin"===a.status?t(this.state.fetchDate,e,S.a.get(a,"corpId")).then(()=>{this.setState({collabsToDisplay:S.a.map(this.getRecipients(this.props.events),"id"),operationsToDisplay:this.getOperations(this.props.events)})}):s(e,this.state.fetchDate,S.a.get(a,"id"),S.a.get(a,"corpId")).then(()=>{this.setState({collabsToDisplay:S.a.map(this.getRecipients(this.props.events),"id"),operationsToDisplay:this.getOperations(this.props.events)})})},this.navigateToNextWeek=()=>{const{day:e}=this.state,t=v(e).add(1,"d"),a=v(t).dayOfYear(),s=v(t).year(),n=v(t).month()+1,o=n<10?"0".concat(n):n;this.props.history.push("/calendarday/".concat(a,"/").concat(s)),this.setState({fetchDate:"".concat(s,"_").concat(o),day:t,year:s,dayCount:a})},this.navigateToPreviousWeek=()=>{const{day:e}=this.state,t=v(e).add(-1,"d"),a=v(t).dayOfYear(),s=v(t).year(),n=v(t).month()+1,o=n<10?"0".concat(n):n;this.props.history.push("/calendarday/".concat(a,"/").concat(s)),this.setState({fetchDate:"".concat(s,"_").concat(o),day:t,year:s,dayCount:a})},this.navigateToDate=e=>{const t=v(e).dayOfYear(),a=v(e).year(),s=v(e).month()+1,n=s<10?"0".concat(s):s;this.props.history.push("/calendarday/".concat(t,"/").concat(a)),this.setState({fetchDate:"".concat(a,"_").concat(n),day:e,year:a,dayCount:t})},this.getRecipients=e=>{let t=[];return S.a.each(e,e=>{t=S.a.uniqBy(S.a.concat(t,S.a.get(e,"invitations",[])),"id")}),t},this.getOperations=e=>{let t=[];return S.a.each(e,e=>{t=S.a.uniq(S.a.concat(t,S.a.get(e,"operation_id",[])))}),t},this.toggleRecipient=(e,t)=>{t?this.setState(t=>({collabsToDisplay:S.a.uniq(S.a.concat(t.collabsToDisplay,e))})):this.setState(t=>({collabsToDisplay:S.a.difference(t.collabsToDisplay,[e])}))},this.toggleOperation=(e,t)=>{t?this.setState(t=>({operationsToDisplay:S.a.uniq(S.a.concat(t.operationsToDisplay,e))})):this.setState(t=>({operationsToDisplay:S.a.difference(t.operationsToDisplay,[e])}))},this.logout=()=>{const{logout:e,history:t}=this.props;e(),t.push("/login")},this.openDatePicker=()=>{this.datePickerRef.current.setOpen(!0)},this.getDaysInMonth=(e,t)=>{let a=new Date(t,e,1);const s=[];for(;a.getMonth()===e;)s.push(new Date(a)),a.setDate(a.getDate()+1);return s},this.towardsOffDaysBoard=()=>{const{history:e,userInfos:t}=this.props;"admin"===t.status?e.push("/calendaroffdaysboard"):e.push("/calendaroffdays")},this.towardsMonthlyCalendar=()=>{const{history:e}=this.props;e.push("/calendarmonth")},this.datePickerRef=n.a.createRef(),this.state={day:null,year:S.a.parseInt(e.match.params.year)||v().year(),dayCount:S.a.parseInt(e.match.params.day)||v().dayOfYear(),sidebarOpen:!1,collabsToDisplay:[],operationsToDisplay:[],isPopupDisplayed:!1,popupContent:null,fetchDate:""}}componentDidMount(){const{sessionToken:e,fetchEvents:t,history:a,userInfos:s,fetchOperations:n,fetchMyOperations:o}=this.props,{day:i,year:r}=this.props.match.params;if(v.locale("fr"),S.a.isNil(e)&&a.push("/login"),"admin"===S.a.get(s,"status","user")?n(e):o(S.a.get(s,"id"),e),S.a.isNil(i)||S.a.isNil(r))this.setState({day:new Date},()=>{const a=v(this.state.day).month()+1,n=v(this.state.day).year(),o=a<10?"0".concat(a):a;this.setState({fetchDate:"".concat(n,"_").concat(o)},()=>{t(this.state.fetchDate,e,S.a.get(s,"corpId"))})});else{const a=v().dayOfYear(i);this.setState({day:a},()=>{const a=v(this.state.day).month()+1,n=v(this.state.day).year(),o=a<10?"0".concat(a):a;this.setState({fetchDate:"".concat(n,"_").concat(o)},()=>{t(this.state.fetchDate,e,S.a.get(s,"corpId"))})})}}componentDidUpdate(e,t){const{sessionToken:a,fetchEvents:s,userInfos:n}=this.props;t.fetchDate!==this.state.fetchDate&&this.fetchEventsData()}onSetSidebarOpen(e){this.setState({sidebarOpen:e})}render(){const{isPopupDisplayed:e,popupContent:t,day:a,fetchDate:s,operationsToDisplay:o}=this.state,{userInfos:i,operations:r}=this.props,c=S.a.filter(this.props.events,e=>v(e.date).dayOfYear()===v(a).dayOfYear()&&("amo"!==e.type||!S.a.isEmpty(S.a.intersection(this.state.collabsToDisplay,S.a.map(e.invitations,"id"))))),l=S.a.filter(c,e=>S.a.includes(o,e.operation_id)),p=this.getOperations(this.props.events),d="admin"===i.status,h=D()({"popup-halo":!0,"popup-halo--toggled":e});return!S.a.isEmpty(s)&&n.a.createElement("div",{className:"calendar-container"},n.a.createElement("img",{src:pt,className:"orchestra-logo-monthly"}),n.a.createElement(lt,{recipients:this.getRecipients(this.props.events),operations:S.a.filter(r,e=>S.a.includes(p,e.id)),toggleRecipient:this.toggleRecipient,toggleOperation:this.toggleOperation,openInvitationPopup:this.openInvitationPopup,openOperationsPopup:this.openOperationsPopup,logout:this.logout,userName:S.a.get(i,"name"),towardsOffDaysBoard:this.towardsOffDaysBoard}),n.a.createElement("div",{className:"week-navigation-container-month"},n.a.createElement("div",{className:"week-navigation-holder-month"},n.a.createElement("div",{className:"calendar-navigation-container",onClick:this.navigateToPreviousWeek},n.a.createElement("svg",{viewBox:"0 0 512 512",width:"20",height:"20"},n.a.createElement("path",{d:"M198.608,246.104L382.664,62.04c5.068-5.056,7.856-11.816,7.856-19.024c0-7.212-2.788-13.968-7.856-19.032l-16.128-16.12\r C361.476,2.792,354.712,0,347.504,0s-13.964,2.792-19.028,7.864L109.328,227.008c-5.084,5.08-7.868,11.868-7.848,19.084\r c-0.02,7.248,2.76,14.028,7.848,19.112l218.944,218.932c5.064,5.072,11.82,7.864,19.032,7.864c7.208,0,13.964-2.792,19.032-7.864\r l16.124-16.12c10.492-10.492,10.492-27.572,0-38.06L198.608,246.104z"}))),n.a.createElement("div",{className:"top"},n.a.createElement("div",{onClick:this.openDatePicker},"".concat(v(a).format("D MMM"))),n.a.createElement("div",{className:"bottom",onClick:this.openDatePicker},"".concat(v(a).format("YYYY")))),n.a.createElement("div",{className:"calendar-navigation-container",onClick:this.navigateToNextWeek},n.a.createElement("svg",{viewBox:"0 0 512 512",width:"20",height:"20"},n.a.createElement("path",{d:"M382.678,226.804L163.73,7.86C158.666,2.792,151.906,0,144.698,0s-13.968,2.792-19.032,7.86l-16.124,16.12\r c-10.492,10.504-10.492,27.576,0,38.064L293.398,245.9l-184.06,184.06c-5.064,5.068-7.86,11.824-7.86,19.028\r c0,7.212,2.796,13.968,7.86,19.04l16.124,16.116c5.068,5.068,11.824,7.86,19.032,7.86s13.968-2.792,19.032-7.86L382.678,265\r c5.076-5.084,7.864-11.872,7.848-19.088C390.542,238.668,387.754,231.884,382.678,226.804z"}))),n.a.createElement(ee.a,{ref:this.datePickerRef,selected:a._d,onChange:this.navigateToDate}))),d&&n.a.createElement("div",{className:"add-action-btn-container"},n.a.createElement(F,{clickAction:this.openNewEventPopup,label:"Nouveau RDV"})),n.a.createElement("div",{className:"switch-action-btn-container"},n.a.createElement(F,{clickAction:this.towardsMonthlyCalendar,label:"Planning mensuel"})),n.a.createElement("div",{className:"calendar-center-container months-container"},n.a.createElement(ta,null),n.a.createElement(sa,null),n.a.createElement($t,{day:a,index:0,events:l,fetchEventsData:this.fetchEventsData,operations:r,openEditEventPopup:this.openEditEventPopup})),e&&n.a.createElement("div",null,n.a.createElement("div",{className:h,onClick:()=>{this.setPopupState(!1)}}),n.a.createElement("div",{className:"popup-container"},t)))}}var oa=Object(r.b)(e=>({loading:e.events.loading,events:e.events.events,hasErrors:e.events.hasErrors,sessionToken:e.me.sessionToken,userInfos:e.me.infos,operations:e.operations.operations,isOperationsLoading:e.operations.loading}),e=>Object(i.bindActionCreators)({fetchOperations:be,fetchEvents:G,fetchAmoEvents:H,logout:De,fetchMyOperations:_e},e))(na);a(444),a(445);class ia extends s.Component{constructor(e){super(e),this.updateLogin=e=>this.setState({login:e.target.value}),this.updatePassword=e=>this.setState({password:e.target.value}),this.sendAuthRequest=()=>{const{requestAuthentication:e}=this.props,{login:t,password:a}=this.state;e(t,a)},this.state={login:"",password:""}}render(){const{login:e,password:t}=this.state,{isLoading:a}=this.props;return n.a.createElement("div",{className:"login-box-container"},n.a.createElement(P,{value:e,onChange:this.updateLogin,placeholder:"Mail",isDescription:!1}),n.a.createElement(P,{value:t,onChange:this.updatePassword,placeholder:"Password",isDescription:!1,isPassword:!0}),n.a.createElement("div",{className:"login-btn"},n.a.createElement(F,{clickAction:this.sendAuthRequest,label:"LOGIN",isLoading:a})))}}var ra=Object(r.b)(e=>({sessionToken:e.me.sessionToken,isLoading:e.me.loading}),e=>Object(i.bindActionCreators)({requestAuthentication:fe},e))(ia);a(446);class ca extends s.Component{constructor(e){super(e),this.updateName=e=>this.setState({name:e.target.value}),this.updateLogin=e=>this.setState({login:e.target.value}),this.updatePassword=e=>this.setState({password:e.target.value}),this.updatePhone=e=>this.setState({phone:e.target.value}),this.sendRequest=()=>{const{requestcreateUser:e,isLoading:t,requestAuthentication:a}=this.props,{login:s,password:n,name:o,phone:i}=this.state;t||e(s,o,n,"user",i).then(()=>{a(s,n)})},this.state={name:"",login:"",password:"",phone:""}}render(){const{isEventsLoading:e,isAuthLoading:t}=this.props,{login:a,password:s,name:o,phone:i}=this.state;return n.a.createElement("div",{className:"create-account-box-container"},n.a.createElement(P,{value:a,onChange:this.updateLogin,placeholder:"Mail",isDescription:!1}),n.a.createElement(P,{value:o,onChange:this.updateName,placeholder:"Name",isDescription:!1}),n.a.createElement(P,{value:s,onChange:this.updatePassword,placeholder:"Password",isDescription:!1,isPassword:!0}),n.a.createElement(P,{value:i,onChange:this.updatePhone,placeholder:"Telephone",isDescription:!1}),n.a.createElement("div",{className:"login-btn"},n.a.createElement(F,{clickAction:this.sendRequest,label:"CREATE ACCOUNT",isLoading:e||t})))}}var la=Object(r.b)(e=>({sessionToken:e.me.sessionToken,isEventsLoading:e.events.loading,isAuthLoading:e.me.loading}),e=>Object(i.bindActionCreators)({requestcreateUser:j,requestAuthentication:fe},e))(ca);class pa extends s.Component{constructor(e){super(e),this.createAccount=()=>this.setState({createAccoundMode:!0}),this.login=()=>this.setState({createAccoundMode:!1}),this.navigateToCalendar=()=>{this.props.history.push("/calendarmonth")},this.state={createAccoundMode:!1}}componentDidMount(){const{history:e,sessionToken:t}=this.props;S.a.isNil(t)||e.push("/calendarmonth")}componentDidUpdate(e,t){const{history:a,sessionToken:s}=this.props;S.a.isNil(s)||a.push("/calendarmonth")}render(){const{sessionToken:e}=this.props,{createAccoundMode:t}=this.state;return n.a.createElement("div",{className:"login-page-container"},t?n.a.createElement(la,null):n.a.createElement(ra,null),t?n.a.createElement("div",{className:"login-link",onClick:this.login},"Already have an account ? Login !"):n.a.createElement("div",{className:"login-link",onClick:this.createAccount},"Not user yet ? Create account !"),!S.a.isNil(e)&&n.a.createElement("div",{onClick:this.navigateToCalendar},"Authenticated ! go to calendars"))}}var da=Object(r.b)(e=>({sessionToken:e.me.sessionToken}))(pa);const ha={events:[],operationEvents:[],amoEvents:[],loading:!1,hasErrors:!1,rdvPageInfos:{},exportPageName:""};const ma={users:[],loading:!1,hasErrors:!1};a(447);const ua={sessionToken:null,loading:!1,hasErrors:!1,infos:{},offDays:[],allOffDays:[]};const Ea={operations:[],loading:!1,hasErrors:!1,settings:{}};var va=Object(i.combineReducers)({events:function(e=ha,t){let a=[],s=[];switch(t.type){case"GET_EVENTS":case"GET_OPERATION_EVENTS":case"GET_AMO_EVENTS":case"PUT_EVENTS":case"UPDATE_EVENT":case"DELETE_EVENT":case"GET_NOAUTH_INFOS":case"PUT_NOAUTH_EVENT":return{...e,loading:!0};case"GET_EVENTS_SUCCESS_MERGE":return a=S.a.reduceRight(t.payload,(e,t)=>(S.a.remove(e,e=>e.id===t.id),e.concat(t)),e.events),{events:a,loading:!1,hasErrors:!1};case"GET_AMO_EVENTS_SUCCESS":case"GET_EVENTS_SUCCESS":return{...e,events:t.payload,loading:!1,hasErrors:!1};case"GET_OPERATION_EVENTS_SUCCESS":return{...e,operationEvents:t.payload.events,exportPageName:t.payload.name,loading:!1,hasErrors:!1};case"GET_NOAUTH_INFOS_SUCCESS":return{...e,rdvPageInfos:{rdvs:t.payload.rdvs,settings:JSON.parse(t.payload.settings.rdvs_settings)},loading:!1,hasErrors:!1};case"GET_OPERATION_EVENTS_SUCCESS_MERGE":return a=S.a.reduceRight(t.payload,(e,t)=>(S.a.remove(e,e=>e.id===t.id),e.concat(t)),e.operationEvents),{...e,operationEvents:a,loading:!1,hasErrors:!1};case"DELETE_EVENT_SUCCESS":return s=S.a.remove(e.events,e=>e.id!==t.payload),{...e,events:s,loading:!1,hasErrors:!1};case"PUT_NOAUTH_EVENT_SUCCESS":case"UPDATE_EVENT_SUCCESS":case"PUT_EVENTS_SUCCESS":return{...e,loading:!1,hasErrors:!1};case"GET_EVENTS_FAILURE":case"GET_OPERATION_EVENTS_FAILURE":case"GET_AMO_EVENTS_FAILURE":case"UPDATE_EVENT_FAILURE":case"PUT_EVENTS_FAILURE":case"DELETE_EVENT_FAILURE":case"PUT_NOAUTH_EVENT_FAILURE":case"GET_NOAUTH_INFOS_FAILURE":return{...e,loading:!1,hasErrors:!0};default:return e}},users:function(e=ma,t){switch(t.type){case"GET_USERS":case"INVITE_USER":case"CREATE_USER":case"UPDATE_USER_STATUS":return{...e,loading:!0};case"INVITE_USER_SUCCESS":case"CREATE_USER_SUCCESS":case"UPDATE_USER_STATUS_SUCCESS":return{...e,loading:!1,hasErrors:!1};case"GET_USERS_SUCCESS":return{users:t.payload,loading:!1,hasErrors:!1};case"INVITE_USER_FAILURE":case"CREATE_USER_FAILURE":case"GET_USERS_FAILURE":case"UPDATE_USER_STATUS_FAILURE":return{...e,loading:!1,hasErrors:!0};default:return e}},me:function(e=ua,t){switch(t.type){case"AUTHENTICATE":case"GET_OFFDAYS":case"GET_COMPANY_OFFDAYS":return{...e,loading:!0};case"LOGOUT":return{...e,sessionToken:null,loading:!1,hasErrors:!0};case"AUTHENTICATE_SUCCESS":const a=t.payload,s=a.split(".")[1],n=Base64.decode(s);return{sessionToken:a,infos:JSON.parse(n),loading:!1,hasErrors:!1};case"GET_OFFDAYS_SUCCESS":return{...e,offDays:t.payload};case"GET_COMPANY_OFFDAYS_SUCCESS":return{...e,allOffDays:t.payload};case"GET_COMPANY_OFFDAYS_FAILURE":case"GET_OFFDAYS_FAILURE":return{...e,loading:!1,hasErrors:!0};case"AUTHENTICATE_FAILURE":return{...e,sessionToken:null,loading:!1,hasErrors:!0};default:return e}},operations:function(e=Ea,t){let a=[];const s=["#8fcfd1","#df5e88","#f6ab6c","#f6efa6","#91d18b","#f09ae9"];switch(t.type){case"GET_OPERATIONS":case"GET_MY_OPERATIONS":case"UPDATE_OPERATION_SETTINGS":case"PUT_OPERATION":case"UPDATE_OPERATION":case"DELETE_OPERATION":case"UPDATE_OPERATION_TOTAL":return{...e,loading:!0};case"GET_OPERATION_SETTINGS":return{...e,loading:!0,settings:{}};case"GET_OPERATIONS_SUCCESS":const n=t.payload;return S.a.each(S.a.orderBy(n,"id"),(e,t)=>{e.color=s[t%s.length];const a=e.data.replace(/<br>/gi,"\n");e.data=a}),{...e,operations:t.payload,loading:!1,hasErrors:!1};case"GET_MY_OPERATIONS_SUCCESS":const o=t.payload;return S.a.each(S.a.orderBy(o,"id"),(e,t)=>{e.color=s[t%s.length];const a=e.data.replace(/<br>/gi,"\n");e.data=a}),{...e,operations:t.payload,loading:!1,hasErrors:!1};case"GET_OPERATION_SETTINGS_SUCCESS":return{...e,settings:JSON.parse(t.payload.rdvs_settings),loading:!1,hasErrors:!1};case"DELETE_OPERATION_SUCCESS":return a=S.a.remove(e.operations,e=>e.id!==t.payload),{...e,operations:a,loading:!1,hasErrors:!1};case"UPDATE_OPERATION_SETTINGS_SUCCESS":case"UPDATE_OPERATION_TOTAL_SUCCESS":case"UPDATE_OPERATION_SUCCESS":case"PUT_OPERATION_SUCCESS":return{...e,loading:!1,hasErrors:!1};case"GET_OPERATIONS_FAILURE":case"UPDATE_OPERATION_SETTINGS_FAILURE":case"GET_OPERATION_SETTINGS_FAILURE":case"UPDATE_OPERATION_FAILURE":case"PUT_OPERATION_FAILURE":case"DELETE_OPERATION_FAILURE":case"UPDATE_OPERATION_TOTAL_FAILURE":return{...e,loading:!1,hasErrors:!0};default:return e}}});a(448);const ga={key:"root",storage:m.a},fa=Object(p.a)(ga,va),ya=Object(i.createStore)(fa,Object(l.composeWithDevTools)(Object(i.applyMiddleware)(c.a))),Na=Object(p.b)(ya);var Sa=()=>n.a.createElement(r.a,{store:ya},n.a.createElement(d.a,{loading:null,persistor:Na},n.a.createElement(u.a,null,n.a.createElement(E.c,null,n.a.createElement(E.a,{path:"/mcalendar/:day?/:year?",component:mt}),n.a.createElement(E.a,{path:"/calendarmonth/:month?/:year?",component:St}),n.a.createElement(E.a,{path:"/calendarday/:day?/:year?",component:oa}),n.a.createElement(E.a,{path:"/calendaroffdays/:month?/:year?",component:At}),n.a.createElement(E.a,{path:"/calendaroffdaysBoard/:month?/:year?",component:Rt}),n.a.createElement(E.a,{path:"/calendarexport/:operation_id/:week?/:year?",component:Wt}),n.a.createElement(E.a,{path:"/rdvconfig/:operation_id",component:Ct}),n.a.createElement(E.a,{path:"/rdv/:operation_id",component:bt}),n.a.createElement(E.a,{path:"/privacypolicy",component:kt}),n.a.createElement(E.a,{path:"/login",component:da}),n.a.createElement(E.a,{path:"/",component:da})),n.a.createElement(w.NotificationContainer,null))));Object(o.render)(n.a.createElement(Sa,null),document.getElementById("root"))}},[[237,1,2]]]);